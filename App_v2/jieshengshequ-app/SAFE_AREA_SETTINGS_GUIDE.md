# 安全域设置功能使用指南 🛡️

## 功能概述

安全域设置功能允许用户自定义应用的界面边距，特别适用于各种异形屏设备（刘海屏、水滴屏等），确保界面内容不会被系统UI遮挡。

## 功能特性

### ✨ 主要功能

1. **自动检测模式** - 使用系统提供的安全区域信息
2. **手动配置模式** - 用户可自定义顶部和底部边距
3. **预览模式** - 实时显示安全区域边界
4. **快速预设** - 提供常用的边距配置
5. **实时调整** - 滑块控制，即时生效

### 🎯 使用场景

- 刘海屏设备适配
- 水滴屏设备适配
- 异形屏设备适配
- 个性化界面调整
- 开发调试界面边距

## 如何使用

### 1. 进入设置页面

从个人中心右上角点击设置图标 ⚙️ 进入设置页面。

### 2. 找到安全域配置

在设置页面中找到"安全域配置"卡片。

### 3. 选择配置模式

#### 自动检测模式（推荐）
- 开启"自动检测安全区域"开关
- 系统会自动适配当前设备的安全区域
- 适用于大多数设备

#### 手动配置模式
- 关闭"自动检测安全区域"开关
- 使用滑块调整顶部和底部边距
- 可使用快速预设进行配置

### 4. 使用预览模式

- 点击"预览模式"按钮
- 界面会显示红色虚线边框，标示安全区域
- 中央会显示当前配置信息
- 再次点击关闭预览模式

### 5. 保存设置

- 配置完成后点击"保存设置"
- 设置会自动保存到本地存储
- 下次启动应用会自动应用配置

## 快速预设说明

| 预设名称 | 顶部边距 | 底部边距 | 适用场景 |
|---------|---------|---------|---------|
| 无边距 | 0px | 0px | 全屏显示 |
| 标准边距 | 20px | 20px | 常规使用 |
| 大边距 | 40px | 40px | 更多空间 |
| 仅顶部 | 30px | 0px | 刘海屏适配 |
| 仅底部 | 0px | 30px | 手势导航适配 |

## 技术实现

### 架构设计

```
SafeAreaProvider (Context)
├── 配置状态管理
├── CSS变量设置
├── 本地存储持久化
└── 预览模式控制
```

### CSS变量

系统会设置以下CSS变量：

```css
--custom-safe-area-top: 自定义顶部边距
--custom-safe-area-bottom: 自定义底部边距
--custom-safe-area-left: 自定义左侧边距
--custom-safe-area-right: 自定义右侧边距
```

### 样式应用

```css
.safe-area-container {
  padding-top: max(env(safe-area-inset-top), var(--custom-safe-area-top, 0px));
  padding-bottom: max(env(safe-area-inset-bottom), var(--custom-safe-area-bottom, 0px));
}
```

## 开发者使用

### 1. 使用Context

```tsx
import { useSafeArea } from '@/components/safe-area-provider'

const MyComponent = () => {
  const { config, updateConfig } = useSafeArea()
  
  return (
    <div>
      当前顶部边距: {config.topMargin}px
    </div>
  )
}
```

### 2. 应用安全域样式

```tsx
<div className="safe-area-container">
  {/* 内容会自动适配安全区域 */}
</div>
```

### 3. 自定义组件适配

```tsx
const MyHeader = () => {
  return (
    <header style={{
      paddingTop: 'max(env(safe-area-inset-top), var(--custom-safe-area-top, 0px))'
    }}>
      {/* 头部内容 */}
    </header>
  )
}
```

## 注意事项

### ⚠️ 使用建议

1. **优先使用自动检测** - 大多数情况下自动检测已足够
2. **谨慎调整边距** - 过大的边距会浪费屏幕空间
3. **测试多种设备** - 不同设备的安全区域可能不同
4. **使用预览模式** - 调整时开启预览模式查看效果

### 🔧 故障排除

**问题：设置不生效**
- 检查是否点击了保存按钮
- 尝试刷新页面或重启应用

**问题：预览模式显示异常**
- 关闭预览模式再重新开启
- 检查浏览器兼容性

**问题：边距过大或过小**
- 使用快速预设重新配置
- 或点击"重置设置"恢复默认

## 更新日志

### v1.0.0 (2025-08-19)
- ✨ 新增安全域配置功能
- ✨ 支持自动检测和手动配置
- ✨ 添加预览模式
- ✨ 提供快速预设选项
- ✨ 实现配置持久化存储

## 反馈与支持

如果您在使用过程中遇到问题或有改进建议，请：

1. 查看本指南的故障排除部分
2. 联系开发团队
3. 提交Issue或反馈

---

**提示**：安全域设置是一个高级功能，建议在了解其作用后再进行调整。大多数用户使用默认的自动检测模式即可获得最佳体验。 