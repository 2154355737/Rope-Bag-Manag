<template>
  <div class="home-container">
    <!-- Âä®ÊÄÅËÉåÊôØÂ±Ç -->
    <div class="background-layer">
      <div class="gradient-bg"></div>
      <div class="pattern-overlay"></div>
    </div>

    <!-- È°∂ÈÉ®ÂØºËà™Ê†è - Âõ∫ÂÆöÂÆö‰Ωç -->
    <header class="top-header">
      <div class="header-wrapper">
        <div class="header-left">
          <div class="brand">
            <div class="brand-icon">üèòÔ∏è</div>
            <div class="brand-text">
              <h1>{{ systemSettings.hero_title }}</h1>
              <span>{{ systemSettings.hero_subtitle }}</span>
            </div>
          </div>
        </div>
        
        <div class="header-center">
          <div class="search-container">
            <el-input
              v-model="searchQuery"
              placeholder="ÊêúÁ¥¢ËµÑÊ∫ê„ÄÅÂ∏ñÂ≠ê„ÄÅÁî®Êà∑..."
              size="large"
              clearable
              @keyup.enter="handleSearch"
              class="main-search"
            >
              <template #prefix>
                <el-icon><Search /></el-icon>
              </template>
              <template #suffix>
                <el-button type="primary" text @click="handleSearch">
                  ÊêúÁ¥¢
                </el-button>
              </template>
            </el-input>
          </div>
        </div>
        
        <div class="header-right">
          <div class="header-actions">
            <ThemeSwitcher />
            <el-button 
              v-if="!isLoggedIn" 
              type="primary" 
              size="default"
              @click="goToLogin"
            >
              <el-icon><User /></el-icon>
              ÁôªÂΩï
            </el-button>
            <div v-if="isLoggedIn" class="user-menu">
              <el-dropdown trigger="click" placement="bottom-end">
                <div class="user-trigger">
                  <el-avatar :size="36" :src="userInfo.avatar_url">
                    <el-icon><User /></el-icon>
                  </el-avatar>
                  <span class="user-name">{{ userInfo.nickname || userInfo.username }}</span>
                  <el-icon class="dropdown-arrow"><ArrowDown /></el-icon>
                </div>
                <template #dropdown>
                  <el-dropdown-menu>
                    <el-dropdown-item @click="goToUserProfile">
                      <el-icon><User /></el-icon>
                      ‰∏™‰∫∫‰∏≠ÂøÉ
                    </el-dropdown-item>
                    <el-dropdown-item @click="goToAdmin">
                      <el-icon><Setting /></el-icon>
                      ÁÆ°ÁêÜÂêéÂè∞
                    </el-dropdown-item>
                    <el-dropdown-item divided @click="handleLogout">
                      <el-icon><Switch /></el-icon>
                      ÈÄÄÂá∫ÁôªÂΩï
                    </el-dropdown-item>
                  </el-dropdown-menu>
                </template>
              </el-dropdown>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
    <main class="main-content">
      <div class="content-container">
        
        <!-- ÁÑ¶ÁÇπËΩÆÊí≠Âå∫Âüü - ÂÖ®ÂÆΩÂ∫¶ -->
        <section class="hero-section">
          <div class="hero-wrapper">
            <div class="hero-content">
              <div class="hero-text">
                <h2>{{ systemSettings.hero_title }}</h2>
                <p>{{ systemSettings.hero_subtitle }}</p>
                <div class="hero-stats">
                  <div class="stat-item">
                    <span class="stat-number">{{ totalResources }}</span>
                    <span class="stat-label">ËµÑÊ∫ê</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-number">{{ totalUsers }}</span>
                    <span class="stat-label">Áî®Êà∑</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-number">{{ totalDownloads }}</span>
                    <span class="stat-label">‰∏ãËΩΩ</span>
                  </div>
                </div>
              </div>
              
              <div class="hero-carousel" v-if="featuredResources.length > 0">
                <el-carousel 
                  :interval="6000" 
                  indicator-position="outside"
                  height="320px"
                  class="featured-carousel"
                >
                  <el-carousel-item 
                    v-for="resource in featuredResources.slice(0, 5)" 
                    :key="resource.id"
                    class="carousel-item"
                  >
                    <div class="featured-card" @click="viewResource(resource.id)">
                      <div class="card-cover">
                        <div class="cover-gradient"></div>
                        <div class="cover-content">
                          <h3>{{ resource.name }}</h3>
                          <p>{{ resource.description }}</p>
                          <div class="card-meta">
                            <span class="meta-author">{{ resource.author }}</span>
                            <span class="meta-downloads">{{ resource.download_count }} ‰∏ãËΩΩ</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </el-carousel-item>
                </el-carousel>
              </div>
            </div>
          </div>
        </section>

        <!-- ‰∏âÊ†èÂÜÖÂÆπÂ∏ÉÂ±Ä -->
        <section class="three-column-section">
          <div class="column-wrapper">
            
            <!-- Â∑¶‰æßÊ†èÔºöÂø´ÈÄüÂØºËà™ + ÂÖ¨Âëä -->
            <aside class="left-column">
              <!-- ÂÜÖÂÆπÂàÜÁ±ª -->
              <div class="nav-panel">
                <div class="panel-header" @click="toggleCategoryPanel">
                  <h3>
                    <el-icon><Menu /></el-icon>
                    ÂÜÖÂÆπÂàÜÁ±ª
                  </h3>
                  <el-icon class="collapse-icon" :class="{ collapsed: !categoryPanelExpanded }">
                    <ArrowDown />
                  </el-icon>
                </div>
                <el-collapse-transition>
                  <div v-show="categoryPanelExpanded" class="panel-content">
                    <div class="quick-nav">
                      <div 
                        class="nav-item"
                        :class="{ active: activeCategory === 'all' }"
                        @click="handleCategoryChange({ props: { name: 'all' } })"
                      >
                        <el-icon><Grid /></el-icon>
                        <span>ÂÖ®ÈÉ®ËµÑÊ∫ê</span>
                        <div class="nav-count">{{ totalResources }}</div>
                      </div>
                      <div 
                        v-for="category in categories" 
                        :key="category.id"
                        class="nav-item"
                        :class="{ active: activeCategory === category.id.toString() }"
                        @click="handleCategoryChange({ props: { name: category.id.toString() } })"
                      >
                        <el-icon><Document /></el-icon>
                        <span>{{ category.name }}</span>
                        <div class="nav-count">{{ getCategoryCount(category.id) }}</div>
                      </div>
                    </div>
                  </div>
                </el-collapse-transition>
              </div>
              
              <!-- Á§æÂå∫ÂÖ¨Âëä -->
              <div class="announcement-panel">
                <div class="panel-header" @click="toggleAnnouncementPanel">
                  <h3>
                    <el-icon><Bell /></el-icon>
                    Á§æÂå∫ÂÖ¨Âëä
                  </h3>
                  <el-icon class="collapse-icon" :class="{ collapsed: !announcementPanelExpanded }">
                    <ArrowDown />
                  </el-icon>
                </div>
                <el-collapse-transition>
                  <div v-show="announcementPanelExpanded" class="panel-content">
                  <div v-if="notices.length === 0" class="empty-state">
                    <el-empty description="ÊöÇÊó†ÂÖ¨Âëä" :image-size="80" />
                  </div>
                  <div v-else class="announcement-list">
                    <div 
                      v-for="notice in notices.slice(0, 5)" 
                      :key="notice.id" 
                      class="announcement-item"
                    >
                      <div class="announcement-dot"></div>
                      <div class="announcement-content">
                        <div class="announcement-text">{{ notice.text }}</div>
                        <div class="announcement-time">{{ formatTime(notice.created_at) }}</div>
                      </div>
                    </div>
                  </div>
                </div>
                </el-collapse-transition>
              </div>
            </aside>

            <!-- ‰∏≠Èó¥‰∏ªÂÜÖÂÆπÔºöËµÑÊ∫êÂ±ïÁ§∫ -->
            <main class="center-column">
              <div class="content-panel">
                <!-- ÂÜÖÂÆπÂ§¥ÈÉ® -->
                <div class="content-header">
                  <div class="header-left">
                    <h2>Á§æÂå∫ÂÜÖÂÆπ</h2>
                    <span class="content-count">
                      <span v-if="contentType === 'resources'">ÂÖ± {{ filteredResources.length }} ‰∏™ËµÑÊ∫ê</span>
                      <span v-else>ÂÖ± {{ posts.length }} ‰∏™Â∏ñÂ≠ê</span>
                    </span>
                  </div>
                  <div class="header-right">
                    <div class="content-controls">
                      <!-- ÂÜÖÂÆπÁ±ªÂûãÂàáÊç¢ -->
                      <el-select 
                        v-model="contentType" 
                        placeholder="ÂÜÖÂÆπÁ±ªÂûã"
                        style="width: 120px; margin-right: 12px;"
                      >
                        <el-option label="ËµÑÊ∫ê" value="resources" />
                        <el-option label="Â∏ñÂ≠ê" value="posts" />
                      </el-select>
                      
                      <!-- Á≠õÈÄâÂô® -->
                      <el-select 
                        v-model="sortBy" 
                        placeholder="ÊéíÂ∫èÊñπÂºè"
                        @change="applySorting"
                        style="width: 140px;"
                      >
                        <el-option label="ÊúÄÊñ∞ÂèëÂ∏É" value="created_at" />
                        <el-option label="‰∏ãËΩΩÊúÄÂ§ö" value="download_count" v-if="contentType === 'resources'" />
                        <el-option label="ÊúÄÂ§öÊü•Áúã" value="view_count" v-if="contentType === 'posts'" />
                        <el-option label="ÊúÄÂ§öÁÇπËµû" value="like_count" v-if="contentType === 'posts'" />
                        <el-option label="ËØÑÂàÜÊúÄÈ´ò" value="rating" v-if="contentType === 'resources'" />
                        <el-option label="ÂêçÁß∞ÊéíÂ∫è" value="name" v-if="contentType === 'resources'" />
                        <el-option label="Ê†áÈ¢òÊéíÂ∫è" value="title" v-if="contentType === 'posts'" />
                      </el-select>
                      
                      <!-- ËßÜÂõæÂàáÊç¢ -->
                      <div class="view-toggle">
                        <el-button-group>
                          <el-button 
                            :type="viewMode === 'grid' ? 'primary' : 'default'"
                            @click="viewMode = 'grid'"
                          >
                            <el-icon><Grid /></el-icon>
                          </el-button>
                          <el-button 
                            :type="viewMode === 'list' ? 'primary' : 'default'"
                            @click="viewMode = 'list'"
                          >
                            <el-icon><List /></el-icon>
                          </el-button>
                        </el-button-group>
                      </div>

                      <!-- ÂèëÂ∏ÉÊåâÈíÆ -->
                      <el-button 
                        v-if="contentType === 'posts'" 
                        type="primary" 
                        @click="goToCreatePost"
                        style="margin-left: 12px;"
                      >
                        <el-icon><Plus /></el-icon>
                        ÂèëÂ∏ÉÂ∏ñÂ≠ê
                      </el-button>
                    </div>
                  </div>
                </div>

                <!-- ÂÜÖÂÆπÂàóË°® -->
                <div class="content-display">
                  <div v-if="loading" class="loading-state">
                    <el-skeleton :rows="6" animated />
                  </div>
                  
                  <!-- ËµÑÊ∫êÂàóË°® -->
                  <div v-else-if="contentType === 'resources'">
                    <div v-if="filteredResources.length === 0" class="empty-state">
                    <el-empty description="ÊöÇÊó†ËµÑÊ∫ê" :image-size="120">
                      <el-button type="primary" @click="resetFilters">
                        ÈáçÁΩÆÁ≠õÈÄâ
                      </el-button>
                    </el-empty>
                  </div>
                  
                  <div v-else class="resource-grid" :class="[viewMode]">
                    <div 
                      v-for="resource in paginatedResources" 
                      :key="resource.id"
                      class="resource-card"
                      @click="viewResource(resource.id)"
                    >
                      <div class="card-header">
                        <div class="card-icon">
                          <el-icon size="20" :color="getCategoryColor(resource.category_id)">
                            <Document />
                          </el-icon>
                        </div>
                        <div class="card-title">
                          <div class="title-row">
                          <h4>{{ resource.name }}</h4>
                            <div class="status-badges" v-if="resource.is_featured || resource.is_pinned">
                              <el-tag v-if="resource.is_pinned" type="danger" size="small" effect="dark">
                                <el-icon><Star /></el-icon>
                                ÁΩÆÈ°∂
                              </el-tag>
                              <el-tag v-if="resource.is_featured" type="warning" size="small" effect="dark">
                                <el-icon><Trophy /></el-icon>
                                Á≤æÂçé
                              </el-tag>
                            </div>
                          </div>
                          <span class="card-category">{{ getCategoryLabel(resource.category_id) }}</span>
                        </div>
                        <div class="card-actions">
                          <el-dropdown trigger="click">
                            <el-button link size="small">
                              <el-icon><MoreFilled /></el-icon>
                            </el-button>
                            <template #dropdown>
                              <el-dropdown-menu>
                                <el-dropdown-item @click.stop="viewResource(resource.id)">
                                  <el-icon><View /></el-icon>
                                  Êü•ÁúãËØ¶ÊÉÖ
                                </el-dropdown-item>
                                <el-dropdown-item @click.stop="downloadResource(resource.id)">
                                  <el-icon><Download /></el-icon>
                                  Á´ãÂç≥‰∏ãËΩΩ
                                </el-dropdown-item>
                              </el-dropdown-menu>
                            </template>
                          </el-dropdown>
                        </div>
                      </div>
                      
                      <div class="card-body">
                        <p class="card-description">{{ resource.description }}</p>
                        <div class="card-tags" v-if="resource.tags && resource.tags.length > 0">
                          <el-tag 
                            v-for="tag in resource.tags.slice(0, 3)" 
                            :key="tag"
                            size="small"
                            effect="plain"
                          >
                            {{ tag }}
                          </el-tag>
                        </div>
                      </div>
                      
                      <div class="card-footer">
                        <div class="footer-meta">
                          <span class="meta-author">
                            <el-icon><User /></el-icon>
                            {{ resource.author }}
                          </span>
                          <span class="meta-downloads">
                            <el-icon><Download /></el-icon>
                            {{ resource.download_count }}
                          </span>
                          <span class="meta-time">
                            <el-icon><Clock /></el-icon>
                            {{ formatTime(resource.created_at) }}
                          </span>
                        </div>
                        <div class="footer-actions">
                          <el-button 
                            type="primary" 
                            size="small"
                            @click.stop="downloadResource(resource.id)"
                          >
                            ‰∏ãËΩΩ
                          </el-button>
                        </div>
                      </div>
                    </div>
                  </div>

                    <!-- ÂàÜÈ°µÂô® - ËµÑÊ∫ê -->
                  <div class="pagination-wrapper" v-if="filteredResources.length > 0">
                    <el-pagination
                      v-model:current-page="currentPage"
                      v-model:page-size="pageSize"
                      :page-sizes="[12, 24, 48, 96]"
                      :total="filteredResources.length"
                      layout="total, sizes, prev, pager, next, jumper"
                      background
                      @size-change="handleSizeChange"
                      @current-change="handleCurrentChange"
                    />
                    </div>
                  </div>

                  <!-- Â∏ñÂ≠êÂàóË°® -->
                  <div v-else-if="contentType === 'posts'">
                    <div v-if="posts.length === 0" class="empty-state">
                      <el-empty description="ÊöÇÊó†Â∏ñÂ≠ê" :image-size="120">
                        <el-button type="primary" @click="goToCreatePost">
                          ÂèëÂ∏ÉÂ∏ñÂ≠ê
                        </el-button>
                      </el-empty>
                    </div>
                    
                    <div v-else class="posts-grid" :class="[viewMode]">
                      <div 
                        v-for="post in posts" 
                        :key="post.id"
                        class="post-card"
                        @click="goToPostDetail(post.id)"
                      >
                        <div class="post-header">
                          <div class="post-avatar">
                            <el-avatar :size="36" :src="post.author_avatar">
                              <el-icon><User /></el-icon>
                            </el-avatar>
                          </div>
                          <div class="post-author">
                            <div class="author-name">{{ post.author_name }}</div>
                            <div class="post-time">{{ formatTime(post.created_at) }}</div>
                          </div>
                          <div class="post-category">
                            <el-tag size="small">{{ post.category }}</el-tag>
                          </div>
                        </div>
                        
                        <div class="post-content">
                          <h3 class="post-title">{{ post.title }}</h3>
                          <p class="post-excerpt">{{ post.content.substring(0, 120) }}...</p>
                        </div>
                        
                        <div class="post-footer">
                          <div class="post-stats">
                            <span class="stat-item">
                              <el-icon><View /></el-icon>
                              {{ post.view_count }}
                            </span>
                            <span class="stat-item">
                              <el-icon><ChatLineRound /></el-icon>
                              {{ post.comment_count }}
                            </span>
                            <span class="stat-item">
                              <el-icon><Star /></el-icon>
                              {{ post.like_count }}
                            </span>
                          </div>
                          <div class="post-actions">
                            <el-button link size="small">
                              ÈòÖËØªÊõ¥Â§ö
                            </el-button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- ÂàÜÈ°µÂô® - Â∏ñÂ≠ê -->
                    <div class="pagination-wrapper" v-if="posts.length > 0">
                      <el-pagination
                        v-model:current-page="postsCurrentPage"
                        v-model:page-size="postsPageSize"
                        :page-sizes="[12, 24, 48, 96]"
                        :total="postsTotal"
                        layout="total, sizes, prev, pager, next, jumper"
                        background
                        @size-change="handlePostsSizeChange"
                        @current-change="handlePostsCurrentChange"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </main>

            <!-- Âè≥‰æßÊ†èÔºöÊ¥ªÂä®Èù¢Êùø + ÁªüËÆ°‰ø°ÊÅØ -->
            <aside class="right-column">
              <!-- ÁÉ≠Èó®ÂÜÖÂÆπ -->
              <div class="stats-panel">
                <div class="panel-header">
                  <h3>
                    <el-icon><Star /></el-icon>
                    ÁÉ≠Èó®ÂÜÖÂÆπ
                  </h3>
                  <el-button 
                    link 
                    size="small" 
                    :loading="popularContentLoading"
                    @click="fetchPopularContent"
                    class="refresh-btn"
                  >
                    <el-icon><Refresh /></el-icon>
                  </el-button>
                </div>
                <div class="panel-content">
                  <div v-if="popularContentLoading" class="loading-state">
                    <el-skeleton :rows="4" animated />
                  </div>
                  <div v-else-if="popularContent.length === 0" class="empty-state">
                    <p>ÊöÇÊó†ÁÉ≠Èó®ÂÜÖÂÆπ</p>
                  </div>
                  <div v-else class="popular-content-list">
                    <div 
                      v-for="(item, index) in popularContent"
                      :key="`${item.type}-${item.id}`"
                      class="popular-item"
                      @click="goToContent(item)"
                    >
                      <div class="item-rank">
                        <span class="rank-number" :class="getRankClass(index)">{{ index + 1 }}</span>
                      </div>
                      <div class="item-content">
                        <div class="item-header">
                          <el-icon class="type-icon" :class="item.type">
                            <Document v-if="item.type === 'resource'" />
                            <ChatLineRound v-else />
                          </el-icon>
                          <span class="item-type">{{ item.type === 'resource' ? 'ËµÑÊ∫ê' : 'Â∏ñÂ≠ê' }}</span>
                        </div>
                        <div class="item-title">{{ item.title }}</div>
                        <div class="item-stats">
                          <span class="stat-item">
                            <el-icon><View /></el-icon>
                            {{ formatNumber(item.views) }}
                          </span>
                          <span v-if="item.type === 'resource'" class="stat-item">
                            <el-icon><Download /></el-icon>
                                                         {{ formatNumber(item.downloads ?? 0) }}
                          </span>
                          <span v-else class="stat-item">
                            <el-icon><Star /></el-icon>
                            {{ formatNumber(item.likes ?? 0) }}
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Á§æÂå∫Âä®ÊÄÅ -->
              <div class="activity-panel">
                <div class="panel-header">
                  <h3>
                    <el-icon><ChatDotRound /></el-icon>
                    Á§æÂå∫Âä®ÊÄÅ
                  </h3>
                  <div class="panel-actions">
                    <el-button 
                      link 
                      size="small" 
                      :loading="activitiesLoading"
                      @click="fetchRecentActivities"
                      class="refresh-btn"
                    >
                      <el-icon><Refresh /></el-icon>
                    </el-button>
                    <el-button link size="small" @click="scrollToPosts">
                      Êü•ÁúãÊõ¥Â§ö
                    </el-button>
                  </div>
                </div>
                <div class="panel-content">
                  <div v-if="activitiesLoading" class="loading-state">
                    <el-skeleton :rows="3" animated />
                  </div>
                  <div v-else-if="recentActivities.length === 0" class="empty-state">
                    <el-empty description="ÊöÇÊó†Âä®ÊÄÅ" :image-size="80" />
                  </div>
                  <div v-else class="activity-list">
                    <div 
                      v-for="activity in recentActivities.slice(0, 8)" 
                      :key="activity.id"
                      class="activity-item"
                      @click="handleActivityClick(activity)"
                    >
                      <div class="activity-avatar" v-if="activity.username && activity.username !== 'null'">
                        <el-avatar :size="32" :src="activity.user_avatar">
                          <el-icon><User /></el-icon>
                        </el-avatar>
                      </div>
                      <div class="activity-content" :class="{ 'no-avatar': !activity.username || activity.username === 'null' }">
                        <div class="activity-text">
                          <template v-if="activity.username && activity.username !== 'null'">
                            <strong>{{ activity.username }}</strong>
                            {{ activity.action }}
                            <span class="activity-target">{{ activity.target }}</span>
                          </template>
                          <template v-else>
                            <span class="activity-target">{{ activity.target }}</span>
                            {{ activity.action }}
                          </template>
                        </div>
                        <div class="activity-time">{{ formatTime(activity.created_at) }}</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- ÁÉ≠Èó®Ê†áÁ≠æ -->
              <div class="tags-panel">
                <div class="panel-header">
                  <h3>
                    <el-icon><PriceTag /></el-icon>
                    ÁÉ≠Èó®Ê†áÁ≠æ
                  </h3>
                  <el-button 
                    link 
                    size="small" 
                    :loading="tagsLoading"
                    @click="fetchPopularTags"
                    class="refresh-btn"
                  >
                    <el-icon><Refresh /></el-icon>
                  </el-button>
                </div>
                <div class="panel-content">
                  <div v-if="tagsLoading" class="loading-state">
                    <el-skeleton :rows="3" animated />
                  </div>
                  <div v-else-if="hotTags.length === 0" class="empty-state">
                    <p>ÊöÇÊó†ÁÉ≠Èó®Ê†áÁ≠æ</p>
                  </div>
                  <div v-else class="hot-tags">
                    <el-tag 
                      v-for="tag in hotTags.slice(0, 15)"
                      :key="tag.id || tag.name"
                      :type="tag.type"
                      size="small"
                      class="tag-item"
                      @click="searchByTag(tag.name)"
                    >
                      {{ tag.name }}
                      <span class="tag-count">({{ tag.count }})</span>
                    </el-tag>
                  </div>
                </div>
              </div>
            </aside>
            
          </div>
        </section>



      </div>
    </main>

    <!-- È°µËÑö -->
    <footer class="site-footer">
      <div class="footer-content">
        <div class="footer-info">
          <div class="footer-brand">
            <div class="brand-icon">üèòÔ∏è</div>
            <div>
              <h3>{{ systemSettings.hero_title }}</h3>
              <p>{{ systemSettings.hero_subtitle }}</p>
            </div>
          </div>
          <div class="footer-links">
            <div 
              v-for="(group, key) in footerLinks" 
              :key="key" 
              class="link-group"
            >
              <h4>{{ group.title }}</h4>
              <a 
                v-for="link in group.links" 
                :key="link.text"
                :href="link.url"
              >
                {{ link.text }}
              </a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>{{ systemSettings.copyright_text }}</p>
          <div class="footer-social">
            <el-button link size="small">
              <el-icon><Message /></el-icon>
            </el-button>
            <el-button link size="small">
              <el-icon><Share /></el-icon>
            </el-button>
          </div>
        </div>
      </div>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref, reactive, computed, onMounted, onUnmounted, nextTick, watch } from 'vue'
import { useRouter } from 'vue-router'
import { ElMessage, ElMessageBox } from 'element-plus'
import { getPopularTags } from '@/api/tags'
import { userActionApi, type UserAction } from '@/api/userActions'
import { packageApi } from '@/api/packages'
import { useSettings } from '@/composables/useSettings'
import {
  Search,
  User,
  Setting,
  Download,
  Star,
  Calendar,
  Document,
  Collection,
  Bottom,
  Switch,
  Message,
  Phone,
  Location,
  Grid,
  List,
  RefreshLeft,
  Filter,
  PriceTag,
  ChatDotRound,
  ArrowRight,
  View,
  BellFilled,
  InfoFilled,
  TrendCharts,
  Plus,
  ChatLineRound,
  Clock,
  Menu,
  Bell,
  MoreFilled,
  ArrowDown,
  Share,
  Refresh,
  Trophy
} from '@element-plus/icons-vue'
import type { FormInstance } from 'element-plus'
import ThemeSwitcher from '@/components/ThemeSwitcher.vue'
import { communityApi } from '@/api/community'
import type { Resource } from '@/types'
import { getUserInfo } from '@/utils/auth'
import { formatDate as formatDateUtil, formatFileSize } from '@/utils/format'
import { categoryApi, type Category } from '@/api/categories'
import { getActiveAnnouncements, type Announcement } from '@/api/announcements'
import type { Package } from '@/api/packages'
import { getPosts, type Post, type PostListResponse } from '@/api/posts'
import userActionService from '@/utils/userActionService'
import { handleDownloadError } from '@/utils/downloadErrorHandler'


const router = useRouter()

// Á≥ªÁªüËÆæÁΩÆ
const { systemSettings, loadSystemSettings, loadCommunitySettings } = useSettings()

// Ëß£ÊûêÈ°µËÑöÈìæÊé•ÈÖçÁΩÆ
const footerLinks = computed(() => {
  try {
    return JSON.parse(systemSettings.footer_links || '{}')
  } catch {
    return {
      community: { title: "Á§æÂå∫", links: [{ text: "ÂÖ≥‰∫éÊàë‰ª¨", url: "/about" }] },
      developer: { title: "ÂºÄÂèëËÄÖ", links: [{ text: "API ÊñáÊ°£", url: "/api-docs" }] },
      support: { title: "ÊîØÊåÅ", links: [{ text: "ËÅîÁ≥ªÊàë‰ª¨", url: "/contact" }] }
    }
  }
})

// ÂìçÂ∫îÂºèÊï∞ÊçÆ
const searchQuery = ref('')
const activeCategory = ref('all')
const sortBy = ref('latest')
const filterType = ref('all')
const contentType = ref('resources') // ÂÜÖÂÆπÁ±ªÂûãÔºö'resources' Êàñ 'posts'

// Èù¢ÊùøÊäòÂè†Áä∂ÊÄÅ
const categoryPanelExpanded = ref(true)
const announcementPanelExpanded = ref(true)

const totalResources = ref(0)

const loading = ref(false)

// ÁªüËÆ°Êï∞ÊçÆ
const totalDownloads = ref(0)
const totalUsers = ref(0)
const totalLikes = ref(0)

// ÂàÜÈ°µÊï∞ÊçÆ
const currentPage = ref(1)
const pageSize = ref(12)

// ÂÖ¨ÂëäÊï∞ÊçÆ
const notices = ref<{ id: number; text: string; created_at: string }[]>([])

// Áî®Êà∑‰ø°ÊÅØ
const userInfo = computed(() => {
  return getUserInfo() || { username: 'Áî®Êà∑' }
})

// ÁôªÂΩïÁä∂ÊÄÅ
const isLoggedIn = computed(() => {
  return !!getUserInfo()
})

// Ëé∑ÂèñÂÖ¨ÂëäÊï∞ÊçÆ
const fetchAnnouncements = async () => {
  try {
    console.log('üîî ÂºÄÂßãËé∑ÂèñÂÖ¨ÂëäÊï∞ÊçÆ...')
    const res = await getActiveAnnouncements()
    console.log('üîî ÂÖ¨ÂëäAPIÂìçÂ∫î:', res)
    
    if (res.code === 0 && res.data) {
      // Â§ÑÁêÜ‰∏çÂêåÁöÑÊï∞ÊçÆÁªìÊûÑÂèØËÉΩÊÄß
      if (Array.isArray(res.data)) {
        // Â¶ÇÊûúÊòØÊï∞ÁªÑÔºåÁõ¥Êé•‰ΩøÁî®
        notices.value = res.data.map(announcement => ({
          id: announcement.id,
          text: announcement.title + ': ' + announcement.content,
          created_at: announcement.created_at || new Date().toISOString()
        }))
      } else if (res.data.list && Array.isArray(res.data.list)) {
        // Â¶ÇÊûúÊòØ {list: []} Ê†ºÂºè
        notices.value = res.data.list.map((announcement: any) => ({
          id: announcement.id,
          text: announcement.title + ': ' + announcement.content,
          created_at: announcement.created_at || new Date().toISOString()
        }))
      } else {
        // Â¶ÇÊûúÊòØÂçï‰∏™ÂØπË±°
        console.warn('ÂÖ¨ÂëäÊï∞ÊçÆ‰∏çÊòØÈ¢ÑÊúüÁöÑÊï∞ÁªÑÊ†ºÂºè:', res.data)
      }
    } else {
      console.error('Ëé∑ÂèñÂÖ¨ÂëäÂ§±Ë¥•:', res.message)
    }
  } catch (error: any) {
    console.error('‚ùå Âä†ËΩΩÂÖ¨ÂëäÂá∫Èîô:', error)
    if (error.response) {
      console.error('APIÈîôËØØÂìçÂ∫î:', error.response.data)
      ElMessage.warning(`Ëé∑ÂèñÂÖ¨ÂëäÂ§±Ë¥•: ${error.response.data?.message || error.message}`)
    } else {
      ElMessage.warning('Ëé∑ÂèñÂÖ¨ÂëäÂ§±Ë¥•ÔºöÁΩëÁªúËøûÊé•ÈîôËØØ')
    }
  }
}

// ÂàÜÁ±ªÊï∞ÊçÆ
const categories = ref<Category[]>([])

// ÂàÜÁ±ªÊ†áÁ≠æÊò†Â∞Ñ
const categoryLabels = {
  tutorial: 'ÊïôÁ®ã',
  tool: 'Â∑•ÂÖ∑',
  template: 'Ê®°Êùø',
  other: 'ÂÖ∂‰ªñ'
}

// ËµÑÊ∫êÊï∞ÊçÆ
const resources = ref<Package[]>([])

// Â∏ñÂ≠êÊï∞ÊçÆ
const posts = ref<Post[]>([])
const postsTotal = ref(0)
const postsCurrentPage = ref(1)
const postsPageSize = ref(5)

// Á≤æÈÄâËµÑÊ∫êÊï∞ÊçÆ
const featuredResources = computed(() => {
  // ÈÄâÊã©‰∏ãËΩΩÈáèÊúÄÈ´òÁöÑËµÑÊ∫ê‰Ωú‰∏∫Á≤æÈÄâ
  return resources.value
    .slice()
    .sort((a, b) => b.download_count - a.download_count)
    .slice(0, 6) // ÊòæÁ§∫Ââç6‰∏™Á≤æÈÄâËµÑÊ∫ê
})

// Á≤æÈÄâËµÑÊ∫êÂàÜÁªÑÔºàÊØèÁªÑ3‰∏™ÔºåÁî®‰∫éËΩÆÊí≠Ôºâ
const featuredResourceGroups = computed(() => {
  const groups = []
  for (let i = 0; i < featuredResources.value.length; i += 3) {
    groups.push(featuredResources.value.slice(i, i + 3))
  }
  return groups
})



// ËÆ°ÁÆóÂ±ûÊÄß
const filteredResources = computed(() => {
  // ÂÖàÂ§çÂà∂‰∏Ä‰ªΩÊï∞ÊçÆÔºåÈÅøÂÖçÁõ¥Êé•‰øÆÊîπÂìçÂ∫îÂºèÊ∫êÊï∞ÁªÑÂØºËá¥ÈÄíÂΩíÊõ¥Êñ∞
  let filtered = [...resources.value]

  // ÂàÜÁ±ªÁ≠õÈÄâ
  if (activeCategory.value !== 'all') {
    filtered = filtered.filter(resource => resource.category_id === parseInt(activeCategory.value))
  }

  // ÊêúÁ¥¢Á≠õÈÄâ
  if (searchQuery.value) {
    const query = searchQuery.value.toLowerCase()
    filtered = filtered.filter(resource =>
      resource.name.toLowerCase().includes(query) ||
      resource.description?.toLowerCase().includes(query) ||
      resource.author.toLowerCase().includes(query)
    )
  }

  // ÊéíÂ∫èÔºàÁΩÆÈ°∂ÂíåÁ≤æÂçéÂÜÖÂÆπ‰ºòÂÖàÔºâ
  filtered.sort((a, b) => {
    // ÁΩÆÈ°∂‰ºòÂÖàÁ∫ßÊúÄÈ´ò
    if (a.is_pinned && !b.is_pinned) return -1
    if (!a.is_pinned && b.is_pinned) return 1
    
    // Âú®Áõ∏ÂêåÁΩÆÈ°∂Áä∂ÊÄÅ‰∏ãÔºåÁ≤æÂçéÂÜÖÂÆπ‰ºòÂÖà
    if (a.is_featured && !b.is_featured) return -1
    if (!a.is_featured && b.is_featured) return 1
    
    // Âú®Áõ∏ÂêåÁΩÆÈ°∂ÂíåÁ≤æÂçéÁä∂ÊÄÅ‰∏ãÔºåÊåâÊåáÂÆöÊéíÂ∫èÊñπÂºèÊéíÂ∫è
  switch (sortBy.value) {
    case 'latest':
        return new Date(b.created_at).getTime() - new Date(a.created_at).getTime()
    case 'downloads':
        return b.download_count - a.download_count
    case 'likes':
        return (b.like_count || 0) - (a.like_count || 0)
    case 'favorites':
        return (b.favorite_count || 0) - (a.favorite_count || 0)
      default:
        return 0
  }
  })

  return filtered
})

// Âä†ËΩΩÂ∏ñÂ≠êÊï∞ÊçÆ
const loadPosts = async () => {
  try {
    const params = {
      page: postsCurrentPage.value,
      page_size: postsPageSize.value,
      status: 'Published'
    }
    
    const res = await getPosts(params)
    
    if (res.code === 0 && res.data) {
      // ÊâπÈáèÊõ¥Êñ∞Â∏ñÂ≠êÊï∞ÊçÆ
      await nextTick()
      posts.value = res.data.list
      postsTotal.value = res.data.total
    } else {
      console.error('Ëé∑ÂèñÂ∏ñÂ≠êÂ§±Ë¥•:', res.message)
    }
  } catch (error) {
    console.error('Âä†ËΩΩÂ∏ñÂ≠êÂá∫Èîô:', error)
  }
}

// ÊñπÊ≥ï
const loadResources = async () => {
    loading.value = true
  try {
    const params: any = {}
    
    // Ê∑ªÂä†ÂàÜÁ±ªËøáÊª§
    if (activeCategory.value !== 'all') {
      params.category_id = parseInt(activeCategory.value)
    }
    
    // Ê∑ªÂä†ÊêúÁ¥¢ËøáÊª§
    if (searchQuery.value) {
      params.search = searchQuery.value
    }
    
    // Ê∑ªÂä†ÊéíÂ∫èÂíåÁ±ªÂûãËøáÊª§
    params.sort = sortBy.value
    if (filterType.value !== 'all') {
      params.type = filterType.value
    }
    
    // ËΩ¨Êç¢ÂàÜÈ°µÂèÇÊï∞‰ª•Á¨¶ÂêàÂêéÁ´Ø packages Êé•Âè£
    params.page = currentPage.value
    params.pageSize = pageSize.value
    
    console.log("ËØ∑Ê±ÇËµÑÊ∫êÂèÇÊï∞:", params)
    const res = await packageApi.getPackages(params)
    
    if (res.code === 0 && res.data) {
      // ‰ΩøÁî®nextTickÊâπÈáèÊõ¥Êñ∞ÔºåÈÅøÂÖçÂêåÊó∂Ëß¶ÂèëÂ§ö‰∏™ÂìçÂ∫îÂºèÊõ¥Êñ∞
      await nextTick()
      
      // È¶ñÂÖàËÆæÁΩÆ‰∏ªË¶ÅÊï∞ÊçÆ
      resources.value = res.data.list
      totalResources.value = res.data.total
      
      // Âª∂ËøüËÆ°ÁÆóÁªüËÆ°Êï∞ÊçÆÔºåÈÅøÂÖçÂú®Âêå‰∏ÄÊ∏≤ÊüìÂë®ÊúüÂÜÖÂ§öÊ¨°Êõ¥Êñ∞
      nextTick(() => {
        totalDownloads.value = resources.value.reduce((sum, resource) => sum + (resource.download_count || 0), 0)
        totalLikes.value = resources.value.reduce((sum, resource) => sum + (resource.like_count || 0), 0)
        totalUsers.value = Math.floor(Math.random() * 1000) + 500
      })
    } else {
      ElMessage.error(res.message || 'Âä†ËΩΩËµÑÊ∫êÂ§±Ë¥•')
    }
  } catch (error) {
    console.error('Âä†ËΩΩËµÑÊ∫êÂá∫Èîô:', error)
    ElMessage.error('Âä†ËΩΩËµÑÊ∫êÊó∂ÂèëÁîüÈîôËØØ')
  } finally {
    loading.value = false
  }
}

const handleSearch = () => {
  loadResources() // ÈáçÊñ∞Âä†ËΩΩËµÑÊ∫ê
}

// Â§ÑÁêÜÂàÜÁ±ªÂàáÊç¢
const handleCategoryChange = (tab: any) => {
  console.log("ÂàÜÁ±ªÂàáÊç¢Âà∞:", tab.props.name)
  activeCategory.value = tab.props.name
  loadResources() // ÈáçÊñ∞Âä†ËΩΩËµÑÊ∫ê
}

const handleSortChange = () => {
  // ÂÆ¢Êà∑Á´ØÊéíÂ∫èÔºåÊó†ÈúÄÈáçÊñ∞ËØ∑Ê±Ç
  // Â¶ÇÊûúÂêéÁ´ØÊîØÊåÅÊéíÂ∫èÔºåÂèØ‰ª•Âú®ËøôÈáåÈáçÊñ∞ËØ∑Ê±ÇÊï∞ÊçÆ
}

const handleFilterChange = () => {
  // Â¶ÇÊûúÂêéÁ´ØÊîØÊåÅÊåâËµÑÊ∫êÁ±ªÂûãÁ≠õÈÄâÔºåÂèØ‰ª•Âú®ËøôÈáåÈáçÊñ∞ËØ∑Ê±ÇÊï∞ÊçÆ
}



const viewResource = (id: number) => {
  router.push(`/resource/${id}`)
}

const downloadResource = async (id: number) => {
  try {
    const res = await communityApi.downloadResource(id)
    if (res.code === 0) {
      ElMessage.success('‰∏ãËΩΩÁªüËÆ°ÊàêÂäü')
      
      // ËÆ∞ÂΩï‰∏ãËΩΩË°å‰∏∫
      const resource = resources.value.find((r: any) => r.id === id)
      userActionService.logDownload('Package', id, `‰∏ãËΩΩ‰∫ÜËµÑÊ∫ê: ${resource?.name || 'Êú™Áü•ËµÑÊ∫ê'}`)
        .catch((err: any) => console.error('ËÆ∞ÂΩï‰∏ãËΩΩË°å‰∏∫Â§±Ë¥•:', err))
      
      loadResources()
    } else {
      ElMessage.error(res.msg || '‰∏ãËΩΩÂ§±Ë¥•')
    }
  } catch (error: any) {
    handleDownloadError(error, '‰∏ãËΩΩÂ§±Ë¥•')
  }
}

const goToLogin = () => {
  router.push('/login')
}

// ÂàáÊç¢ÂàÜÁ±ªÈù¢ÊùøÂ±ïÂºÄ/ÊäòÂè†Áä∂ÊÄÅ
const toggleCategoryPanel = () => {
  categoryPanelExpanded.value = !categoryPanelExpanded.value
}

// ÂàáÊç¢ÂÖ¨ÂëäÈù¢ÊùøÂ±ïÂºÄ/ÊäòÂè†Áä∂ÊÄÅ
const toggleAnnouncementPanel = () => {
  announcementPanelExpanded.value = !announcementPanelExpanded.value
}

const goToAdmin = () => {
  console.log('isLoggedIn:', localStorage.getItem('isLoggedIn'))
  console.log('userInfo:', localStorage.getItem('userInfo'))
  const user = getUserInfo && getUserInfo()
  if (!user) {
    router.push('/login')
    return
  }
  if (user.role === 'admin' || user.role === 'moderator') {
    router.push('/admin')
  } else if (user.role === 'elder') {
    router.push('/elder')
  } else if (user.role === 'user') {
    router.push('/user')
  } else {
    router.push('/403')
  }
}

const goToUserProfile = () => {
  const user = getUserInfo()
  if (user?.role === 'elder') {
    router.push('/elder/profile')
  } else if (user?.role === 'user') {
    router.push('/user/profile')
  } else if (user?.role === 'admin') {
    router.push('/admin/users')
  } else {
    router.push('/login')
  }
}

const handleLogout = async () => {
  try {
    await ElMessageBox.confirm(
      'Á°ÆÂÆöË¶ÅÈÄÄÂá∫ÁôªÂΩïÂêóÔºü',
      'Á°ÆËÆ§ÈÄÄÂá∫',
      {
        confirmButtonText: 'Á°ÆÂÆö',
        cancelButtonText: 'ÂèñÊ∂à',
        type: 'warning'
      }
    )
    
    // Ê∏ÖÈô§Áî®Êà∑‰ø°ÊÅØ
    localStorage.removeItem('token')
    localStorage.removeItem('userInfo')
    localStorage.removeItem('isLoggedIn')
    localStorage.removeItem('loginTime')
    localStorage.removeItem('remember_me')
    localStorage.removeItem('username')
    
    // Ê∏ÖÈô§Cookie
    document.cookie = 'auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'
    document.cookie = 'user_info=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'
    document.cookie = 'remember_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'
    
    ElMessage.success('Â∑≤ÈÄÄÂá∫ÁôªÂΩï')
    router.push('/login')
  } catch (error) {
    // Áî®Êà∑ÂèñÊ∂à
  }
}

const getCategoryLabel = (categoryId: number | null) => {
  if (!categoryId) return 'Êú™ÂàÜÁ±ª'
  const category = categories.value.find(c => c.id === categoryId)
  return category ? category.name : 'Êú™ÂàÜÁ±ª'
}

const getCategoryColor = (categoryId: any) => {
  const colorMap: { [key: string]: string } = {
    1: '#409EFF', // ËìùËâ≤
    2: '#67C23A', // ÁªøËâ≤
    3: '#E6A23C', // ÈªÑËâ≤
    4: '#F56C6C', // Á∫¢Ëâ≤
    5: '#909399'  // ÁÅ∞Ëâ≤
  }
  return colorMap[categoryId] || '#409EFF'
}

const formatDate = (date: string) => {
  return new Date(date).toLocaleDateString('zh-CN')
}

const formatNumber = (num: number) => {
  if (num >= 1000000) {
    return (num / 1000000).toFixed(1) + 'M'
  } else if (num >= 1000) {
    return (num / 1000).toFixed(1) + 'K'
  }
  return num.toLocaleString()
}



// Âä†ËΩΩÂàÜÁ±ªÊï∞ÊçÆ
const loadCategories = async () => {
  try {
    const res = await categoryApi.getCategories()
    if (res.code === 0 && res.data) {
      categories.value = res.data.list || []
      console.log("Ëé∑ÂèñÂà∞ÁöÑÂàÜÁ±ª:", categories.value)
    } else {
      console.error('Ëé∑ÂèñÂàÜÁ±ªÂ§±Ë¥•:', res.message)
    }
  } catch (error) {
    console.error('Âä†ËΩΩÂàÜÁ±ªÂá∫Èîô:', error)
  }
}

// ÁßªÈô§ÈáçÂ§çÁöÑÂàùÂßãÂåñ - ‰ΩøÁî®‰∏ãÈù¢ÁöÑÁªü‰∏ÄÂàùÂßãÂåñ

const scrollToTop = () => {
  window.scrollTo({ top: 0, behavior: 'smooth' })
}

const scrollToPosts = () => {
  const postsSection = document.getElementById('posts-section')
  if (postsSection) {
    postsSection.scrollIntoView({ behavior: 'smooth' })
  }
}

// ÁîüÊàêÁ≤íÂ≠êÊ†∑Âºè
const getParticleStyle = (index: number) => {
  const size = Math.random() * 8 + 4 // 4-12px
  const left = Math.random() * 100 // 0-100%
  const top = Math.random() * 100 // 0-100%
  const animationDelay = Math.random() * 15 // 0-15s
  const animationDuration = Math.random() * 10 + 10 // 10-20s
  
  return {
    width: `${size}px`,
    height: `${size}px`,
    left: `${left}%`,
    top: `${top}%`,
    animationDelay: `${animationDelay}s`,
    animationDuration: `${animationDuration}s`
  }
}

const getCategoryCount = (categoryId: number) => {
  return resources.value.filter(resource => resource.category_id === categoryId).length
}

const viewMode = ref('grid')

const authorFilter = ref('')
const downloadFilter = ref('')
const dateFilter = ref('')
const keywordFilter = ref('')
const sizeFilter = ref('')
const tagFilter = ref('')
const advancedSortBy = ref('newest')
const showAdvancedFilters = ref(false)

const hasActiveFilters = computed(() => {
  return authorFilter.value || downloadFilter.value || dateFilter.value || keywordFilter.value || sizeFilter.value || tagFilter.value
})

const uniqueAuthors = computed(() => {
  return Array.from(new Set(resources.value.map(resource => resource.author)))
})

// Ê∑ªÂä†ËÆ°ÁÆóÁºìÂ≠ò‰ª•‰ºòÂåñÊÄßËÉΩ
const paginatedResourcesCache = ref(null)
let paginatedResourcesTimer: number | null = null

const paginatedResources = computed(() => {
  // ÁÆÄÂçïÁöÑÈò≤ÊäñÊú∫Âà∂ÔºåÈÅøÂÖçÈ¢ëÁπÅÈáçÊñ∞ËÆ°ÁÆó
  if (paginatedResourcesTimer) {
    clearTimeout(paginatedResourcesTimer)
  }
  
  let filtered = filteredResources.value

  // ‰ΩúËÄÖÁ≠õÈÄâ - ‰ºòÂåñÂ≠óÁ¨¶‰∏≤ÊØîËæÉ
  if (authorFilter.value) {
    const authorQuery = authorFilter.value.toLowerCase()
    filtered = filtered.filter(resource => resource.author.toLowerCase().includes(authorQuery))
  }

  // ‰∏ãËΩΩÈáèÁ≠õÈÄâ
  if (downloadFilter.value) {
    filtered = filtered.filter(resource => {
      const downloadCount = resource.download_count || 0
      switch (downloadFilter.value) {
        case '0-10':
          return downloadCount >= 0 && downloadCount <= 10
        case '11-50':
          return downloadCount >= 11 && downloadCount <= 50
        case '51-100':
          return downloadCount >= 51 && downloadCount <= 100
        case '100+':
          return downloadCount > 100
        default:
          return true
      }
    })
  }

  // Êó•ÊúüÁ≠õÈÄâ - ‰ºòÂåñÔºöÁºìÂ≠òÊó•ÊúüËÆ°ÁÆóÁªìÊûú
  if (dateFilter.value) {
    // ÁÆÄÂåñÊó•ÊúüÁ≠õÈÄâÈÄªËæëÔºåÈÅøÂÖçÂ§çÊùÇÁöÑÊó•ÊúüËÆ°ÁÆó
    const now = Date.now()
    const filterDate = dateFilter.value
    
    filtered = filtered.filter(resource => {
      const createdAt = new Date(resource.created_at).getTime()
      const dayMs = 24 * 60 * 60 * 1000
      
      switch (filterDate) {
        case 'today':
          return now - createdAt <= dayMs
        case 'week':
          return now - createdAt <= 7 * dayMs
        case 'month':
          return now - createdAt <= 30 * dayMs
        case 'quarter':
          return now - createdAt <= 90 * dayMs
        default:
          return true
      }
    })
  }

  // ÂÖ≥ÈîÆËØçÁ≠õÈÄâ
  if (keywordFilter.value) {
    const query = keywordFilter.value.toLowerCase()
    filtered = filtered.filter(resource =>
      resource.name.toLowerCase().includes(query) ||
      resource.description?.toLowerCase().includes(query) ||
      resource.author.toLowerCase().includes(query)
    )
  }

  // Êñá‰ª∂Â§ßÂ∞èÁ≠õÈÄâ
  if (sizeFilter.value) {
    filtered = filtered.filter(resource => {
      const fileSize = resource.file_size || 0
      switch (sizeFilter.value) {
        case 'small':
          return fileSize < 1024 * 1024
        case 'medium':
          return fileSize >= 1024 * 1024 && fileSize < 10 * 1024 * 1024
        case 'large':
          return fileSize >= 10 * 1024 * 1024
        default:
          return true
      }
    })
  }

  // Ê†áÁ≠æÁ≠õÈÄâ
  if (tagFilter.value) {
    const tags = tagFilter.value.split(',').map(tag => tag.trim())
    filtered = filtered.filter(resource => {
      // ÁÆÄÂåñÊ†áÁ≠æÁ≠õÈÄâÔºöÂú®ËµÑÊ∫êÂêçÁß∞ÂíåÊèèËø∞‰∏≠ÊêúÁ¥¢Ê†áÁ≠æÂÖ≥ÈîÆËØç
      const query = tagFilter.value.toLowerCase()
      return resource.name.toLowerCase().includes(query) || 
             resource.description?.toLowerCase().includes(query)
    })
  }

  // ÊéíÂ∫è
  switch (advancedSortBy.value) {
    case 'newest':
      filtered.sort((a, b) => new Date(b.created_at).getTime() - new Date(a.created_at).getTime())
      break
    case 'oldest':
      filtered.sort((a, b) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime())
      break
    case 'most_downloaded':
      filtered.sort((a, b) => b.download_count - a.download_count)
      break
    case 'least_downloaded':
      filtered.sort((a, b) => a.download_count - b.download_count)
      break
    case 'name_asc':
      filtered.sort((a, b) => a.name.localeCompare(b.name))
      break
    case 'name_desc':
      filtered.sort((a, b) => b.name.localeCompare(a.name))
      break
  }

  // ÂàÜÈ°µÈÄªËæë
  const start = (currentPage.value - 1) * pageSize.value
  const end = start + pageSize.value
  return filtered.slice(start, end)
})

// Â∑≤Âà†Èô§ÈáçÂ§çÁöÑfilteredResourcesForPagination computedÂ±ûÊÄß
// Áªü‰∏Ä‰ΩøÁî®paginatedResourcesÊù•ÈÅøÂÖçÈáçÂ§çËÆ°ÁÆó

const clearFilters = () => {
  authorFilter.value = ''
  downloadFilter.value = ''
  dateFilter.value = ''
  keywordFilter.value = ''
  sizeFilter.value = ''
  tagFilter.value = ''
  advancedSortBy.value = 'newest'
  showAdvancedFilters.value = false
  currentPage.value = 1
}

// ÁõëÂê¨Á≠õÈÄâÊù°‰ª∂ÂèòÂåñÔºåÈáçÁΩÆÈ°µÁ†Å - Ê∑ªÂä†Èò≤Êäñ
let filterWatchTimer: number | null = null
watch([authorFilter, downloadFilter, dateFilter, keywordFilter, sizeFilter, tagFilter, advancedSortBy], () => {
  if (filterWatchTimer) {
    clearTimeout(filterWatchTimer)
  }
  filterWatchTimer = window.setTimeout(() => {
    currentPage.value = 1
  }, 100)
})

const toggleAdvancedFilters = () => {
  showAdvancedFilters.value = !showAdvancedFilters.value
}

// Èò≤ÊäñËÆ°Êó∂Âô®
let backgroundUpdateTimer: number | null = null

// Âä®ÊÄÅËÆæÁΩÆËÉåÊôØÈ´òÂ∫¶‰ª•Ë¶ÜÁõñÊï¥‰∏™È°µÈù¢ÔºàÈò≤ÊäñÁâàÊú¨Ôºâ
const updateBackgroundHeight = () => {
  if (backgroundUpdateTimer) {
    clearTimeout(backgroundUpdateTimer)
  }
  
  backgroundUpdateTimer = window.setTimeout(() => {
    nextTick(() => {
      const homeContainer = document.querySelector('.home-container')
      const dynamicBackground = document.querySelector('.dynamic-background')
      const gradientLayer = document.querySelector('.gradient-layer')
      
      if (homeContainer && dynamicBackground && gradientLayer) {
        const containerHeight = homeContainer.scrollHeight
        const minHeight = Math.max(containerHeight, window.innerHeight)
        
        ;(dynamicBackground as HTMLElement).style.height = `${minHeight}px`
        ;(gradientLayer as HTMLElement).style.height = `${minHeight}px`
      }
      backgroundUpdateTimer = null
    })
  }, 100) // 100msÈò≤ÊäñÂª∂Ëøü
}

// Â≠òÂÇ®observerÂºïÁî®‰ª•‰æøÊ∏ÖÁêÜ
let mutationObserver: MutationObserver | null = null

// ËÉåÊôØÈ´òÂ∫¶Áõ∏ÂÖ≥ÈÄªËæëÂ∑≤ÂêàÂπ∂Âà∞‰∏ªonMountedÈí©Â≠ê‰∏≠

// Ê∏ÖÁêÜËµÑÊ∫ê
onUnmounted(() => {
  // Ê∏ÖÁêÜ‰∫ã‰ª∂ÁõëÂê¨Âô®
  window.removeEventListener('resize', updateBackgroundHeight)
  
  // Ê∏ÖÁêÜMutationObserver
  if (mutationObserver) {
    mutationObserver.disconnect()
    mutationObserver = null
  }
  
  // Ê∏ÖÁêÜÊâÄÊúâËÆ°Êó∂Âô®
  if (backgroundUpdateTimer) {
    clearTimeout(backgroundUpdateTimer)
    backgroundUpdateTimer = null
  }
  
  if (filterWatchTimer) {
    clearTimeout(filterWatchTimer)
    filterWatchTimer = null
  }
  
  if (paginatedResourcesTimer) {
    clearTimeout(paginatedResourcesTimer)
    paginatedResourcesTimer = null
  }
})

// onUpdatedÈí©Â≠êÂ∑≤ÁßªÈô§ÔºåÂõ†‰∏∫MutationObserverÂ∑≤ÁªèÁõëÂê¨ÊâÄÊúâDOMÂèòÂåñ
// ÈÅøÂÖç‰∏éMutationObserverÂΩ¢ÊàêÊó†ÈôêÈÄíÂΩíÂæ™ÁéØ

// Á§æÂå∫Âä®ÊÄÅÊï∞ÊçÆ
interface ActivityItem {
  id: number
  username: string
  action: string
  target: string
  user_avatar?: string
  created_at: string
}

const recentActivities = ref<ActivityItem[]>([])
const activitiesLoading = ref(false)

// Ëé∑ÂèñÁ§æÂå∫Âä®ÊÄÅ
const fetchRecentActivities = async () => {
  activitiesLoading.value = true
  try {
    console.log('üé≠ ÂºÄÂßãËé∑ÂèñÁ§æÂå∫Âä®ÊÄÅ...')
    // Ë∞ÉÁî®ÂÖ¨ÂºÄÁöÑÁ§æÂå∫Âä®ÊÄÅAPIÔºåÊó†ÈúÄËÆ§ËØÅ
    const response = await fetch('http://localhost:15201/api/v1/community/activities?page=1&page_size=20', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json',
      }
    }).then(res => res.json())
    console.log('üé≠ Á§æÂå∫Âä®ÊÄÅAPIÂìçÂ∫î:', response)
    console.log('üé≠ ÂìçÂ∫îÊï∞ÊçÆÁªìÊûÑ:', JSON.stringify(response, null, 2))

    if (response.code === 0) {
      // Ê£ÄÊü•Â§öÁßçÂèØËÉΩÁöÑÊï∞ÊçÆÁªìÊûÑ
      let actionsData = response.data?.actions || response.data || []
      console.log('üé≠ ÊèêÂèñÁöÑactionsÊï∞ÊçÆ:', actionsData)
      
      if (Array.isArray(actionsData) && actionsData.length > 0) {
        console.log('üé≠ ÂéüÂßãactionsÊï∞ÊçÆ:', actionsData)
        
        const filteredActivities = actionsData
        .filter((action: UserAction) => {
            // Âè™‰øùÁïôÁúüÊ≠£ÊúâÊÑè‰πâÁöÑÁî®Êà∑Êìç‰Ωú
            const meaningfulActions = ['Upload', 'Create', 'Comment', 'Download', 'Like', 'Share', 'Edit', 'Register']
            return meaningfulActions.includes(action.action_type)
        })
          .map((action: any) => {
            const { username, actionText, target, avatar } = parseActivityInfo(action)
          
          return {
            id: action.id,
            username,
            action: actionText,
            target,
              user_avatar: avatar,
            created_at: action.created_at
          }
        })
        .slice(0, 10) // ÂèñÂâç10Êù°ÊúâÊïàËÆ∞ÂΩï

      recentActivities.value = filteredActivities
        console.log('üé≠ ËÆæÁΩÆÁöÑÁ§æÂå∫Âä®ÊÄÅ:', filteredActivities)
      } else {
        console.log('üé≠ Ê≤°ÊúâËé∑ÂèñÂà∞ÊúâÊïàÁöÑactionsÊï∞ÊçÆ')
        recentActivities.value = []
      }
    } else {
      console.log('üé≠ APIÂìçÂ∫îcode‰∏ç‰∏∫0:', response.code, response.message)
      recentActivities.value = []
    }
  } catch (error: any) {
    console.error('‚ùå Ëé∑ÂèñÁ§æÂå∫Âä®ÊÄÅÂ§±Ë¥•:', error)
    recentActivities.value = []
    
    if (error.response) {
      console.error('APIÈîôËØØÂìçÂ∫î:', error.response.data)
      ElMessage.warning(`Ëé∑ÂèñÁ§æÂå∫Âä®ÊÄÅÂ§±Ë¥•: ${error.response.data?.message || error.message}`)
    } else {
      ElMessage.warning('Ëé∑ÂèñÁ§æÂå∫Âä®ÊÄÅÂ§±Ë¥•ÔºöÁΩëÁªúËøûÊé•ÈîôËØØ')
    }
  } finally {
    activitiesLoading.value = false
  }
}

// Âà§Êñ≠ÊòØÂê¶ÈúÄË¶ÅËøáÊª§ÁöÑÊìç‰Ωú
const isFilteredAction = (actionType: string, details?: string): boolean => {
  // Âè™ËøáÊª§ÊéâÁúüÊ≠£‰∏çÈúÄË¶ÅÊòæÁ§∫ÁöÑÊìç‰ΩúÁ±ªÂûã
  const filteredActions = [
    'Login',       // ÁôªÂΩï
    'Logout',      // ÁôªÂá∫
    'Search',      // ÊêúÁ¥¢Êìç‰Ωú
    'Click'        // ÁÇπÂáªÊìç‰Ωú
  ]
  
  // ËøáÊª§ÊïèÊÑü‰ø°ÊÅØÂÖ≥ÈîÆËØç
  const sensitiveKeywords = [
    'ip_address',
    'user_agent',
    'session',
    'token',
    'password',
    'ËÆøÈóÆÈ°µÈù¢',
    'ÁÇπÂáª‰∫Ü',
    'ÊêúÁ¥¢‰∫Ü'
  ]
  
  if (filteredActions.includes(actionType)) {
    return true
  }
  
  if (details) {
    return sensitiveKeywords.some(keyword => 
      details.toLowerCase().includes(keyword.toLowerCase())
    )
  }
  
  return false
}

// Ëß£ÊûêÊ¥ªÂä®‰ø°ÊÅØ
const parseActivityInfo = (action: any) => {
  // ‰ΩøÁî®ËøîÂõûÁöÑÁî®Êà∑‰ø°ÊÅØ
  let username = null
  let avatar = null
  
  // Ê£ÄÊü•ÊòØÂê¶ÊúâÊúâÊïàÁöÑÁî®Êà∑‰ø°ÊÅØ
  if (action.user_id === null || action.user_id === -1 || !action.username || action.username === 'null') {
    username = null // Êú™ÁôªÂΩïÁî®Êà∑‰∏çÊòæÁ§∫Áî®Êà∑Âêç
  } else if (action.nickname) {
    username = action.nickname
  } else if (action.username) {
    username = action.username
  } else {
    username = `Áî®Êà∑${action.user_id}`
  }
  
  // Ëé∑ÂèñÁî®Êà∑Â§¥ÂÉè
  if (action.avatar) {
    avatar = action.avatar
  }
  
  // Ê†πÊçÆÊòØÂê¶ÊúâÁî®Êà∑‰ø°ÊÅØÂÜ≥ÂÆöÂä®‰ΩúÊñáÊú¨Ê†ºÂºè
  let actionText = username ? formatActionType(action.action_type) : formatActionTypePassive(action.action_type)
  let target = 'Êüê‰∏™ÂÜÖÂÆπ'
  
  // Ëß£ÊûêdetailsËé∑ÂèñÊõ¥ÂÖ∑‰ΩìÁöÑ‰ø°ÊÅØ
  if (action.details) {
    // È°µÈù¢ËÆøÈóÆÁâπÊÆäÂ§ÑÁêÜ
    if (action.action_type === 'PageView') {
      // Ëß£ÊûêÈ°µÈù¢Ë∑ØÂæÑ
      const pageMatch = action.details.match(/ËÆøÈóÆÈ°µÈù¢[:Ôºö]\s*(.+)/)
      if (pageMatch) {
        const pagePath = pageMatch[1]
        // Â∞ÜË∑ØÂæÑËΩ¨Êç¢‰∏∫ÂèãÂ•ΩÁöÑÈ°µÈù¢ÂêçÁß∞
        const pageNames: Record<string, string> = {
          '/admin': 'ÁÆ°ÁêÜÂêéÂè∞',
          '/admin/posts': 'Â∏ñÂ≠êÁÆ°ÁêÜ',
          '/admin/packages': 'ËµÑÊ∫êÁÆ°ÁêÜ',
          '/admin/categories': 'ÂàÜÁ±ªÁÆ°ÁêÜ',
          '/admin/users': 'Áî®Êà∑ÁÆ°ÁêÜ',
          '/posts': 'Â∏ñÂ≠êÂàóË°®',
          '/packages': 'ËµÑÊ∫êÂàóË°®',
          '/categories': 'ÂàÜÁ±ªÈ°µÈù¢',
          '/home': 'È¶ñÈ°µ'
        }
        target = pageNames[pagePath] || pagePath.replace('/', '')
      } else {
        target = 'Êüê‰∏™È°µÈù¢'
      }
    }
    // ÂÖ∂‰ªñÁ±ªÂûãÁöÑËØ¶ÊÉÖËß£Êûê
    else if (!isFilteredAction(action.action_type, action.details)) {
    // Â∞ùËØïÊèêÂèñÂÜÖÂÆπÊ†áÈ¢òÊàñÂêçÁß∞
    if (action.details.includes('Â∏ñÂ≠ê:') || action.details.includes('ÊñáÁ´†:')) {
      const titleMatch = action.details.match(/(?:Â∏ñÂ≠ê|ÊñáÁ´†)[:Ôºö]\s*(.+)/)
      if (titleMatch) {
        target = titleMatch[1].slice(0, 20) + (titleMatch[1].length > 20 ? '...' : '')
      }
    } else if (action.details.includes('ËµÑÊ∫ê:') || action.details.includes('ÂåÖ:')) {
      const titleMatch = action.details.match(/(?:ËµÑÊ∫ê|ÂåÖ)[:Ôºö]\s*(.+)/)
      if (titleMatch) {
        target = titleMatch[1].slice(0, 20) + (titleMatch[1].length > 20 ? '...' : '')
      }
    } else if (action.details.includes('ËØÑËÆ∫:')) {
      const commentMatch = action.details.match(/ËØÑËÆ∫[:Ôºö]\s*(.+)/)
      if (commentMatch) {
        target = `"${commentMatch[1].slice(0, 30)}${commentMatch[1].length > 30 ? '...' : ''}"`
      }
    } else {
      // ÈÄöÁî®Ëß£ÊûêÔºöÂèñÁ¨¨‰∏Ä‰∏™ÊúâÊÑè‰πâÁöÑËØç‰Ωú‰∏∫ÁõÆÊ†á
        const words = action.details.split(/\s+/).filter((word: string) => 
        word.length > 1 && !word.includes('Áî®Êà∑') && !word.includes('Êìç‰Ωú')
      )
      if (words.length > 0) {
        target = words[0].slice(0, 15) + (words[0].length > 15 ? '...' : '')
        }
      }
    }
  }
  
  return { username, actionText, target, avatar }
}

// Ê†ºÂºèÂåñÊìç‰ΩúÁ±ªÂûã‰∏∫ÂèãÂ•ΩÊòæÁ§∫
const formatActionType = (actionType: string): string => {
  const actionMap: Record<string, string> = {
    'Register': 'Ê≥®ÂÜå‰∫ÜË¥¶Âè∑',
    'Upload': '‰∏ä‰º†‰∫ÜËµÑÊ∫ê',
    'Download': '‰∏ãËΩΩ‰∫Ü',
    'Comment': 'ËØÑËÆ∫‰∫Ü',
    'Like': 'ÁÇπËµû‰∫Ü',
    'Share': 'ÂàÜ‰∫´‰∫Ü',
    'Edit': 'ÁºñËæë‰∫Ü',
    'Delete': 'Âà†Èô§‰∫Ü',
    'Create': 'ÂàõÂª∫‰∫Ü',
    'Update': 'Êõ¥Êñ∞‰∫Ü',
    'Post': 'ÂèëÂ∏É‰∫ÜÂ∏ñÂ≠ê',
    'Reply': 'ÂõûÂ§ç‰∫Ü',
    'PageView': 'ËÆøÈóÆ‰∫Ü',
    'Login': 'ÁôªÂΩï‰∫ÜÁ≥ªÁªü',
    'Logout': 'ÈÄÄÂá∫‰∫ÜÁ≥ªÁªü'
  }
  return actionMap[actionType] || `${actionType.toLowerCase()}`
}

// Ë¢´Âä®ËØ≠ÊÄÅÊ†ºÂºèÔºàÁî®‰∫éÊú™ÁôªÂΩïÁî®Êà∑Ôºâ
const formatActionTypePassive = (actionType: string): string => {
  const actionMap: Record<string, string> = {
    'Register': 'Ë¢´Ê≥®ÂÜå',
    'Upload': 'Ë¢´‰∏ä‰º†',
    'Download': 'Ë¢´‰∏ãËΩΩ',
    'Comment': 'Ë¢´ËØÑËÆ∫',
    'Like': 'Ë¢´ÁÇπËµû',
    'Share': 'Ë¢´ÂàÜ‰∫´',
    'Edit': 'Ë¢´ÁºñËæë',
    'Delete': 'Ë¢´Âà†Èô§',
    'Create': 'Ë¢´ÂàõÂª∫',
    'Update': 'Ë¢´Êõ¥Êñ∞',
    'Post': 'Ë¢´ÂèëÂ∏É',
    'Reply': 'Ë¢´ÂõûÂ§ç',
    'PageView': 'Ë¢´ËÆøÈóÆ',
    'Login': 'Ë¢´ÁôªÂΩï',
    'Logout': 'Ë¢´ÈÄÄÂá∫'
  }
  return actionMap[actionType] || `Ë¢´${actionType.toLowerCase()}`
}

// Ê†ºÂºèÂåñÊó∂Èó¥ÊñπÊ≥ï
const formatTime = (dateString: string) => {
  if (!dateString) return 'ÂàöÂàö'
  
  const date = new Date(dateString)
  const now = new Date()
  const diff = now.getTime() - date.getTime()
  
  const minutes = Math.floor(diff / (1000 * 60))
  const hours = Math.floor(diff / (1000 * 60 * 60))
  const days = Math.floor(diff / (1000 * 60 * 60 * 24))
  
  if (minutes < 1) return 'ÂàöÂàö'
  if (minutes < 60) return `${minutes}ÂàÜÈíüÂâç`
  if (hours < 24) return `${hours}Â∞èÊó∂Ââç`
  if (days < 30) return `${days}Â§©Ââç`
  
  return date.toLocaleDateString()
}

// Â∫îÁî®ÊéíÂ∫èÊñπÊ≥ï
const applySorting = () => {
  // ÊéíÂ∫èÈÄªËæëÂ∑≤Âú®computed‰∏≠ÂÆûÁé∞
  currentPage.value = 1
}

// ÈáçÁΩÆÁ≠õÈÄâÊñπÊ≥ï
const resetFilters = () => {
  searchQuery.value = ''
  activeCategory.value = 'all'
  sortBy.value = 'created_at'
  currentPage.value = 1
  loadResources()
}

// ÂàÜÈ°µÂ§ÑÁêÜÊñπÊ≥ï
const handleSizeChange = (newSize: number) => {
  pageSize.value = newSize
  currentPage.value = 1
}

const handleCurrentChange = (newPage: number) => {
  currentPage.value = newPage
}

// Â∏ñÂ≠êÂàÜÈ°µÂ§ÑÁêÜÊñπÊ≥ï
const handlePostsSizeChange = (newSize: number) => {
  postsPageSize.value = newSize
  postsCurrentPage.value = 1
  loadPosts()
}

const handlePostsCurrentChange = (newPage: number) => {
  postsCurrentPage.value = newPage
  loadPosts()
}

// Ê†áÁ≠æÊêúÁ¥¢ÊñπÊ≥ï
const searchByTag = (tagName: string) => {
  searchQuery.value = tagName
  handleSearch()
}

// Â∏ñÂ≠êÁõ∏ÂÖ≥ÊñπÊ≥ï
const goToCreatePost = () => {
  if (!isLoggedIn.value) {
    ElMessage.warning('ËØ∑ÂÖàÁôªÂΩï')
    router.push('/login')
    return
  }
  router.push('/posts/create')
}

const goToPostDetail = (postId: number) => {
  router.push(`/posts/${postId}`)
}

const goToPosts = () => {
  router.push('/posts')
}

// ÁªüËÆ°Êï∞ÊçÆ
const totalPosts = computed(() => posts.value.length)

// ‰∏∫ËµÑÊ∫êÂØπË±°Ê∑ªÂä†tagsÊîØÊåÅ
const getResourceWithTags = (resource: any) => {
  return {
    ...resource,
    tags: resource.tags || []
  }
}

// Êõ¥Êñ∞ÂÖ¨ÂëäÊï∞ÊçÆÁªìÊûÑ
const updateNotices = () => {
  notices.value = notices.value.map(notice => ({
    ...notice,
    created_at: notice.created_at || new Date().toISOString()
  }))
}

// ÁÉ≠Èó®Ê†áÁ≠æÊï∞ÊçÆ
interface HotTag {
  id?: number
  name: string
  count: number
  type: string
  color?: string
  description?: string
}

const hotTags = ref<HotTag[]>([])
const tagsLoading = ref(false)

// ÁÉ≠Èó®ÂÜÖÂÆπÊï∞ÊçÆ
interface PopularContent {
  id: number
  type: 'resource' | 'post'
  title: string
  views: number
  downloads?: number
  likes?: number
}

const popularContent = ref<PopularContent[]>([])
const popularContentLoading = ref(false)

// Ëé∑ÂèñÁÉ≠Èó®Ê†áÁ≠æ
const fetchPopularTags = async () => {
  tagsLoading.value = true
  try {
    console.log('üè∑Ô∏è ÂºÄÂßãËé∑ÂèñÁÉ≠Èó®Ê†áÁ≠æ...')
    const response = await getPopularTags()
    console.log('üè∑Ô∏è Ê†áÁ≠æAPIÂìçÂ∫î:', response)
    if (response.code === 0 && response.data) {
      // ‰∏∫Ê†áÁ≠æÊ∑ªÂä†ÈöèÊú∫Á±ªÂûãÁî®‰∫éÂ±ïÁ§∫
      const tagTypes = ['success', 'primary', 'info', 'warning', 'danger']
      hotTags.value = response.data.map((tag, index) => ({
        id: tag.id,
        name: tag.name,
        count: tag.use_count || 0,
        type: tagTypes[index % tagTypes.length],
        color: tag.color,
        description: tag.description
      }))
    }
  } catch (error: any) {
    console.error('‚ùå Ëé∑ÂèñÁÉ≠Èó®Ê†áÁ≠æÂ§±Ë¥•:', error)
    if (error.response) {
      console.error('APIÈîôËØØÂìçÂ∫î:', error.response.data)
      ElMessage.warning(`Ëé∑ÂèñÁÉ≠Èó®Ê†áÁ≠æÂ§±Ë¥•: ${error.response.data?.message || error.message}`)
    } else {
      ElMessage.warning('Ëé∑ÂèñÁÉ≠Èó®Ê†áÁ≠æÂ§±Ë¥•ÔºöÁΩëÁªúËøûÊé•ÈîôËØØ')
    }
  } finally {
    tagsLoading.value = false
  }
}

// Ëé∑ÂèñÁÉ≠Èó®ÂÜÖÂÆπ
const fetchPopularContent = async () => {
  popularContentLoading.value = true
  try {
    // Ëé∑ÂèñÁÉ≠Èó®ËµÑÊ∫êÂíåÂ∏ñÂ≠êÔºåÂêàÂπ∂Âπ∂ÊéíÂ∫è
    const [resourcesRes, postsRes] = await Promise.all([
      packageApi.getPackages({ pageSize: 10, status: 'Active' }),
      getPosts({ page_size: 10 })
    ])

    const popularItems: PopularContent[] = []

    // Â§ÑÁêÜËµÑÊ∫êÊï∞ÊçÆ
    if (resourcesRes.code === 0 && resourcesRes.data?.list) {
      resourcesRes.data.list.forEach((resource: any) => {
        popularItems.push({
          id: resource.id,
          type: 'resource',
          title: resource.name,
          views: resource.download_count || 0, // ËµÑÊ∫êÁî®‰∏ãËΩΩÈáè‰Ωú‰∏∫ÁÉ≠Â∫¶ÊåáÊ†á
          downloads: resource.download_count || 0,
          likes: resource.like_count || 0
        })
      })
    }

    // Â§ÑÁêÜÂ∏ñÂ≠êÊï∞ÊçÆ
    if (postsRes.code === 0 && postsRes.data?.list) {
      postsRes.data.list.forEach((post: any) => {
        popularItems.push({
          id: post.id,
          type: 'post',
          title: post.title,
          views: post.view_count || 0,
          likes: post.like_count || 0
        })
      })
    }

    // ÊåâÁÉ≠Â∫¶ÊéíÂ∫èÂπ∂ÂèñÂâç8‰∏™
    popularContent.value = popularItems
      .sort((a, b) => b.views - a.views)
      .slice(0, 8)

  } catch (error) {
    console.error('Ëé∑ÂèñÁÉ≠Èó®ÂÜÖÂÆπÂ§±Ë¥•:', error)
    ElMessage.warning('Ëé∑ÂèñÁÉ≠Èó®ÂÜÖÂÆπÂ§±Ë¥•')
  } finally {
    popularContentLoading.value = false
  }
}

// Ëé∑ÂèñÊéíÂêçÊ†∑ÂºèÁ±ª
const getRankClass = (index: number) => {
  if (index === 0) return 'rank-first'
  if (index === 1) return 'rank-second'  
  if (index === 2) return 'rank-third'
  return 'rank-normal'
}

// Ë∑≥ËΩ¨Âà∞ÂÜÖÂÆπËØ¶ÊÉÖ
const goToContent = (item: PopularContent) => {
  if (item.type === 'resource') {
    router.push(`/resource/${item.id}`)
  } else {
    router.push(`/posts/${item.id}`)
  }
}

// Â§ÑÁêÜÁ§æÂå∫Âä®ÊÄÅÁÇπÂáª‰∫ã‰ª∂
const handleActivityClick = (activity: ActivityItem) => {
  const action = activity.action.toLowerCase()
  
  if (action.includes('‰∏ä‰º†') || action.includes('ËµÑÊ∫ê')) {
    // ËµÑÊ∫êÁõ∏ÂÖ≥Êìç‰ΩúÔºåË∑≥ËΩ¨Âà∞ËµÑÊ∫êÂàÜÁ±ªÈ°µÈù¢
    router.push('/category')
    ElMessage.success('Êü•ÁúãÊúÄÊñ∞ËµÑÊ∫ê')
  } else if (action.includes('Â∏ñÂ≠ê') || action.includes('ÂèëÂ∏É‰∫ÜÂ∏ñÂ≠ê')) {
    // Â∏ñÂ≠êÁõ∏ÂÖ≥Êìç‰ΩúÔºåË∑≥ËΩ¨Âà∞Â∏ñÂ≠êÂàóË°®
    router.push('/posts')
    ElMessage.success('Êü•ÁúãÁ§æÂå∫Â∏ñÂ≠ê')
  } else if (action.includes('ËØÑËÆ∫') || action.includes('ÁÇπËµû')) {
    // ËØÑËÆ∫ÂíåÁÇπËµûÊìç‰ΩúÔºåË∑≥ËΩ¨Âà∞Â∏ñÂ≠êÂàóË°®Êü•ÁúãËÆ®ËÆ∫
    router.push('/posts')
    ElMessage.success('Êü•ÁúãÁ§æÂå∫ËÆ®ËÆ∫')
  } else if (action.includes('‰∏ãËΩΩ')) {
    // ‰∏ãËΩΩÊìç‰ΩúÔºåË∑≥ËΩ¨Âà∞ËµÑÊ∫êÈ°µÈù¢
    router.push('/category')
    ElMessage.success('Êü•ÁúãÁÉ≠Èó®ËµÑÊ∫ê')
  } else {
    // ÂÖ∂‰ªñÊìç‰ΩúÔºåË∑≥ËΩ¨Âà∞ÂØπÂ∫îÈ°µÈù¢
    router.push('/posts')
    ElMessage.info('Êü•ÁúãÁ§æÂå∫Âä®ÊÄÅ')
  }
}

// ÂàùÂßãÂåñÊó∂Êõ¥Êñ∞Êï∞ÊçÆÁªìÊûÑ
onMounted(async () => {
  console.log('üöÄ ÂºÄÂßãÂàùÂßãÂåñHomeÈ°µÈù¢...')
  
  // ÂàùÂßãÂåñËÉåÊôØÈ´òÂ∫¶
  updateBackgroundHeight()
  window.addEventListener('resize', updateBackgroundHeight)
  
  updateNotices()
  
  try {
    // Âä†ËΩΩÁ≥ªÁªüËÆæÁΩÆÂíåÁ§æÂå∫ËÆæÁΩÆ
    console.log('‚öôÔ∏è ÂºÄÂßãÂä†ËΩΩÁ≥ªÁªüÈÖçÁΩÆ...')
    await loadSystemSettings().catch(err => console.error('Á≥ªÁªüËÆæÁΩÆÂä†ËΩΩÂ§±Ë¥•:', err))
    await loadCommunitySettings().catch(err => console.error('Á§æÂå∫ËÆæÁΩÆÂä†ËΩΩÂ§±Ë¥•:', err))
    
    console.log('‚úÖ HomeÈ°µÈù¢ÂàùÂßãÂåñÂÆåÊàê!')
    
    // Âª∂ËøüÂä†ËΩΩÂÖ∂‰ªñÊï∞ÊçÆ‰ª•ÈÅøÂÖçÈÄíÂΩíÊõ¥Êñ∞
    setTimeout(async () => {
      console.log('üì¶ ÂºÄÂßãÂä†ËΩΩÂü∫Á°ÄÊï∞ÊçÆ...')
      await loadCategories().catch(err => console.error('ÂàÜÁ±ªÂä†ËΩΩÂ§±Ë¥•:', err))
      await loadResources().catch(err => console.error('ËµÑÊ∫êÂä†ËΩΩÂ§±Ë¥•:', err))
      await loadPosts().catch(err => console.error('Â∏ñÂ≠êÂä†ËΩΩÂ§±Ë¥•:', err))
      
      console.log('üî• ÂºÄÂßãÂä†ËΩΩÁÉ≠Èó®Êï∞ÊçÆ...')
      await fetchPopularTags().catch(err => console.error('ÁÉ≠Èó®Ê†áÁ≠æÂä†ËΩΩÂ§±Ë¥•:', err))
      await fetchPopularContent().catch(err => console.error('ÁÉ≠Èó®ÂÜÖÂÆπÂä†ËΩΩÂ§±Ë¥•:', err))
      await fetchRecentActivities().catch(err => console.error('Á§æÂå∫Âä®ÊÄÅÂä†ËΩΩÂ§±Ë¥•:', err))
      await fetchAnnouncements().catch(err => console.error('ÂÖ¨ÂëäÂä†ËΩΩÂ§±Ë¥•:', err))
      
      console.log('üéâ ÊâÄÊúâÊï∞ÊçÆÂä†ËΩΩÂÆåÊàê!')
    }, 100)
  } catch (error) {
    console.error('‚ùå ÂàùÂßãÂåñËøáÁ®ã‰∏≠Âá∫Èîô:', error)
  }
})
</script>

<style scoped>
/* ===== ‰ºòÂåñÁöÑCSSÂèòÈáèÁ≥ªÁªü ===== */
:global(:root) {
  /* ‰∏ªÈ¢òËâ≤ÂΩ©Á≥ªÁªü - ‰ºòÂåñÂØπÊØîÂ∫¶ÂíåÂèØËÆøÈóÆÊÄß */
  --color-primary: #2563eb;
  --color-primary-light: #3b82f6;
  --color-primary-dark: #1d4ed8;
  --color-secondary: #6366f1;
  --color-accent: #8b5cf6;
  --color-success: #059669;
  --color-warning: #d97706;
  --color-error: #dc2626;
  --color-info: #0891b2;
  
  /* È¢úËâ≤Âà´Âêç - ÂêëÂêéÂÖºÂÆπ */
  --primary-color: var(--color-primary);
  --primary-light: var(--color-primary-light);
  --primary-dark: var(--color-primary-dark);
  --secondary-color: var(--color-secondary);
  --brand-color: var(--color-primary);
  
  /* ÁÅ∞Ëâ≤Á≥ªÂà´Âêç */
  --gray-50: var(--color-gray-50);
  --gray-100: var(--color-gray-100);
  --gray-200: var(--color-gray-200);
  --gray-300: var(--color-gray-300);
  --gray-400: var(--color-gray-400);
  --gray-500: var(--color-gray-500);
  --gray-600: var(--color-gray-600);
  --gray-700: var(--color-gray-700);
  --gray-800: var(--color-gray-800);
  --gray-900: var(--color-gray-900);
  
  /* ‰∏≠ÊÄßËâ≤Á≥ª - Â¢ûÂº∫ÂØπÊØîÂ∫¶ */
  --color-white: #ffffff;
  --color-gray-50: #f8fafc;
  --color-gray-100: #f1f5f9;
  --color-gray-200: #e2e8f0;
  --color-gray-300: #cbd5e1;
  --color-gray-400: #94a3b8;
  --color-gray-500: #64748b;
  --color-gray-600: #475569;
  --color-gray-700: #334155;
  --color-gray-800: #1e293b;
  --color-gray-900: #0f172a;
  
  /* ËØ≠‰πâÂåñÊñáÂ≠óÈ¢úËâ≤ */
  --text-primary: var(--color-gray-900);
  --text-secondary: var(--color-gray-600);
  --text-tertiary: var(--color-gray-500);
  --text-disabled: var(--color-gray-400);
  --text-inverse: var(--color-white);
  --text-muted: var(--color-gray-500);
  
  /* ËØ≠‰πâÂåñËÉåÊôØËâ≤ */
  --bg-primary: var(--color-white);
  --bg-secondary: var(--color-gray-50);
  --bg-tertiary: var(--color-gray-100);
  --bg-elevated: var(--color-white);
  --bg-hover: rgba(99, 102, 241, 0.04);
  --bg-active: rgba(99, 102, 241, 0.08);
  --bg-glass: rgba(255, 255, 255, 0.6);
  --bg-glass-strong: rgba(255, 255, 255, 0.8);
  
  /* ËæπÊ°ÜËâ≤ÂΩ© */
  --border-light: var(--color-gray-200);
  --border-medium: var(--color-gray-300);
  --border-strong: var(--color-gray-400);
  --border-focus: var(--color-primary);
  --border-color: var(--color-gray-200);
  
  /* ‰ºòÂåñÁöÑÈò¥ÂΩ±Á≥ªÁªü - ÂáèÂ∞ëÈáçÁªò */
  --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.06);
  
  /* ÊØõÁéªÁíÉÊïàÊûú */
  --glass-backdrop: blur(16px) saturate(180%);
  --glass-border: 1px solid rgba(255, 255, 255, 0.2);
  
  /* Èó¥Ë∑ùÁ≥ªÁªü - 8ptÁΩëÊ†º */
  --space-0: 0;
  --space-1: 0.25rem;  /* 4px */
  --space-2: 0.5rem;   /* 8px */
  --space-3: 0.75rem;  /* 12px */
  --space-4: 1rem;     /* 16px */
  --space-5: 1.25rem;  /* 20px */
  --space-6: 1.5rem;   /* 24px */
  --space-8: 2rem;     /* 32px */
  --space-10: 2.5rem;  /* 40px */
  --space-12: 3rem;    /* 48px */
  --space-16: 4rem;    /* 64px */
  --space-20: 5rem;    /* 80px */
  --space-24: 6rem;    /* 96px */
  
  /* Áé∞‰ª£ÂåñÂúÜËßíÁ≥ªÁªü */
  --radius-xs: 0.125rem;  /* 2px */
  --radius-sm: 0.375rem;  /* 6px */
  --radius-md: 0.5rem;    /* 8px */
  --radius-lg: 0.75rem;   /* 12px */
  --radius-xl: 1rem;      /* 16px */
  --radius-2xl: 1.5rem;   /* 24px */
  --radius-full: 9999px;
  
  /* Â≠ó‰ΩìÁ≥ªÁªü - ‰ΩøÁî®Á≥ªÁªüÂ≠ó‰ΩìÊ†à */
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --font-family-mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, monospace;
  
  /* Â≠ó‰ΩìÂ§ßÂ∞è - Â¢ûÂº∫ÂèØËØªÊÄß */
  --text-xs: 0.75rem;    /* 12px */
  --text-sm: 0.875rem;   /* 14px */
  --text-base: 1rem;     /* 16px */
  --text-lg: 1.125rem;   /* 18px */
  --text-xl: 1.25rem;    /* 20px */
  --text-2xl: 1.5rem;    /* 24px */
  --text-3xl: 1.875rem;  /* 30px */
  --text-4xl: 2.25rem;   /* 36px */
  
  /* Â≠ó‰ΩìÂ§ßÂ∞èÂà´Âêç */
  --font-size-xs: var(--text-xs);
  --font-size-sm: var(--text-sm);
  --font-size-base: var(--text-base);
  --font-size-lg: var(--text-lg);
  --font-size-xl: var(--text-xl);
  --font-size-2xl: var(--text-2xl);
  --font-size-3xl: var(--text-3xl);
  --font-size-4xl: var(--text-4xl);
  
  /* Â≠óÈáç */
  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  
  /* Ë°åÈ´ò */
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
  
  /* ‰ºòÂåñÁöÑËøáÊ∏°Âä®Áîª */
  --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Z-indexÂ±ÇÁ∫ßÁÆ°ÁêÜ */
  --z-dropdown: 1000;
  --z-sticky: 1020;
  --z-fixed: 1030;
  --z-modal: 1050;
  --z-toast: 1060;
  
  /* Â∏ÉÂ±ÄÊñ≠ÁÇπ */
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;
  --breakpoint-2xl: 1536px;
}

/* ÊöóËâ≤‰∏ªÈ¢ò */
:global(:root.dark) {
  --text-primary: var(--color-gray-100);
  --text-secondary: var(--color-gray-300);
  --text-muted: var(--color-gray-400);
  --text-disabled: var(--color-gray-600);
  
  --bg-primary: var(--color-gray-900);
  --bg-secondary: var(--color-gray-800);
  --bg-elevated: var(--color-gray-800);
  --bg-hover: var(--color-gray-700);
  
  --border-color: var(--color-gray-700);
  --border-hover: var(--color-gray-600);
}

/* ===== ÂÖ®Â±ÄÂÆπÂô®Ê†∑Âºè ===== */
.home-container {
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
  background: linear-gradient(135deg, 
    hsl(220, 20%, 97%) 0%, 
    hsl(220, 20%, 95%) 100%);
}

:global(:root.dark) .home-container {
  background: linear-gradient(135deg, 
    hsl(220, 20%, 8%) 0%, 
    hsl(220, 20%, 12%) 100%);
}

/* ===== ËÉåÊôØÂ±ÇÊ†∑Âºè ===== */
.background-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: -10;
  pointer-events: none;
}

.gradient-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    135deg,
    rgba(99, 102, 241, 0.1) 0%,
    rgba(168, 85, 247, 0.05) 25%,
    rgba(236, 72, 153, 0.05) 50%,
    rgba(245, 158, 11, 0.1) 100%
  );
}

.pattern-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.08) 0%, transparent 50%),
    radial-gradient(circle at 60% 40%, rgba(236, 72, 153, 0.06) 0%, transparent 50%);
  animation: patternFloat 20s ease-in-out infinite;
}

@keyframes patternFloat {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  33% { transform: translate(-10px, -10px) rotate(1deg); }
  66% { transform: translate(10px, -5px) rotate(-1deg); }
}

/* ===== È°∂ÈÉ®ÂØºËà™Ê†èÊ†∑Âºè ===== */
.top-header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border-color);
  transition: var(--transition-normal);
}

:global(:root.dark) .top-header {
  background: rgba(17, 24, 39, 0.9);
}

.header-wrapper {
  max-width: 1440px;
  margin: 0 auto;
  padding: var(--space-4) var(--space-6);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-8);
}

.header-left {
  flex-shrink: 0;
}

.brand {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  text-decoration: none;
}

.brand-icon {
  font-size: var(--font-size-2xl);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
}

.brand-text h1 {
  font-size: var(--font-size-xl);
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
  line-height: 1.2;
}

.brand-text span {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  line-height: 1;
}

.header-center {
  flex: 1;
  max-width: 600px;
}

.search-container {
  position: relative;
}

.main-search {
  width: 100%;
}

.main-search :deep(.el-input__wrapper) {
  border-radius: var(--radius-2xl);
  box-shadow: var(--shadow-sm);
  border: 2px solid transparent;
  transition: var(--transition-normal);
}

.main-search :deep(.el-input__wrapper):hover {
  border-color: var(--primary-light);
  box-shadow: var(--shadow-md);
}

.main-search :deep(.el-input__wrapper.is-focus) {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.header-right {
  flex-shrink: 0;
}

.header-actions {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.user-menu {
  position: relative;
}

.user-trigger {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: var(--transition-fast);
}

.user-trigger:hover {
  background: var(--bg-hover);
}

.user-name {
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--text-primary);
}

.dropdown-arrow {
  color: var(--text-muted);
  transition: var(--transition-fast);
}

/* ===== ‰∏ªÂÜÖÂÆπÂå∫ÂüüÊ†∑Âºè ===== */
.main-content {
  position: relative;
  z-index: 1;
  padding-top: var(--space-6);
}

.content-container {
  max-width: 1440px;
  margin: 0 auto;
  padding: 0 var(--space-6);
}

/* ===== ÁÑ¶ÁÇπËΩÆÊí≠Âå∫ÂüüÊ†∑Âºè ===== */
.hero-section {
  margin-bottom: var(--space-12);
}

.hero-wrapper {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.8), 
    rgba(249, 250, 251, 0.9));
  backdrop-filter: blur(20px);
  border-radius: var(--radius-2xl);
  border: 1px solid var(--border-color);
  box-shadow: var(--shadow-xl);
  overflow: hidden;
}

:global(:root.dark) .hero-wrapper {
  background: linear-gradient(135deg, 
    rgba(31, 41, 55, 0.8), 
    rgba(17, 24, 39, 0.9));
}

.hero-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-12);
  padding: var(--space-12);
  align-items: center;
}

.hero-text h2 {
  font-size: var(--font-size-4xl);
  font-weight: 800;
  color: var(--text-primary);
  margin: 0 0 var(--space-4) 0;
  line-height: 1.2;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero-text p {
  font-size: var(--font-size-lg);
  color: var(--text-secondary);
  margin: 0 0 var(--space-8) 0;
  line-height: 1.6;
}

.hero-stats {
  display: flex;
  gap: var(--space-8);
}

.stat-item {
  text-align: center;
}

.stat-number {
  display: block;
  font-size: var(--font-size-2xl);
  font-weight: 700;
  color: var(--primary-color);
  line-height: 1;
}

.stat-label {
  display: block;
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  margin-top: var(--space-1);
}

.hero-carousel {
  position: relative;
}

.featured-carousel :deep(.el-carousel__container) {
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-lg);
}

.carousel-item {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-6);
}

.featured-card {
  width: 100%;
  height: 280px;
  border-radius: var(--radius-xl);
  overflow: hidden;
  cursor: pointer;
  transition: var(--transition-normal);
  position: relative;
}

.featured-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-xl);
}

.card-cover {
  position: relative;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  display: flex;
  align-items: center;
  justify-content: center;
}

.cover-gradient {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, 
    rgba(0, 0, 0, 0.3) 0%, 
    rgba(0, 0, 0, 0.1) 100%);
}

.cover-content {
  position: relative;
  z-index: 2;
  text-align: center;
  color: white;
  padding: var(--space-6);
}

.cover-content h3 {
  font-size: var(--font-size-xl);
  font-weight: 600;
  margin: 0 0 var(--space-3) 0;
}

.cover-content p {
  font-size: var(--font-size-sm);
  opacity: 0.9;
  margin: 0 0 var(--space-4) 0;
  line-height: 1.5;
}

.card-meta {
  display: flex;
  justify-content: space-between;
  font-size: var(--font-size-xs);
  opacity: 0.8;
}

/* ===== ‰∏âÊ†èÂ∏ÉÂ±ÄÊ†∑Âºè ===== */
.three-column-section {
  margin-bottom: var(--space-16);
}

.column-wrapper {
  display: grid;
  grid-template-columns: 280px 1fr 280px;
  gap: var(--space-8);
  align-items: start;
}

/* Â∑¶‰æßÊ†èÊ†∑Âºè */
.left-column {
  display: flex;
  flex-direction: column;
  gap: var(--space-6);
  position: sticky;
  top: 120px;
}

/* ‰∏≠Èó¥‰∏ªÂÜÖÂÆπÊ†∑Âºè */
.center-column {
  min-height: 600px;
}

/* Âè≥‰æßÊ†èÊ†∑Âºè */
.right-column {
  display: flex;
  flex-direction: column;
  gap: var(--space-6);
  position: sticky;
  top: 120px;
}

/* ===== Èù¢ÊùøÈÄöÁî®Ê†∑Âºè ===== */
.nav-panel,
.announcement-panel,
.stats-panel,
.activity-panel,
.tags-panel,
.content-panel {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(20px);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  transition: var(--transition-normal);
}

:global(:root.dark) .nav-panel,
:global(:root.dark) .announcement-panel,
:global(:root.dark) .stats-panel,
:global(:root.dark) .activity-panel,
:global(:root.dark) .tags-panel,
:global(:root.dark) .content-panel {
  background: rgba(31, 41, 55, 0.7);
}

.panel-header {
  padding: var(--space-5) var(--space-6);
  border-bottom: 1px solid var(--border-color);
  background: rgba(255, 255, 255, 0.5);
  display: flex;
  align-items: center;
  justify-content: space-between;
  cursor: pointer;
  transition: var(--transition-fast);
}

.panel-header:hover {
  background: rgba(255, 255, 255, 0.7);
}

:global(:root.dark) .panel-header {
  background: rgba(31, 41, 55, 0.5);
}

:global(:root.dark) .panel-header:hover {
  background: rgba(31, 41, 55, 0.7);
}

.panel-actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

/* ÊäòÂè†ÂõæÊ†áÊ†∑Âºè */
.collapse-icon {
  transition: transform var(--transition-fast);
  color: var(--text-muted);
}

.collapse-icon.collapsed {
  transform: rotate(-90deg);
}

.panel-header h3 {
  font-size: var(--font-size-base);
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.panel-content {
  padding: var(--space-6);
}

/* ===== Âø´ÈÄüÂØºËà™Ê†∑Âºè ===== */
.quick-nav {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: var(--transition-fast);
  border: 2px solid transparent;
}

.nav-item:hover {
  background: var(--bg-hover);
  border-color: var(--primary-light);
}

.nav-item.active {
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color: white;
  box-shadow: var(--shadow-md);
}

.nav-item span {
  flex: 1;
  font-size: var(--font-size-sm);
  font-weight: 500;
}

.nav-count {
  background: rgba(255, 255, 255, 0.2);
  color: currentColor;
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: 600;
  min-width: 24px;
  text-align: center;
}

.nav-item:not(.active) .nav-count {
  background: var(--gray-100);
  color: var(--text-muted);
}

/* ===== ÂÖ¨ÂëäÂàóË°®Ê†∑Âºè ===== */
.announcement-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.announcement-item {
  display: flex;
  gap: var(--space-3);
  padding: var(--space-4);
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  border-left: 4px solid var(--primary-color);
  transition: var(--transition-fast);
}

.announcement-item:hover {
  background: var(--bg-hover);
  transform: translateX(2px);
}

.announcement-dot {
  width: 8px;
  height: 8px;
  background: var(--primary-color);
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 6px;
}

.announcement-content {
  flex: 1;
}

.announcement-text {
  font-size: var(--font-size-sm);
  color: var(--text-primary);
  line-height: 1.4;
  margin-bottom: var(--space-1);
}

.announcement-time {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* ===== ÂÜÖÂÆπÈù¢ÊùøÊ†∑Âºè ===== */
.content-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-6) var(--space-6) var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--border-color);
  background: rgba(255, 255, 255, 0.5);
}

:global(:root.dark) .content-header {
  background: rgba(31, 41, 55, 0.5);
}

.header-left h2 {
  font-size: var(--font-size-2xl);
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 var(--space-1) 0;
}

.resource-count {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
}

.content-controls {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.view-toggle :deep(.el-button-group) {
  border-radius: var(--radius-lg);
  overflow: hidden;
}

/* ===== ËµÑÊ∫êÁΩëÊ†ºÊ†∑Âºè ===== */
.resource-content {
  padding: var(--space-6);
}

.resource-grid {
  display: grid;
  gap: var(--space-8);
  padding: var(--space-4);
}

.resource-grid.grid {
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: var(--space-6);
}

.resource-grid.list {
  grid-template-columns: 1fr;
  gap: var(--space-5);
}

.resource-card {
  background: var(--bg-elevated);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  overflow: hidden;
  transition: var(--transition-normal);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  height: fit-content;
  margin-bottom: var(--space-2);
}

.resource-card:hover {
  border-color: var(--primary-light);
  box-shadow: var(--shadow-lg);
  transform: translateY(-4px);
  scale: 1.02;
}

.card-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
  padding: var(--space-5) var(--space-6);
  border-bottom: 1px solid var(--border-color);
  background: rgba(255, 255, 255, 0.02);
}

.card-icon {
  flex-shrink: 0;
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.card-title {
  flex: 1;
}

.title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-1);
}

.status-badges {
  display: flex;
  gap: var(--space-2);
  flex-shrink: 0;
}

.status-badges .el-tag {
  font-size: var(--font-size-xs);
  padding: 2px 6px;
  border-radius: var(--radius-sm);
}

.status-badges .el-icon {
  font-size: 12px;
  margin-right: 2px;
}

.card-title h4 {
  font-size: var(--font-size-base);
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
  line-height: 1.3;
}

.card-category {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  background: var(--bg-secondary);
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-sm);
}

.card-actions {
  flex-shrink: 0;
}

.card-body {
  padding: var(--space-6);
  min-height: 100px;
}

.card-description {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  line-height: 1.5;
  margin: 0 0 var(--space-4) 0;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.card-tags {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
}

.card-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-6);
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  margin-top: auto;
}

.footer-meta {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

.footer-meta span {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* ÂìçÂ∫îÂºè‰ºòÂåñ */
@media (max-width: 768px) {
  .resource-grid {
    padding: var(--space-2);
    gap: var(--space-4);
  }
  
  .resource-grid.grid {
    grid-template-columns: 1fr;
    gap: var(--space-4);
  }
  
  .resource-card {
    margin-bottom: var(--space-1);
  }
  
  .card-header {
    padding: var(--space-4);
  }
  
  .card-body {
    padding: var(--space-4);
    min-height: 80px;
  }
  
  .card-footer {
    padding: var(--space-3) var(--space-4);
  }
}

@media (min-width: 1200px) {
  .resource-grid.grid {
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }
}

/* ===== ÁªüËÆ°Èù¢ÊùøÊ†∑Âºè ===== */
.stats-container {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.stat-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4);
  background: linear-gradient(135deg, var(--bg-elevated) 0%, var(--bg-secondary) 100%);
  border-radius: var(--radius-xl);
  border: 1px solid var(--border-color);
  transition: var(--transition-normal);
  position: relative;
  overflow: hidden;
  animation: slideInUp 0.6s ease-out;
  animation-fill-mode: both;
}

.stat-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.1) 0%, 
    rgba(255, 255, 255, 0.05) 100%);
  opacity: 0;
  transition: var(--transition-normal);
  pointer-events: none;
}

:global(:root.dark) .stat-item::before {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.05) 0%, 
    rgba(255, 255, 255, 0.02) 100%);
}

.stat-item:nth-child(1) { animation-delay: 0.1s; }
.stat-item:nth-child(2) { animation-delay: 0.2s; }
.stat-item:nth-child(3) { animation-delay: 0.3s; }
.stat-item:nth-child(4) { animation-delay: 0.4s; }

@keyframes slideInUp {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}



.stat-item:hover {
  border-color: var(--primary-light);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.stat-item:hover::before {
  opacity: 1;
}

.stat-header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.stat-icon-wrapper {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border: 2px solid transparent;
  transition: var(--transition-normal);
  position: relative;
}

.stat-trend {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-2);
  background: rgba(103, 194, 58, 0.1);
  border-radius: var(--radius-md);
  font-size: var(--font-size-xs);
  color: #67c23a;
  font-weight: 500;
}

/* ÂÖ∑‰ΩìÂõæÊ†áÊ†∑Âºè - Ê†πÊçÆÁªüËÆ°Á±ªÂûãËÆæÁΩÆ‰∏çÂêåÈ¢úËâ≤ */
.stat-item:nth-child(1) .stat-icon-wrapper {
  background: rgba(64, 158, 255, 0.1);
  border-color: rgba(64, 158, 255, 0.2);
}

.stat-item:nth-child(1) .stat-icon-wrapper .el-icon {
  color: #409eff;
}

.stat-item:nth-child(2) .stat-icon-wrapper {
  background: rgba(103, 194, 58, 0.1);
  border-color: rgba(103, 194, 58, 0.2);
}

.stat-item:nth-child(2) .stat-icon-wrapper .el-icon {
  color: #67c23a;
}

.stat-item:nth-child(3) .stat-icon-wrapper {
  background: rgba(230, 162, 60, 0.1);
  border-color: rgba(230, 162, 60, 0.2);
}

.stat-item:nth-child(3) .stat-icon-wrapper .el-icon {
  color: #e6a23c;
}

.stat-item:nth-child(4) .stat-icon-wrapper {
  background: rgba(245, 108, 108, 0.1);
  border-color: rgba(245, 108, 108, 0.2);
}

.stat-item:nth-child(4) .stat-icon-wrapper .el-icon {
  color: #f56c6c;
}

/* ÊöóËâ≤‰∏ªÈ¢òÈÄÇÈÖç */
:global(:root.dark) .stat-item {
  background: linear-gradient(135deg, rgba(31, 41, 55, 0.8) 0%, rgba(17, 24, 39, 0.8) 100%);
  border-color: var(--color-gray-700);
}

:global(:root.dark) .stat-item:hover {
  border-color: var(--primary-light);
  background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.9) 100%);
}

:global(:root.dark) .stat-number {
  color: var(--color-gray-100);
}

:global(:root.dark) .stat-title {
  color: var(--color-gray-400);
}

:global(:root.dark) .stat-trend {
  background: rgba(103, 194, 58, 0.2);
  color: #67c23a;
}



.stat-item:hover .stat-icon-wrapper {
  transform: scale(1.05);
  box-shadow: var(--shadow-md);
}

.stat-main {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  text-align: right;
  min-width: 0;
}

.stat-number {
  font-size: var(--font-size-2xl);
  font-weight: 800;
  color: var(--text-primary);
  line-height: 1;
  margin-bottom: var(--space-1);
  display: block;
  font-variant-numeric: tabular-nums;
  animation: fadeInScale 0.6s ease-out;
}

@keyframes fadeInScale {
  0% {
    opacity: 0;
    transform: scale(0.8);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

.stat-title {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  font-weight: 500;
  line-height: 1.2;
  white-space: nowrap;
}

/* ÂìçÂ∫îÂºèËÆæËÆ° - ÁªüËÆ°Èù¢Êùø */
@media (max-width: 1280px) {
  .stats-container {
    gap: var(--space-3);
  }
  
  .stat-item {
    padding: var(--space-3);
  }
  
  .stat-icon-wrapper {
    width: 40px;
    height: 40px;
  }
  
  .stat-number {
    font-size: var(--font-size-xl);
  }
  
  .stat-title {
    font-size: var(--font-size-xs);
  }
  
  .stat-trend {
    font-size: var(--font-size-xs);
    padding: var(--space-1);
  }
}

@media (max-width: 1024px) {
  .stats-container {
    gap: var(--space-3);
  }
  
  .stat-item {
    padding: var(--space-3);
  }
  
  .stat-icon-wrapper {
    width: 36px;
    height: 36px;
  }
  
  .stat-number {
    font-size: var(--font-size-lg);
  }
  
  .stat-title {
    font-size: var(--font-size-xs);
  }
  
  .stat-trend {
    font-size: var(--font-size-xs);
    padding: var(--space-1);
  }
}

@media (max-width: 768px) {
  .stats-container {
    gap: var(--space-2);
  }
  
  .stat-item {
    padding: var(--space-3);
  }
  
  .stat-icon-wrapper {
    width: 32px;
    height: 32px;
  }
  
  .stat-number {
    font-size: var(--font-size-base);
  }
  
  .stat-title {
    font-size: var(--font-size-xs);
  }
  
  .stat-trend {
    font-size: var(--font-size-xs);
    padding: var(--space-1);
  }
}

/* ===== Ê¥ªÂä®ÂàóË°®Ê†∑Âºè ===== */
.activity-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.activity-item {
  display: flex;
  gap: var(--space-3);
  padding: var(--space-3);
  border-radius: var(--radius-lg);
  transition: var(--transition-fast);
  cursor: pointer;
}

.activity-item:hover {
  background: var(--primary-light);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.activity-avatar {
  flex-shrink: 0;
}

.activity-content {
  flex: 1;
  min-width: 0;
}

.activity-content.no-avatar {
  margin-left: 0;
}

.activity-text {
  font-size: var(--font-size-sm);
  color: var(--text-primary);
  line-height: 1.4;
  margin-bottom: var(--space-1);
}

.activity-target {
  color: var(--primary-color);
  font-weight: 500;
}

.activity-time {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* ===== ÁÉ≠Èó®Ê†áÁ≠æÊ†∑Âºè ===== */
.hot-tags {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
}

.tag-item {
  cursor: pointer;
  transition: var(--transition-fast);
}

.tag-item:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.tag-count {
  margin-left: var(--space-1);
  opacity: 0.7;
}

.loading-state {
  padding: var(--space-4);
}

.empty-state {
  text-align: center;
  padding: var(--space-6);
  color: var(--text-secondary);
  font-size: var(--font-size-sm);
}

.refresh-btn {
  padding: var(--space-1) var(--space-2);
  opacity: 0.7;
  transition: var(--transition-fast);
}

.refresh-btn:hover {
  opacity: 1;
  color: var(--primary-color);
}

/* ===== ÁÉ≠Èó®ÂÜÖÂÆπÊ†∑Âºè ===== */
.popular-content-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.popular-item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-3);
  border-radius: var(--radius-lg);
  background: var(--bg-elevated);
  border: 1px solid var(--border-color);
  cursor: pointer;
  transition: var(--transition-fast);
}

.popular-item:hover {
  background: var(--primary-light);
  border-color: var(--primary-color);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.item-rank {
  flex-shrink: 0;
}

.rank-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: var(--font-size-sm);
  font-weight: 600;
  color: white;
}

.rank-first {
  background: linear-gradient(135deg, #FFD700, #FFA500);
}

.rank-second {
  background: linear-gradient(135deg, #C0C0C0, #A0A0A0);
}

.rank-third {
  background: linear-gradient(135deg, #CD7F32, #B8860B);
}

.rank-normal {
  background: var(--color-gray-400);
}

.item-content {
  flex: 1;
  min-width: 0;
}

.item-header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-1);
}

.type-icon {
  font-size: var(--font-size-sm);
}

.type-icon.resource {
  color: var(--color-primary);
}

.type-icon.post {
  color: var(--color-success);
}

.item-type {
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  font-weight: 500;
}

.item-title {
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: var(--space-2);
  line-height: 1.4;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.item-stats {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  background: none;
  border: none;
  box-shadow: none;
  padding: 0;
}

.item-stats .stat-item {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--font-size-xs);
  color: var(--text-secondary);
  background: none;
  border: none;
  box-shadow: none;
  padding: 0;
}

.item-stats .el-icon {
  font-size: 12px;
}

/* ÊöóËâ≤‰∏ªÈ¢òÈÄÇÈÖç */
:global(:root.dark) .popular-item {
  background: rgba(31, 41, 55, 0.8);
  border-color: rgba(75, 85, 99, 0.3);
}

:global(:root.dark) .popular-item:hover {
  background: rgba(59, 130, 246, 0.1);
  border-color: var(--primary-color);
}

/* ===== Á§æÂå∫Â∏ñÂ≠êÂå∫ÂüüÊ†∑Âºè ===== */
.posts-section {
  margin-bottom: var(--space-16);
}

.section-header {
  text-align: center;
  margin-bottom: var(--space-12);
  padding: var(--space-12) var(--space-6);
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.8), 
    rgba(249, 250, 251, 0.9));
  backdrop-filter: blur(20px);
  border-radius: var(--radius-2xl);
  border: 1px solid var(--border-color);
  box-shadow: var(--shadow-lg);
}

:global(:root.dark) .section-header {
  background: linear-gradient(135deg, 
    rgba(31, 41, 55, 0.8), 
    rgba(17, 24, 39, 0.9));
}

.section-header h2 {
  font-size: var(--font-size-3xl);
  font-weight: 800;
  color: var(--text-primary);
  margin: 0 0 var(--space-4) 0;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.section-header p {
  font-size: var(--font-size-lg);
  color: var(--text-secondary);
  margin: 0 0 var(--space-8) 0;
}

.posts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: var(--space-6);
  margin-bottom: var(--space-12);
}

.post-card {
  background: var(--bg-elevated);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  overflow: hidden;
  transition: var(--transition-normal);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
}

.post-card:hover {
  border-color: var(--primary-light);
  box-shadow: var(--shadow-lg);
  transform: translateY(-2px);
}

.post-header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-5);
  border-bottom: 1px solid var(--border-color);
}

.post-avatar {
  flex-shrink: 0;
}

.post-author {
  flex: 1;
}

.author-name {
  font-size: var(--font-size-sm);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-1);
}

.post-time {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

.post-category {
  flex-shrink: 0;
}

.post-content {
  padding: var(--space-5);
}

.post-title {
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 var(--space-3) 0;
  line-height: 1.4;
}

.post-excerpt {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  line-height: 1.5;
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.post-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-5);
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
}

.post-meta {
  display: flex;
  gap: var(--space-4);
  flex-wrap: wrap;
}

.post-meta .meta-item {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  color: var(--el-text-color-secondary);
  font-size: var(--font-size-xs);
}

.post-meta .meta-item .el-icon {
  font-size: var(--font-size-base);
}

.post-date {
  color: var(--el-text-color-secondary);
  font-size: var(--font-size-xs);
}

.empty-posts {
  margin-top: var(--space-16);
  text-align: center;
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 768px) {
  .posts-section {
    padding: var(--space-16);
  }
  
  .posts-container {
    padding: 0 var(--space-8);
  }
  
  .posts-grid {
    grid-template-columns: 1fr;
    gap: var(--space-8);
  }
  
  .post-card {
    padding: var(--space-8);
  }
  
  .post-header {
    flex-direction: column;
    gap: var(--space-4);
  }
  
  .post-status {
    margin-left: 0;
  }
  
  .post-footer {
    flex-direction: column;
    align-items: flex-start;
  }
}

/* ===== ‰∏âÊ†èÂ∏ÉÂ±ÄÊ†∏ÂøÉÊ†∑Âºè ===== */
.three-column-layout {
  display: grid;
  grid-template-columns: 280px 1fr 280px;
  grid-template-rows: 1fr;
  gap: var(--space-16);
  width: 100%;
  min-height: 600px;
  animation: fadeInUp 0.8s ease-out;
}

/* Â∑¶‰æßÊ†èÔºöÂÖ¨ÂëäÂå∫Âüü + Á§æÂå∫ÂÜÖÂÆπÂàÜÁ±ªÊ†è */
.left-sidebar {
  grid-column: 1;
  grid-row: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
  animation: slideInLeft 0.8s ease-out;
}

/* ‰∏≠Èó¥‰∏ªÂÜÖÂÆπÂå∫ÂüüÔºöÁ§æÂå∫ËΩÆÊí≠ÂõæÂå∫ + ÂÜÖÂÆπÂ±ïÁ§∫Âå∫Âüü */
.main-content-area {
  grid-column: 2;
  grid-row: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
  animation: fadeInUp 0.8s ease-out 0.2s both;
}

/* Âè≥‰æßÊ†èÔºöÁ§æÂå∫ÈÄöÁü• */
.right-sidebar {
  grid-column: 3;
  grid-row: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-12);
  animation: slideInRight 0.8s ease-out 0.4s both;
}

/* ‰∏âÊ†èÂ∏ÉÂ±ÄÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 1200px) {
  .three-column-layout {
    grid-template-columns: 260px 1fr 260px;
    gap: var(--space-12);
  }
}

@media (max-width: 1024px) {
  .three-column-layout {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    gap: var(--space-12);
  }
  
  .left-sidebar {
    grid-column: 1;
    grid-row: 1;
  }
  
  .main-content-area {
    grid-column: 1;
    grid-row: 2;
  }
  
  .right-sidebar {
    grid-column: 1;
    grid-row: 3;
  }
}

@media (max-width: 768px) {
  .three-column-layout {
    gap: var(--space-12);
  }
  
  .left-sidebar,
  .main-content-area,
  .right-sidebar {
    gap: var(--space-12);
  }
}

/* ÂÖ¨ÂëäÂå∫Âüü */
.announcement-section {
  flex: 1;
  min-width: 0;
  min-height: 200px;
  position: relative;
}

/* Á§æÂå∫ÂÜÖÂÆπÂàÜÁ±ªÊ†è */
.category-section {
  flex: 1;
  min-width: 0;
  min-height: 200px;
  position: relative;
}

/* Á§æÂå∫ËΩÆÊí≠ÂõæÂå∫ */
.carousel-section {
  flex: 1;
  min-width: 0;
  min-height: 300px;
  position: relative;
}

/* ÂÜÖÂÆπÂõæÊ†á + ÂÜÖÂÆπÂç°ÁâáÂå∫Âüü */
.content-display-section {
  flex: 1;
  min-width: 0;
  min-height: 500px;
  position: relative;
}

/* Á≠õÈÄâÂå∫Âüü */
.filter-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-16) 0;
  gap: var(--space-8);
}

/* Á≠õÈÄâÂå∫ÂüüÂ∑¶‰æß */
.filter-left {
  flex: 1;
}

/* Á≠õÈÄâÂå∫ÂüüÂè≥‰æß */
.filter-right {
  display: flex;
  gap: var(--space-8);
  align-items: center;
}

/* Á≠õÈÄâÂå∫ÂüüÂ∑¶‰æßËæìÂÖ•Ê°Ü */
.filter-search {
  flex: 1;
}

/* Á≠õÈÄâÂå∫ÂüüÂè≥‰æßÈÄâÊã©Ê°Ü */
.filter-select {
  width: 140px;
}

/* Á≠õÈÄâÂå∫ÂüüÊåâÈíÆ */
.filter-actions {
  display: flex;
  gap: var(--space-8);
}

/* È´òÁ∫ßÁ≠õÈÄâÈù¢Êùø */
.advanced-filters {
  margin-bottom: var(--space-16);
}

/* ËΩÆÊí≠‰∏∫Á©∫Êó∂ÁöÑÁä∂ÊÄÅ */
.carousel-empty {
  text-align: center;
  padding: var(--space-12) var(--space-6);
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  margin-top: var(--space-16);
}

.carousel-empty .empty-icon {
  font-size: 48px;
  margin-bottom: var(--space-8);
}

.carousel-empty h4 {
  margin: 0 0 var(--space-4) 0;
  font-size: var(--font-size-xl);
  color: var(--text-primary);
}

.carousel-empty p {
  margin: 0 0 var(--space-8) 0;
  color: var(--text-secondary);
}

/* ÂÜÖÂÆπÂç°Áâá */
.section-card {
  background: rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(20px);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  padding: var(--space-16);
  box-shadow: var(--shadow-lg);
  transform: translateZ(0);
}

.section-card:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: var(--shadow-xl);
  border-color: var(--primary-light);
  background: var(--bg-hover);
}

/* ÂÜÖÂÆπÂç°ÁâáÂ§¥ÈÉ® */
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-4) var(--space-6);
  background: rgba(255, 255, 255, 0.5);
  border-bottom: 1px solid var(--border-color);
}

.card-title-area {
  flex: 1;
}

.card-title {
  font-size: var(--font-size-xl);
  font-weight: 600;
  color: var(--text-primary);
}

.card-subtitle {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
}

.card-content {
  padding: var(--space-6);
}

/* ÂÜÖÂÆπÂç°ÁâáÂÜÖÂÆπ */
.card-content .notice-list,
.card-content .category-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.card-content .notice-item,
.card-content .category-item {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-4);
  border-radius: var(--radius-lg);
  font-size: var(--font-size-sm);
  font-weight: 500;
  justify-content: space-between;
  transition: var(--transition-fast);
  cursor: pointer;
}

.card-content .notice-item:hover,
.card-content .category-item:hover {
  background: var(--bg-hover);
  transform: translateX(4px);
}

.card-content .notice-item.active,
.card-content .category-item.active {
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color: white;
  box-shadow: var(--shadow-md);
}

.card-content .notice-item-content,
.card-content .category-item-content {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex: 1;
}

.card-content .notice-item-content .notice-dot,
.card-content .category-item-content .category-icon {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  backdrop-filter: blur(5px);
  border-radius: 50%;
}

.card-content .notice-item-content .notice-text,
.card-content .category-item-content .category-name {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

.card-content .notice-item-content .notice-time,
.card-content .category-item-content .category-count {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  background: rgba(255, 255, 255, 0.1);
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-sm);
  min-width: 24px;
  text-align: center;
}

/* ÈÄöÁü•Âå∫ÂüüÊ†∑Âºè */
.notification-section {
  margin-bottom: var(--space-16);
}

.notification-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.notification-item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
  padding: var(--space-4);
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--radius-lg);
  border-left: 4px solid transparent;
  transition: var(--transition-fast);
}

.notification-item:hover {
  background: var(--bg-hover);
  transform: translateX(4px);
}

.notification-item.system {
  border-left-color: #409eff;
}

.notification-item.community {
  border-left-color: #67c23a;
}

.notification-item.recommendation {
  border-left-color: #e6a23c;
}

.notification-item.interaction {
  border-left-color: #f56c6c;
}

.notification-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.notification-item.system .notification-icon {
  background: rgba(64, 158, 255, 0.2);
  color: #409eff;
}

.notification-item.community .notification-icon {
  background: rgba(103, 194, 58, 0.2);
  color: #67c23a;
}

.notification-item.recommendation .notification-icon {
  background: rgba(230, 162, 60, 0.2);
  color: #e6a23c;
}

.notification-item.interaction .notification-icon {
  background: rgba(245, 108, 108, 0.2);
  color: #f56c6c;
}

.notification-content {
  flex: 1;
}

.notification-title {
  margin: 0 0 var(--space-2) 0;
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
}

.notification-text {
  margin: 0 0 var(--space-4) 0;
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  line-height: 1.4;
}

.notification-time {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* Âø´ÈÄüÁªüËÆ°Ê†∑Âºè */
.quick-stats {
  margin-top: var(--space-16);
  padding-top: var(--space-12);
  border-top: 1px solid var(--border-color);
}

.stats-title {
  margin: 0 0 var(--space-8) 0;
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-8);
}

.stat-item {
  text-align: center;
  padding: var(--space-4);
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--radius-sm);
  transition: var(--transition-fast);
}

.stat-item:hover {
  background: var(--bg-hover);
  transform: translateY(-2px);
}

.stat-number {
  display: block;
  font-size: var(--font-size-lg);
  font-weight: 700;
  color: var(--brand-color);
  margin-bottom: var(--space-2);
}

.stat-label {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* ÊµÖËâ≤‰∏ªÈ¢ò‰∏ãÁöÑÂç°ÁâáÊ†∑Âºè */
:global(:root:not(.dark)) .section-card {
  background: rgba(248, 250, 252, 0.5) !important;
  backdrop-filter: blur(20px) !important;
  border: 1px solid rgba(148, 163, 184, 0.2) !important;
  box-shadow: 0 8px 32px rgba(71, 85, 105, 0.08) !important;
}

:global(:root:not(.dark)) .section-card:hover {
  box-shadow: 0 16px 48px rgba(71, 85, 105, 0.12) !important;
  border-color: rgba(148, 163, 184, 0.3) !important;
  background: rgba(248, 250, 252, 0.7) !important;
}

/* ÂÜÖÂÆπÂ§¥ÈÉ®Ê†∑Âºè */
.content-header-left {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.content-icon {
  width: 40px;
  height: 40px;
  border-radius: var(--radius-sm);
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.content-header-right {
  display: flex;
  align-items: center;
  gap: var(--space-8);
}

.view-switcher {
  display: flex;
  gap: var(--space-4);
}

/* ËµÑÊ∫êÂç°ÁâáÊñ∞Ê†∑Âºè */
.resource-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-8);
}

.resource-body {
  margin-bottom: var(--space-8);
}

.resource-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: var(--space-4);
  border-top: 1px solid var(--border-color);
}

.resource-date {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

/* ËΩÆÊí≠Ê†∑Âºè‰ºòÂåñ */
.community-carousel {
  border-radius: var(--radius-xl);
  overflow: hidden;
}

.carousel-slide {
  padding: var(--space-12);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Âä®ÁîªÂÖ≥ÈîÆÂ∏ß */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.three-column-section {
  animation: fadeInUp 0.8s ease-out;
}

.left-column {
  animation: slideInLeft 0.8s ease-out 0.1s both;
}

.center-column {
  animation: fadeInUp 0.8s ease-out 0.2s both;
}

.right-column {
  animation: slideInRight 0.8s ease-out 0.3s both;
}

.hero-section {
  animation: fadeInUp 0.8s ease-out;
}

.posts-section {
  animation: fadeInUp 0.8s ease-out 0.4s both;
}

/* ===== Element Plus ÁªÑ‰ª∂ÂÆöÂà∂ ===== */
:deep(.el-button) {
  border-radius: var(--radius-lg);
  font-weight: 500;
  transition: var(--transition-fast);
}

:deep(.el-button--primary) {
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border: none;
  box-shadow: var(--shadow-sm);
}

:deep(.el-button--primary:hover) {
  background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
  box-shadow: var(--shadow-md);
  transform: translateY(-1px);
}

:deep(.el-tag) {
  border-radius: var(--radius-sm);
  border: none;
  font-weight: 500;
}

:deep(.el-empty) {
  padding: var(--space-12) var(--space-6);
}

:deep(.el-skeleton__item) {
  border-radius: var(--radius-lg);
}

:deep(.el-carousel__indicator) {
  border-radius: var(--radius-sm);
}

:deep(.el-carousel__indicator.is-active) {
  background-color: var(--primary-color);
}

:deep(.el-dropdown-menu) {
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-color);
  box-shadow: var(--shadow-xl);
}

:deep(.el-dropdown-menu__item) {
  padding: var(--space-3) var(--space-4);
  font-size: var(--font-size-sm);
}

/* ===== ÂàÜÈ°µÊ†∑Âºè‰ºòÂåñ ===== */
.pagination-wrapper {
  display: flex;
  justify-content: center;
  padding: var(--space-4) var(--space-2);
  margin-top: var(--space-4);
}

:deep(.el-pagination) {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-wrap: wrap;
  justify-content: center;
}

:deep(.el-pagination .btn-next),
:deep(.el-pagination .btn-prev) {
  border-radius: var(--radius-lg);
  border: none;
  background: transparent;
  min-height: 36px;
  min-width: 36px;
  transition: var(--transition-fast);
}

:deep(.el-pagination .btn-next:hover),
:deep(.el-pagination .btn-prev:hover) {
  background: var(--primary-light);
  color: var(--primary-color);
}

:deep(.el-pagination .el-pager li) {
  border-radius: var(--radius-lg);
  border: none;
  background: transparent;
  min-height: 36px;
  min-width: 36px;
  margin: 0 var(--space-1);
  transition: var(--transition-fast);
  font-weight: 500;
}

:deep(.el-pagination .el-pager li:hover) {
  background: var(--primary-light);
  color: var(--primary-color);
}

:deep(.el-pagination .el-pager li.is-active) {
  background: var(--primary-color);
  color: white;
  font-weight: 600;
}

:deep(.el-pagination .el-pagination__total) {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  font-weight: 500;
  margin-right: var(--space-4);
}

:deep(.el-pagination .el-pagination__sizes) {
  margin-right: var(--space-4);
}

:deep(.el-pagination .el-pagination__sizes .el-select) {
  border-radius: var(--radius-lg);
}

:deep(.el-pagination .el-pagination__jump) {
  margin-left: var(--space-4);
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

:deep(.el-pagination .el-pagination__jump .el-input) {
  border-radius: var(--radius-lg);
  width: 60px;
}

/* ÊöóËâ≤‰∏ªÈ¢ò‰∏ãÁöÑÂàÜÈ°µÊ†∑Âºè */
:global(:root.dark) .pagination-wrapper {
  background: rgba(31, 41, 55, 0.7);
  border-color: rgba(75, 85, 99, 0.3);
}

:global(:root.dark) :deep(.el-pagination .btn-next),
:global(:root.dark) :deep(.el-pagination .btn-prev),
:global(:root.dark) :deep(.el-pagination .el-pager li) {
  background: rgba(31, 41, 55, 0.8);
  border-color: rgba(75, 85, 99, 0.3);
  color: var(--text-primary);
}

/* ===== ÂæÆË∞ÉÂíå‰ºòÂåñ ===== */
.resource-card.list {
  display: flex;
  align-items: center;
  padding: var(--space-4);
}

.resource-card.list .card-header {
  border-bottom: none;
  padding: 0;
  margin-right: var(--space-4);
}

.resource-card.list .card-body {
  flex: 1;
  padding: 0;
  margin-right: var(--space-4);
}

.resource-card.list .card-footer {
  border-top: none;
  background: transparent;
  padding: 0;
  flex-shrink: 0;
}

/* Âä†ËΩΩÁä∂ÊÄÅ‰ºòÂåñ */
.loading-state :deep(.el-skeleton__item) {
  background: linear-gradient(90deg, var(--gray-200) 25%, var(--gray-100) 50%, var(--gray-200) 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

:global(:root.dark) .loading-state :deep(.el-skeleton__item) {
  background: linear-gradient(90deg, var(--gray-700) 25%, var(--gray-600) 50%, var(--gray-700) 75%);
  background-size: 200% 100%;
}

/* ===== È°µËÑöÊ†∑Âºè ===== */
.site-footer {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.9) 0%, 
    rgba(248, 250, 252, 0.95) 100%);
  backdrop-filter: blur(20px);
  border-top: 1px solid var(--border-color);
  margin-top: var(--space-24);
  padding: var(--space-20) 0 var(--space-12) 0;
  position: relative;
  overflow: hidden;
}

:global(:root.dark) .site-footer {
  background: linear-gradient(135deg, 
    rgba(17, 24, 39, 0.9) 0%, 
    rgba(31, 41, 55, 0.95) 100%);
}

.site-footer::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.08) 0%, transparent 50%);
  pointer-events: none;
  z-index: -1;
}

.footer-content {
  max-width: 1440px;
  margin: 0 auto;
  padding: 0 var(--space-6);
}

.footer-info {
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: var(--space-16);
  margin-bottom: var(--space-16);
}

.footer-brand {
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
}

.footer-brand .brand-icon {
  font-size: var(--font-size-3xl);
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-lg);
  flex-shrink: 0;
}

.footer-brand h3 {
  font-size: var(--font-size-2xl);
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 var(--space-2) 0;
  line-height: 1.2;
}

.footer-brand p {
  font-size: var(--font-size-base);
  color: var(--text-secondary);
  margin: 0;
  line-height: 1.5;
}

.footer-links {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-12);
}

.link-group h4 {
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 var(--space-6) 0;
  position: relative;
  padding-bottom: var(--space-2);
}

.link-group h4::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 30px;
  height: 2px;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border-radius: var(--radius-sm);
}

.link-group a {
  display: block;
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  text-decoration: none;
  margin-bottom: var(--space-3);
  padding: var(--space-2) 0;
  border-radius: var(--radius-sm);
  transition: var(--transition-fast);
  position: relative;
}

.link-group a:hover {
  color: var(--primary-color);
  padding-left: var(--space-3);
  background: var(--bg-hover);
}

.link-group a:hover::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 2px;
  height: 60%;
  background: var(--primary-color);
  border-radius: var(--radius-sm);
}

.footer-bottom {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-top: var(--space-8);
  border-top: 1px solid var(--border-color);
  flex-wrap: wrap;
  gap: var(--space-4);
}

.footer-bottom p {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  margin: 0;
}

.footer-social {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.footer-social .el-button {
  width: 40px;
  height: 40px;
  border-radius: var(--radius-lg);
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  color: var(--text-secondary);
  transition: var(--transition-fast);
}

.footer-social .el-button:hover {
  background: var(--primary-color);
  border-color: var(--primary-color);
  color: white;
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

/* ÂìçÂ∫îÂºèËÆæËÆ° */
@media (max-width: 1024px) {
  .footer-info {
    grid-template-columns: 1fr;
    gap: var(--space-12);
  }
  
  .footer-links {
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-8);
  }
}

@media (max-width: 768px) {
  .site-footer {
    padding: var(--space-16) 0 var(--space-8) 0;
  }
  
  .footer-links {
    grid-template-columns: 1fr;
    gap: var(--space-6);
  }
  
  .footer-brand {
    flex-direction: column;
    text-align: center;
    gap: var(--space-3);
  }
  
  .footer-bottom {
    flex-direction: column;
    text-align: center;
    gap: var(--space-6);
  }
}

/* Â∏ñÂ≠êÁΩëÊ†ºËßÜÂõæÂÖºÂÆπ */
.posts-grid {
  display: grid;
  gap: var(--space-8);
  padding: var(--space-4);
}

.posts-grid.grid {
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: var(--space-6);
}

.posts-grid.list {
  grid-template-columns: 1fr;
  gap: var(--space-5);
}

.posts-grid .post-card {
  background: var(--bg-elevated);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-xl);
  overflow: hidden;
  transition: var(--transition-normal);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  height: fit-content;
  margin-bottom: var(--space-2);
}

.posts-grid .post-card:hover {
  border-color: var(--primary-light);
  box-shadow: var(--shadow-lg);
  transform: translateY(-4px);
  scale: 1.02;
}

.posts-grid .post-header {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  padding: var(--space-5) var(--space-6);
  border-bottom: 1px solid var(--border-color);
  background: rgba(255, 255, 255, 0.02);
}

.posts-grid .post-content {
  padding: var(--space-6);
  min-height: 120px;
}

.posts-grid .post-title {
  font-size: var(--font-size-lg);
  font-weight: 600;
  color: var(--text-primary);
  margin: 0 0 var(--space-3) 0;
  line-height: 1.4;
}

.posts-grid .post-excerpt {
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  line-height: 1.5;
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.posts-grid .post-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-6);
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  margin-top: auto;
}

.posts-grid .post-stats {
  display: flex;
  gap: var(--space-4);
  font-size: var(--font-size-xs);
  color: var(--text-muted);
}

.posts-grid .post-stats .stat-item {
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* Â∏ñÂ≠êÂå∫ÂüüÂìçÂ∫îÂºè‰ºòÂåñ */
@media (max-width: 768px) {
  .posts-grid {
    padding: var(--space-2);
    gap: var(--space-4);
  }
  
  .posts-grid.grid {
    grid-template-columns: 1fr;
    gap: var(--space-4);
  }
  
  .posts-grid .post-card {
    margin-bottom: var(--space-1);
  }
  
  .posts-grid .post-header {
    padding: var(--space-4);
  }
  
  .posts-grid .post-content {
    padding: var(--space-4);
    min-height: 100px;
  }
  
  .posts-grid .post-footer {
    padding: var(--space-3) var(--space-4);
  }
}

@media (min-width: 1200px) {
  .posts-grid.grid {
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
  }
}

/* ÂàÜÈ°µÂìçÂ∫îÂºè‰ºòÂåñ */
@media (max-width: 768px) {
  .pagination-wrapper {
    padding: var(--space-4) var(--space-2);
    margin-top: var(--space-4);
  }
  
  :deep(.el-pagination) {
    gap: var(--space-1);
    font-size: var(--font-size-sm);
  }
  
  :deep(.el-pagination .btn-next),
  :deep(.el-pagination .btn-prev),
  :deep(.el-pagination .el-pager li) {
    min-height: 36px;
    min-width: 36px;
    margin: 0;
  }
  
  :deep(.el-pagination .el-pagination__total),
  :deep(.el-pagination .el-pagination__jump) {
    font-size: var(--font-size-xs);
    margin: var(--space-1);
  }
  
  :deep(.el-pagination .el-pagination__sizes) {
    margin: var(--space-1);
  }
  
  :deep(.el-pagination .el-pagination__jump .el-input) {
    width: 50px;
  }
}

@media (max-width: 480px) {
  .pagination-wrapper {
    padding: var(--space-3) var(--space-1);
  }
  
  :deep(.el-pagination) {
    /* ÁßªÂä®Á´ØÁÆÄÂåñÂ∏ÉÂ±Ä */
    .el-pagination__total,
    .el-pagination__sizes {
      display: none;
    }
  }
  
  :deep(.el-pagination .btn-next),
  :deep(.el-pagination .btn-prev),
  :deep(.el-pagination .el-pager li) {
    min-height: 32px;
    min-width: 32px;
    font-size: var(--font-size-xs);
  }
}
</style>