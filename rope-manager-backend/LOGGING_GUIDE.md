# ğŸš€ ç»³åŒ…ç®¡ç†å™¨åç«¯æ—¥å¿—ç³»ç»ŸæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

ä¼˜åŒ–åçš„æ—¥å¿—ç³»ç»Ÿæä¾›äº†æ¸…æ™°ã€ç»“æ„åŒ–çš„æ—¥å¿—è¾“å‡ºï¼Œä¾¿äºå¼€å‘è°ƒè¯•å’Œç”Ÿäº§ç›‘æ§ã€‚

## ğŸ¨ æ—¥å¿—æ ¼å¼

```
2024-01-15 14:30:25.123 [INFO] [main] ğŸš€ ç»³åŒ…ç®¡ç†å™¨åç«¯æœåŠ¡å¯åŠ¨
2024-01-15 14:30:25.456 [INFO] [api_logger] ğŸŒ GET /api/v1/packages 200 45ms âš¡ [user:123]
```

### æ ¼å¼è¯´æ˜
- **æ—¶é—´æˆ³**: ç²¾ç¡®åˆ°æ¯«ç§’çš„æ—¶é—´æˆ³
- **çº§åˆ«**: å½©è‰²ç¼–ç çš„æ—¥å¿—çº§åˆ«
- **æ¨¡å—**: ç®€åŒ–çš„æ¨¡å—è·¯å¾„
- **å†…å®¹**: å¸¦æœ‰emojiè¡¨æƒ…çš„ç»“æ„åŒ–æ¶ˆæ¯

## ğŸŒˆ æ—¥å¿—çº§åˆ«

| çº§åˆ« | é¢œè‰² | ç”¨é€” |
|------|------|------|
| ERROR | ğŸ”´ çº¢è‰² | ç³»ç»Ÿé”™è¯¯ã€APIå¤±è´¥ |
| WARN  | ğŸŸ¡ é»„è‰² | è­¦å‘Šä¿¡æ¯ã€æ…¢è¯·æ±‚ |
| INFO  | ğŸŸ¢ ç»¿è‰² | ä¸€èˆ¬ä¿¡æ¯ã€APIè¯·æ±‚ |
| DEBUG | ğŸ”µ é’è‰² | è°ƒè¯•ä¿¡æ¯ã€SQLæŸ¥è¯¢ |
| TRACE | âšª ç™½è‰² | è¯¦ç»†è·Ÿè¸ªä¿¡æ¯ |

## ğŸ› ï¸ ç¯å¢ƒå˜é‡é…ç½®

### è®¾ç½®æ—¥å¿—çº§åˆ«
```bash
# å¼€å‘ç¯å¢ƒ - æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
export RUST_LOG=debug

# ç”Ÿäº§ç¯å¢ƒ - åªæ˜¾ç¤ºé‡è¦ä¿¡æ¯
export RUST_LOG=info

# ç‰¹å®šæ¨¡å—è°ƒè¯•
export RUST_LOG=rope_manager_backend::repositories=debug,info
```

### æ—¥å¿—è¾“å‡ºæ§åˆ¶
```bash
# è¾“å‡ºåˆ°æ–‡ä»¶
cargo run > logs/server.log 2>&1

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
cargo run | tee logs/server.log

# åªçœ‹é”™è¯¯
cargo run 2>&1 | grep ERROR
```

## ğŸ” APIè¯·æ±‚æ—¥å¿—

### æ—¥å¿—æ ¼å¼
```
ğŸŒ METHOD /path STATUS TIME_MS PERFORMANCE_ICON [USER_INFO]
```

### ç¤ºä¾‹
```bash
# æ­£å¸¸è¯·æ±‚
ğŸŒ GET /api/v1/packages 200 45ms âš¡ [user:123]

# æ…¢è¯·æ±‚
ğŸŒ POST /api/v1/packages 201 1200ms ğŸŒ [user:456]

# é”™è¯¯è¯·æ±‚  
ğŸŒ GET /api/v1/invalid 404 12ms âš¡ [192.168.1.100]

# æœåŠ¡å™¨é”™è¯¯
ğŸŒ POST /api/v1/packages 500 89ms âš¡ [user:789]
```

### æ€§èƒ½æŒ‡ç¤ºå™¨
- âš¡ å¿«é€Ÿè¯·æ±‚ (< 500ms)
- âš ï¸ ä¸­ç­‰è¯·æ±‚ (500ms - 1s)  
- ğŸŒ æ…¢è¯·æ±‚ (> 1s)

## ğŸ“Š ç³»ç»Ÿæ—¥å¿—ç¤ºä¾‹

### å¯åŠ¨æ—¥å¿—
```bash
ğŸš€ ç»³åŒ…ç®¡ç†å™¨åç«¯æœåŠ¡å¯åŠ¨
ğŸ“¦ Version: 1.0.0
ğŸŒ Server: http://127.0.0.1:15201
ğŸ“‹ API æ–‡æ¡£: http://127.0.0.1:15201/swagger-ui/
âœ… æ‰€æœ‰æœåŠ¡åˆå§‹åŒ–å®Œæˆ
ğŸŒ APIæœåŠ¡å¯åŠ¨åœ¨: http://127.0.0.1:15201
```

### é‚®ä»¶æ—¥å¿—
```bash
ğŸ“§ Email sent successfully: user@example.com -> 'è´¦æˆ·éªŒè¯'
ğŸ“§ Email failed: invalid@domain.com -> 'å¯†ç é‡ç½®', error: SMTPè¿æ¥å¤±è´¥
```

### ç”¨æˆ·è¡Œä¸ºæ—¥å¿—
```bash
ğŸ‘¤ User 123 performed: èµ„æºç‚¹èµ on Package:456
ğŸ‘¤ User 456 performed: æ³¨å†Œ
```

### å®‰å…¨æ—¥å¿—
```bash
ğŸ”’ Suspicious activity from 192.168.1.100: é¢‘ç¹ç™»å½•å°è¯•
ğŸš« Blocked access from 192.168.1.200: IPè¢«å°ç¦
ğŸ” Authentication failed for 'testuser' from 192.168.1.50
```

## ğŸ›¡ï¸ ç”Ÿäº§ç¯å¢ƒå»ºè®®

### 1. æ—¥å¿—è½®è½¬
```bash
# ä½¿ç”¨logrotateé…ç½®
/var/log/rope-manager/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 644 rust rust
}
```

### 2. ç›‘æ§é…ç½®
```bash
# ç›‘æ§é”™è¯¯æ—¥å¿—
tail -f logs/server.log | grep ERROR

# ç›‘æ§æ…¢è¯·æ±‚
tail -f logs/server.log | grep "ğŸŒ"

# ç›‘æ§è®¤è¯å¤±è´¥
tail -f logs/server.log | grep "ğŸ”"
```

### 3. æ€§èƒ½åˆ†æ
```bash
# ç»Ÿè®¡APIå“åº”æ—¶é—´
grep "ğŸŒ" logs/server.log | awk '{print $6}' | sed 's/ms//' | sort -n

# æ‰¾å‡ºæœ€æ…¢çš„API
grep "ğŸŒ" logs/server.log | sort
```

## ğŸ”§ å¼€å‘è€…å·¥å…·

### è‡ªå®šä¹‰æ—¥å¿—å®
```rust
// æ€§èƒ½æ—¥å¿—
log_performance!("æ•°æ®åº“æŸ¥è¯¢", duration);

// APIè¯·æ±‚æ—¥å¿—  
log_api_request!("GET", "/api/v1/users", user_id);

// æ•°æ®åº“æ“ä½œæ—¥å¿—
log_db_operation!("INSERT", "users", user_id);

// é‚®ä»¶æ—¥å¿—
log_email!(success, "user@example.com", "éªŒè¯é‚®ä»¶");

// ç”¨æˆ·è¡Œä¸ºæ—¥å¿—
log_user_action!(user_id, "ç™»å½•", "æˆåŠŸ");

// å®‰å…¨æ—¥å¿—
log_security!(auth_failed, "testuser", "192.168.1.100");
```

### è°ƒè¯•æŠ€å·§
1. **ä¸´æ—¶æé«˜æ—¥å¿—çº§åˆ«**: `RUST_LOG=debug cargo run`
2. **è¿‡æ»¤ç‰¹å®šæ¨¡å—**: `RUST_LOG=package_service=debug cargo run`
3. **å®æ—¶ç›‘æ§**: `tail -f logs/server.log | grep "å…³é”®è¯"`
4. **é”™è¯¯è¿½è¸ª**: æ‰€æœ‰é”™è¯¯éƒ½åŒ…å«å®Œæ•´çš„é”™è¯¯é“¾

## ğŸ“ æ—¥å¿—æœ€ä½³å®è·µ

### âœ… å¥½çš„åšæ³•
- ä½¿ç”¨ç»“æ„åŒ–çš„æ—¥å¿—æ¶ˆæ¯
- åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- ä½¿ç”¨é€‚å½“çš„æ—¥å¿—çº§åˆ«
- é¿å…åœ¨å¾ªç¯ä¸­æ‰“å°å¤§é‡æ—¥å¿—

### âŒ é¿å…çš„åšæ³•
- ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨DEBUGçº§åˆ«
- ä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€ä»¤ç‰Œï¼‰
- ä¸è¦ä½¿ç”¨println!è¿›è¡Œè°ƒè¯•
- ä¸è¦è®°å½•è¿‡äºè¯¦ç»†çš„ç”¨æˆ·æ•°æ®

## ğŸ¯ æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜æ’æŸ¥
1. **æœåŠ¡å¯åŠ¨å¤±è´¥**: æŸ¥çœ‹ERRORçº§åˆ«æ—¥å¿—
2. **APIå“åº”æ…¢**: æœç´¢ğŸŒæ ‡è¯†çš„è¯·æ±‚
3. **è®¤è¯é—®é¢˜**: æŸ¥çœ‹ğŸ”ç›¸å…³æ—¥å¿—
4. **é‚®ä»¶å‘é€å¤±è´¥**: æœç´¢ğŸ“§ Email failed

### æ—¥å¿—åˆ†æå‘½ä»¤
```bash
# æœ€è¿‘çš„é”™è¯¯
tail -100 logs/server.log | grep ERROR

# ç»Ÿè®¡å„çŠ¶æ€ç æ•°é‡
grep "ğŸŒ" logs/server.log | awk '{print $4}' | sort | uniq -c

# æœ€æ´»è·ƒçš„ç”¨æˆ·
grep "user:" logs/server.log | sed 's/.*user:\([0-9]*\).*/\1/' | sort | uniq -c | sort -nr

# æœ€æ…¢çš„APIç«¯ç‚¹
grep "ğŸŒ" logs/server.log | awk '{print $3}' | sort | uniq -c | sort -nr
```

---

ğŸ’¡ **æç¤º**: åˆç†ä½¿ç”¨æ—¥å¿—å¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡å’Œç³»ç»Ÿå¯ç»´æŠ¤æ€§ï¼ 