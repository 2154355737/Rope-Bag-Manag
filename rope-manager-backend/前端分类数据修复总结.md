# å‰ç«¯åˆ†ç±»æ•°æ®ä¿®å¤æ€»ç»“

## é—®é¢˜æè¿°
å‰ç«¯éƒ¨åˆ†é¡µé¢ä»åœ¨ä½¿ç”¨ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿåˆ†ç±»æ•°æ®ï¼Œè€Œä¸æ˜¯ä»åç«¯APIè·å–çœŸå®æ•°æ®ã€‚

## é—®é¢˜å½±å“
- é¦–é¡µæ˜¾ç¤ºçš„åˆ†ç±»ä¸åç«¯æ•°æ®åº“ä¸ä¸€è‡´
- å‘å¸ƒé¡µé¢çš„åˆ†ç±»é€‰æ‹©ä¸åç«¯ä¸åŒ¹é…
- æ•°æ®ä¸åŒæ­¥ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ

## ä¿®å¤å†…å®¹

### 1. å‘å¸ƒé¡µé¢ (`publish-screen.tsx`)
**ä¿®å¤å‰ï¼š**
```typescript
// ç¡¬ç¼–ç çš„åˆ†ç±»æ•°æ®
const categories = [
  { value: 'tools', label: 'å¼€å‘å·¥å…·' },
  { value: 'libraries', label: 'åº“/æ¡†æ¶' },
  // ...
]
```

**ä¿®å¤åï¼š**
```typescript
// ä»APIåŠ è½½åˆ†ç±»æ•°æ®
import { getCategories, Category } from '@/api/categories'

const [categories, setCategories] = useState<Category[]>([])
const [loadingCategories, setLoadingCategories] = useState(true)

React.useEffect(() => {
  const loadCategories = async () => {
    try {
      const categoryList = await getCategories()
      setCategories(categoryList)
    } catch (error) {
      // é”™è¯¯å¤„ç†å’Œå¤‡ç”¨æ•°æ®
    }
  }
  loadCategories()
}, [])
```

### 2. é¦–é¡µ (`home-screen.tsx`)
**ä¿®å¤å‰ï¼š**
```typescript
// ç¡¬ç¼–ç çš„åˆ†ç±»æ•°æ®
const categories = [
  { icon: Code, label: 'åŸºç¡€è¯­æ³•', color: 'bg-blue-100 dark:bg-blue-900' },
  // ...
]
```

**ä¿®å¤åï¼š**
```typescript
// ä»APIåŠ è½½åˆ†ç±»æ•°æ®å¹¶æ·»åŠ æ ·å¼
const [categories, setCategories] = useState<(Category & { icon: any; color: string })[]>([])

useEffect(() => {
  const loadCategories = async () => {
    try {
      const categoryList = await getCategories()
      const categoriesWithStyle = categoryList.map((cat, index) => ({
        ...cat,
        icon: categoryIcons[index % categoryIcons.length] || Code,
        color: categoryColors[index % categoryColors.length]
      }))
      setCategories(categoriesWithStyle)
    } catch (error) {
      // é”™è¯¯å¤„ç†å’Œå¤‡ç”¨æ•°æ®
    }
  }
  loadCategories()
}, [])
```

### 3. æ•°æ®ç»“æ„ç»Ÿä¸€
- å°†æ‰€æœ‰åˆ†ç±»æ•°æ®ç»Ÿä¸€ä½¿ç”¨ `{ id, name }` ç»“æ„
- ä¿®å¤é€‰æ‹©æ¡†æ˜ å°„ï¼š`cat.value` â†’ `cat.id.toString()`
- ä¿®å¤æ˜¾ç¤ºæ–‡æœ¬ï¼š`cat.label` â†’ `cat.name`

## æŠ€æœ¯è¦ç‚¹

### 1. APIé›†æˆ
- ä½¿ç”¨ç°æœ‰çš„ `getCategories()` API å‡½æ•°
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- å¤‡ç”¨æ•°æ®ç­–ç•¥

### 2. ç±»å‹å®‰å…¨
- ä½¿ç”¨ TypeScript æ¥å£ `Category`
- ä¸ºé¦–é¡µåˆ†ç±»æ‰©å±•ç±»å‹æ·»åŠ  `icon` å’Œ `color` å±æ€§
- ä¿æŒç±»å‹ä¸€è‡´æ€§

### 3. ç”¨æˆ·ä½“éªŒ
- åŠ è½½çŠ¶æ€ç®¡ç† (`loadingCategories`)
- é”™è¯¯å¤„ç†å’Œæç¤º
- ä¼˜é›…é™çº§åˆ°å¤‡ç”¨æ•°æ®

## åç«¯APIçŠ¶æ€

### åˆ†ç±»APIç«¯ç‚¹
- **ä¸»åˆ†ç±»API**: `GET /api/v1/categories`
- **åŒ…åˆ†ç±»API**: `GET /api/v1/packages/categories`
- **ç®¡ç†å‘˜åˆ†ç±»API**: `GET /api/v1/admin/categories`

### æ•°æ®æ ¼å¼
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "å¼€å‘å·¥å…·",
        "description": "å„ç§å¼€å‘å·¥å…·å’Œå®ç”¨ç¨‹åº",
        "enabled": true,
        "count": 5
      }
    ]
  }
}
```

## éªŒè¯æ–¹æ³•

### 1. å‰ç«¯æµ‹è¯•
```bash
cd App_v2/jieshengshequ-app
npm run dev
```

### 2. åç«¯æµ‹è¯•
```bash
cd rope-manager-backend
cargo run --release
```

### 3. APIæµ‹è¯•
```bash
curl http://localhost:15201/api/v1/categories
```

## ä¸‹ä¸€æ­¥è®¡åˆ’
1. é‡æ–°ç¼–è¯‘å¹¶è¿è¡Œåç«¯æœåŠ¡
2. æµ‹è¯•å‰ç«¯åˆ†ç±»æ•°æ®åŠ è½½
3. éªŒè¯å‘å¸ƒé¡µé¢åˆ†ç±»é€‰æ‹©åŠŸèƒ½
4. æ£€æŸ¥åˆ†ç±»æ•°æ®åœ¨ä¸åŒé¡µé¢çš„ä¸€è‡´æ€§

## å—å½±å“çš„æ–‡ä»¶
- `App_v2/jieshengshequ-app/src/screens/publish-screen.tsx`
- `App_v2/jieshengshequ-app/src/screens/home-screen.tsx`
- `App_v2/jieshengshequ-app/src/api/categories.ts` (å·²å­˜åœ¨)

## ä¿®å¤çŠ¶æ€
âœ… å‘å¸ƒé¡µé¢åˆ†ç±»æ•°æ®ä¿®å¤å®Œæˆ
âœ… é¦–é¡µåˆ†ç±»æ•°æ®ä¿®å¤å®Œæˆ  
âœ… æ•°æ®ç»“æ„ç»Ÿä¸€å®Œæˆ
ğŸ”„ ç­‰å¾…æµ‹è¯•éªŒè¯ 