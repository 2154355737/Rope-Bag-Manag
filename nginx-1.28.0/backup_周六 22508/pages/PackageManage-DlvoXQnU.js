import{x as qe,r as c,c as Ge,j as Je,y as E,A as u,Q as a,I as o,u as y,al as b,M as r,O as f,P as X,a6 as Y,H as P,J as We,ar as Xe,K as O,a4 as Ye,w as ge,z as w}from"../chunks/vue-vendor-BleHOoLr.js";import{b as _e,M as ye,H as Ze,c as ea,U as aa,u as la,X as ta,N as oa,f as be,Y as Ve,K as we,_ as sa,G as d,E as ke}from"../chunks/element-plus-BqgU8HW0.js";import{a as Q,j as Ce,r as Z,_ as ua}from"../assets/index-BYq8Q9FJ.js";import{p as L}from"../chunks/packages-D1bca-EI.js";import{c as ee}from"../chunks/categories-CDxQep1u.js";import{c as na}from"../chunks/posts-s6Ksrwn6.js";import"../chunks/utils-Dq7h7Pqt.js";const ae={get:I=>Q.get(`/v1/cache/${I}`),set:(I,x,z)=>Q.post("/v1/cache",{key:I,value:x,ttl:z}),delete:I=>Q.delete(`/v1/cache/${I}`),clear:()=>Q.delete("/v1/cache"),getStats:()=>Q.get("/v1/cache/stats")},da={class:"package-manage-desktop"},ra={class:"page-header"},ia={class:"header-content"},va={class:"header-left"},ca={class:"header-icon"},pa={class:"header-actions"},ma={class:"stats-section"},fa={class:"stats-grid"},ga={class:"stat-card"},_a={class:"stat-icon"},ya={class:"stat-content"},ba={class:"stat-number"},Va={class:"stat-card"},wa={class:"stat-icon"},ka={class:"stat-content"},Ca={class:"stat-number"},ha={class:"stat-card"},xa={class:"stat-icon"},Ua={class:"stat-content"},Pa={class:"stat-number"},Da={class:"stat-card"},$a={class:"stat-icon"},za={class:"stat-content"},Ta={class:"stat-number"},Ia={class:"search-section"},Aa={class:"search-left"},Sa={class:"search-right"},Ma={class:"table-section"},Ba={class:"pagination-section"},Na={key:0,class:"package-detail"},Ea={class:"detail-header"},La=["href"],ja={class:"detail-actions"},Ka={class:"tags-container"},Fa={class:"category-management"},Ra={class:"category-header"},Ha=qe({__name:"PackageManage",setup(I){const x=c(""),z=c(""),j=c(""),le=c(!1),q=c(1),te=c(20),K=c(!1),A=c(!1),F=c(!1),oe=c(!1),R=c(!1),H=c(!1),_=c(null),h=c([]),G=c(0),se=c(0),ue=c(0),ne=c(0),T=c([]),s=c({type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""}),C=c({name:"",description:"",enabled:!0}),i=c({id:0,name:"",author:"",version:"",category_id:void 0,status:"",description:"",url:""}),k=c({id:0,name:"",description:"",enabled:!0}),he=Ge(()=>{let l=h.value;return x.value&&(l=l.filter(e=>e.name.toLowerCase().includes(x.value.toLowerCase())||e.author.toLowerCase().includes(x.value.toLowerCase()))),j.value&&(l=l.filter(e=>e.type===j.value)),l}),xe=async l=>{try{const e=await L.getPackage(l);if(e.code===0&&e.data){const n=h.value.findIndex(v=>v.id===l);n!==-1&&(h.value[n].downloads=e.data.download_count,de())}}catch(e){console.error("刷新下载计数失败:",e)}};function Ue(){ge([z,j],()=>{D()}),ge(()=>h.value,()=>{de()},{deep:!0})}async function D(){try{le.value=!0,ae.delete("getPackages");const l={};z.value&&(l.status=z.value),x.value&&(l.search=x.value);const e=await L.getPackages(l);e.code===0&&e.data?(h.value=e.data.list?.map(n=>{let v="未分类";if(n.category_id){const g=T.value.find(p=>p.id===n.category_id);g&&(v=g.name)}return{id:n.id,name:n.name,author:n.author,version:n.version||"",category_id:n.category_id,type:v,status:n.status||"Active",description:n.description||"",downloads:n.download_count,uploadTime:n.created_at,lastUpdate:n.updated_at,url:n.file_url||""}})||[],console.log("处理后的绳包数据:",h.value),de()):d.error("获取绳包数据失败")}catch(l){console.error("获取绳包数据错误:",l),d.error("获取绳包数据失败")}finally{le.value=!1}}function de(){G.value=h.value.length,se.value=h.value.filter(e=>e.status==="正常"||e.status==="Active"||e.status==="已发布").length,ue.value=h.value.filter(e=>e.status==="待审核"||e.status==="Inactive").length;const l=new Set(h.value.map(e=>e.author));ne.value=l.size,console.log("统计数据更新:",{总资源数:G.value,已发布:se.value,待审核:ue.value,活跃用户:ne.value})}async function U(){try{ae.delete("getCategories");const l=await ee.getCategories();l.code===0&&l.data?(T.value=l.data.list||[],console.log("获取到的分类数据:",T.value)):d.error("获取分类数据失败")}catch(l){console.error("获取分类数据错误:",l),d.error("获取分类数据失败")}}function Pe(){D()}async function De(){ae.delete("getPackages"),ae.delete("getCategories"),await Promise.all([D(),U()]),d.success("数据已刷新")}function $e(){A.value=!0}const ze=l=>{_.value=l,K.value=!0,Ce.logView("Package",l.id,`管理员查看绳包详情: ${l.name}`).catch(e=>console.error("记录查看行为失败:",e))},re=async l=>{try{if(l.status!=="正常"&&l.status!=="Active"){d.warning(`资源 ${l.name} 状态不为正常，无法下载`);return}if(!l.url||l.url.trim()===""){d.warning(`资源 ${l.name} 没有项目链接，无法下载`);return}const e=await L.downloadPackage(l.id);e.code!==0&&console.warn("增加下载计数失败:",e.message),await Z.logDownload(l.id),window.open(l.url,"_blank"),d.success(`开始下载 ${l.name}`),setTimeout(()=>{xe(l.id)},500)}catch(e){console.error("下载错误:",e),d.error("下载失败")}};function Te(l){i.value={id:l.id,name:l.name,author:l.author,version:l.version,category_id:l.category_id?Number(l.category_id):void 0,status:l.status||"Active",description:l.description,url:l.url},F.value=!0,Ce.logAction("EditPackage",`管理员打开编辑绳包: ${l.name}`,"Package",l.id).catch(e=>console.error("记录编辑行为失败:",e))}async function Ie(){try{if(!i.value.name.trim()){d.error("请输入绳包名称");return}if(!i.value.author.trim()){d.error("请输入作者");return}if(!i.value.description.trim()){d.error("请输入描述");return}if(!i.value.url.trim()){d.error("请输入项目链接");return}let l="Active";switch(i.value.status){case"正常":case"已发布":l="Active";break;case"待审核":case"维护中":l="Inactive";break;case"已拒绝":l="Deleted";break}const e={name:i.value.name,version:i.value.version,description:i.value.description,category_id:i.value.category_id,status:l,file_url:i.value.url};console.log("更新绳包数据:",e);const n=await L.updatePackage(i.value.id,e);n.code===0?(d.success("绳包更新成功"),F.value=!1,setTimeout(async()=>{await U(),await D()},500)):d.error(n.message||"更新失败")}catch(l){console.error("更新绳包错误:",l),d.error("更新失败")}}async function Ae(l){try{await ke.confirm(`确定要删除绳包 ${l.name} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e={id:l.id,name:l.name,author:l.author},n=await L.deletePackage(l.id);n.code===0?(d.success("绳包已删除"),setTimeout(async()=>{await D(),await U()},500)):d.error(n.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除绳包错误:",e),d.error("删除失败"))}}function Se(){const l=s.value.tagsInput?.trim();l&&l.length>0&&!s.value.tags.includes(l)&&(s.value.tags.push(l),s.value.tagsInput="")}function Me(l){const e=s.value.tags.indexOf(l);e>-1&&s.value.tags.splice(e,1)}async function Be(){try{if(!s.value.name.trim()){d.error("请输入标题");return}if(!s.value.description.trim()){d.error("请输入内容");return}if(s.value.type==="package"){if(!s.value.author.trim()){d.error("请输入作者");return}if(!s.value.url.trim()){d.error("请输入项目链接");return}const l={name:s.value.name,author:s.value.author,version:s.value.version,description:s.value.description,category_id:s.value.category_id,file_url:s.value.url,tags:s.value.tags};console.log("创建资源数据:",l);const e=await L.adminCreatePackage(l);e.code===0?(d.success("资源添加成功"),A.value=!1,s.value={type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""},setTimeout(async()=>{await U(),await D()},500)):d.error(e.msg||"添加失败")}else{const l=await na({title:s.value.name,content:s.value.description,category_id:s.value.category_id,tags:s.value.tags,status:"Published"});l.code===0?(d.success("帖子发布成功"),A.value=!1,s.value={type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""},setTimeout(async()=>{await U(),await D()},500)):d.error(l.msg||"发布失败")}}catch(l){console.error("添加内容错误:",l),d.error(s.value.type==="package"?"添加失败":"发布失败")}}async function Ne(){try{if(!C.value.name.trim()){d.error("请输入分类名称");return}const l=await ee.addCategory({name:C.value.name,description:C.value.description,enabled:C.value.enabled});l.code===0?(d.success("分类添加成功"),l.data&&l.data.id&&await Z.logCreate(l.data.id,"Category"),R.value=!1,C.value={name:"",description:"",enabled:!0},await U()):d.error(l.message||"添加分类失败")}catch(l){console.error("添加分类出错:",l),d.error("添加分类失败")}}function Ee(l){k.value={id:l.id,name:l.name,description:l.description,enabled:l.enabled},H.value=!0}async function Le(){try{if(!k.value.name.trim()){d.error("请输入分类名称");return}const l=await ee.updateCategory(k.value.id,{name:k.value.name,description:k.value.description,enabled:k.value.enabled});l.code===0?(d.success("分类更新成功"),await Z.logUpdate(k.value.id,"Category"),H.value=!1,await U()):d.error(l.message||"更新分类失败")}catch(l){console.error("更新分类出错:",l),d.error("更新分类失败")}}async function je(l){try{await ke.confirm(`确定要删除分类 ${l.name} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Z.logDelete(l.id,"Category");const e=await ee.deleteCategory(l.id);e.code===0?(d.success("分类已删除"),await U()):d.error(e.message||"删除分类失败")}catch(e){e!=="cancel"&&(console.error("删除分类出错:",e),d.error("删除分类失败"))}}function ie(l){return{正常:"正常",已发布:"已发布",待审核:"待审核",已拒绝:"已拒绝",维护中:"维护中",Active:"已发布",Pending:"待审核",Rejected:"已拒绝",Inactive:"已下架",Deleted:"已删除"}[l]||l}function ve(l){return{正常:"success",已发布:"success",待审核:"warning",已拒绝:"danger",维护中:"warning",已下架:"info",已删除:"danger",Active:"success",Pending:"warning",Rejected:"danger",Inactive:"info",Deleted:"danger"}[l]||"info"}function Oa(l){return l}function ce(l){return{教程:"primary",工具:"success",模板:"warning",其他:"info",未分类:"info"}[l]||"info"}function Ke(l){te.value=l,q.value=1}function Fe(l){q.value=l}function J(l){return new Date(l).toLocaleDateString("zh-CN")}return Je(async()=>{await U(),await D(),Ue()}),(l,e)=>{const n=b("el-icon"),v=b("el-button"),g=b("el-input"),p=b("el-option"),S=b("el-select"),V=b("el-table-column"),M=b("el-tag"),pe=b("el-table"),Re=b("el-pagination"),$=b("el-descriptions-item"),He=b("el-descriptions"),B=b("el-dialog"),me=b("el-radio"),Oe=b("el-radio-group"),m=b("el-form-item"),W=b("el-form"),fe=b("el-switch"),Qe=Xe("loading");return w(),E("div",da,[u("div",ra,[u("div",ia,[u("div",va,[u("div",ca,[a(n,{size:32},{default:o(()=>[a(y(_e))]),_:1})]),e[41]||(e[41]=u("div",{class:"header-info"},[u("h1",{class:"page-title"},"内容管理"),u("p",{class:"page-subtitle"},"管理绳包资源和社区内容")],-1))]),u("div",pa,[a(v,{type:"primary",onClick:$e},{default:o(()=>[a(n,null,{default:o(()=>[a(y(ye))]),_:1}),e[42]||(e[42]=r(" 添加内容 "))]),_:1,__:[42]}),a(v,{onClick:e[0]||(e[0]=t=>oe.value=!0)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(Ze))]),_:1}),e[43]||(e[43]=r(" 分类管理 "))]),_:1,__:[43]})])])]),u("div",ma,[u("div",fa,[u("div",ga,[u("div",_a,[a(n,{size:24},{default:o(()=>[a(y(_e))]),_:1})]),u("div",ya,[u("div",ba,f(G.value),1),e[44]||(e[44]=u("div",{class:"stat-label"},"总资源数",-1))])]),u("div",Va,[u("div",wa,[a(n,{size:24},{default:o(()=>[a(y(ea))]),_:1})]),u("div",ka,[u("div",Ca,f(se.value),1),e[45]||(e[45]=u("div",{class:"stat-label"},"已发布",-1))])]),u("div",ha,[u("div",xa,[a(n,{size:24},{default:o(()=>[a(y(aa))]),_:1})]),u("div",Ua,[u("div",Pa,f(ue.value),1),e[46]||(e[46]=u("div",{class:"stat-label"},"待审核",-1))])]),u("div",Da,[u("div",$a,[a(n,{size:24},{default:o(()=>[a(y(la))]),_:1})]),u("div",za,[u("div",Ta,f(ne.value),1),e[47]||(e[47]=u("div",{class:"stat-label"},"活跃用户",-1))])])])]),u("div",Ia,[u("div",Aa,[a(g,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=t=>x.value=t),placeholder:"搜索绳包...","prefix-icon":"Search",clearable:"",style:{width:"300px"},onInput:Pe},null,8,["modelValue"]),a(S,{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=t=>z.value=t),placeholder:"状态筛选",clearable:"",style:{width:"150px"}},{default:o(()=>[a(p,{label:"全部",value:""}),a(p,{label:"已发布",value:"Active"}),a(p,{label:"待审核",value:"Pending"}),a(p,{label:"已拒绝",value:"Rejected"}),a(p,{label:"已下架",value:"Inactive"}),a(p,{label:"已删除",value:"Deleted"})]),_:1},8,["modelValue"]),a(S,{modelValue:j.value,"onUpdate:modelValue":e[3]||(e[3]=t=>j.value=t),placeholder:"分类筛选",clearable:"",style:{width:"150px"}},{default:o(()=>[a(p,{label:"全部",value:""}),(w(!0),E(X,null,Y(T.value,t=>(w(),P(p,{key:t.id,label:t.name,value:t.name,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),u("div",Sa,[a(v,{onClick:De},{default:o(()=>[a(n,null,{default:o(()=>[a(y(ta))]),_:1}),e[48]||(e[48]=r(" 刷新 "))]),_:1,__:[48]})])]),u("div",Ma,[We((w(),P(pe,{data:he.value,style:{width:"100%"},"header-cell-style":{background:"var(--bg-secondary)",color:"var(--text-primary)"},"row-style":{background:"var(--bg-card)"},border:"",stripe:""},{default:o(()=>[a(V,{prop:"id",label:"ID",width:"80"}),a(V,{prop:"name",label:"名称",width:"200"}),a(V,{prop:"author",label:"作者",width:"120"}),a(V,{prop:"version",label:"版本",width:"100"}),a(V,{prop:"type",label:"分类",width:"100"},{default:o(({row:t})=>[a(M,{type:ce(t.type)},{default:o(()=>[r(f(t.type),1)]),_:2},1032,["type"])]),_:1}),a(V,{prop:"status",label:"状态",width:"100"},{default:o(({row:t})=>[a(M,{type:ve(t.status)},{default:o(()=>[r(f(ie(t.status)),1)]),_:2},1032,["type"])]),_:1}),a(V,{prop:"downloads",label:"下载次数",width:"120"}),a(V,{prop:"uploadTime",label:"上传时间",width:"150"},{default:o(({row:t})=>[r(f(J(t.uploadTime)),1)]),_:1}),a(V,{prop:"lastUpdate",label:"最后更新",width:"150"},{default:o(({row:t})=>[r(f(J(t.lastUpdate)),1)]),_:1}),a(V,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),a(V,{label:"操作",width:"250",fixed:"right"},{default:o(({row:t})=>[a(v,{size:"small",type:"primary",onClick:N=>ze(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(oa))]),_:1}),e[49]||(e[49]=r(" 查看 "))]),_:2,__:[49]},1032,["onClick"]),a(v,{size:"small",type:"success",onClick:N=>re(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(be))]),_:1}),e[50]||(e[50]=r(" 下载 "))]),_:2,__:[50]},1032,["onClick"]),a(v,{size:"small",type:"warning",onClick:N=>Te(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(Ve))]),_:1}),e[51]||(e[51]=r(" 编辑 "))]),_:2,__:[51]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:N=>Ae(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(we))]),_:1}),e[52]||(e[52]=r(" 删除 "))]),_:2,__:[52]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Qe,le.value]])]),u("div",Ba,[a(Re,{"current-page":q.value,"onUpdate:currentPage":e[4]||(e[4]=t=>q.value=t),"page-size":te.value,"onUpdate:pageSize":e[5]||(e[5]=t=>te.value=t),"page-sizes":[10,20,50,100],total:G.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ke,onCurrentChange:Fe},null,8,["current-page","page-size","total"])]),a(B,{modelValue:K.value,"onUpdate:modelValue":e[8]||(e[8]=t=>K.value=t),title:"绳包详情",width:"800px","close-on-click-modal":!1},{default:o(()=>[_.value?(w(),E("div",Na,[u("div",Ea,[u("h3",null,f(_.value.name),1),a(M,{type:ve(_.value.status)},{default:o(()=>[r(f(ie(_.value.status)),1)]),_:1},8,["type"])]),a(He,{column:2,border:""},{default:o(()=>[a($,{label:"作者"},{default:o(()=>[r(f(_.value.author),1)]),_:1}),a($,{label:"版本"},{default:o(()=>[r(f(_.value.version),1)]),_:1}),a($,{label:"类型"},{default:o(()=>[a(M,{type:ce(_.value.type)},{default:o(()=>[r(f(_.value.type),1)]),_:1},8,["type"])]),_:1}),a($,{label:"下载次数"},{default:o(()=>[r(f(_.value.downloads),1)]),_:1}),a($,{label:"上传时间"},{default:o(()=>[r(f(J(_.value.uploadTime)),1)]),_:1}),a($,{label:"最后更新"},{default:o(()=>[r(f(J(_.value.lastUpdate)),1)]),_:1}),a($,{label:"描述",span:2},{default:o(()=>[r(f(_.value.description),1)]),_:1}),a($,{label:"项目链接",span:2},{default:o(()=>[u("a",{href:_.value.url,target:"_blank"},f(_.value.url),9,La)]),_:1})]),_:1}),u("div",ja,[a(v,{type:"primary",onClick:e[6]||(e[6]=t=>{re(_.value),K.value=!1}),disabled:_.value.status!=="正常"&&_.value.status!=="Active"},{default:o(()=>[a(n,null,{default:o(()=>[a(y(be))]),_:1}),e[53]||(e[53]=r(" 下载绳包 "))]),_:1,__:[53]},8,["disabled"]),a(v,{onClick:e[7]||(e[7]=t=>K.value=!1)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(sa))]),_:1}),e[54]||(e[54]=r(" 关闭 "))]),_:1,__:[54]})])])):O("",!0)]),_:1},8,["modelValue"]),a(B,{modelValue:A.value,"onUpdate:modelValue":e[19]||(e[19]=t=>A.value=t),title:"添加内容",width:"600px","close-on-click-modal":!1},{footer:o(()=>[a(v,{onClick:e[18]||(e[18]=t=>A.value=!1)},{default:o(()=>e[57]||(e[57]=[r("取消")])),_:1,__:[57]}),a(v,{type:"primary",onClick:Be},{default:o(()=>[r(f(s.value.type==="package"?"添加资源":"发布帖子"),1)]),_:1})]),default:o(()=>[a(W,{model:s.value,"label-width":"100px"},{default:o(()=>[a(m,{label:"内容类型"},{default:o(()=>[a(Oe,{modelValue:s.value.type,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.type=t)},{default:o(()=>[a(me,{label:"package"},{default:o(()=>e[55]||(e[55]=[r("资源")])),_:1,__:[55]}),a(me,{label:"post"},{default:o(()=>e[56]||(e[56]=[r("帖子")])),_:1,__:[56]})]),_:1},8,["modelValue"])]),_:1}),a(m,{label:s.value.type==="package"?"资源名称":"帖子标题"},{default:o(()=>[a(g,{modelValue:s.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.name=t),placeholder:s.value.type==="package"?"请输入资源名称":"请输入帖子标题"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s.value.type==="package"?(w(),P(m,{key:0,label:"作者"},{default:o(()=>[a(g,{modelValue:s.value.author,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.author=t),placeholder:"请输入作者"},null,8,["modelValue"])]),_:1})):O("",!0),s.value.type==="package"?(w(),P(m,{key:1,label:"版本"},{default:o(()=>[a(g,{modelValue:s.value.version,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.version=t),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1})):O("",!0),a(m,{label:s.value.type==="package"?"资源分类":"帖子分类"},{default:o(()=>[a(S,{modelValue:s.value.category_id,"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.category_id=t),placeholder:s.value.type==="package"?"选择资源分类":"选择帖子分类"},{default:o(()=>[(w(!0),E(X,null,Y(T.value,t=>(w(),P(p,{key:t.id,label:t.name,value:t.id,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s.value.type==="package"?(w(),P(m,{key:2,label:"状态"},{default:o(()=>[a(S,{modelValue:s.value.status,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.status=t),placeholder:"选择状态"},{default:o(()=>[a(p,{label:"正常",value:"正常"}),a(p,{label:"已发布",value:"已发布"}),a(p,{label:"待审核",value:"待审核"}),a(p,{label:"已拒绝",value:"已拒绝"}),a(p,{label:"维护中",value:"维护中"})]),_:1},8,["modelValue"])]),_:1})):O("",!0),a(m,{label:s.value.type==="package"?"资源描述":"帖子内容"},{default:o(()=>[a(g,{modelValue:s.value.description,"onUpdate:modelValue":e[15]||(e[15]=t=>s.value.description=t),type:"textarea",rows:3,placeholder:s.value.type==="package"?"请输入资源描述":"请输入帖子内容"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(m,{label:"标签"},{default:o(()=>[a(g,{modelValue:s.value.tagsInput,"onUpdate:modelValue":e[16]||(e[16]=t=>s.value.tagsInput=t),placeholder:"输入标签，用逗号分隔",onKeyup:Ye(Se,["enter"]),clearable:""},null,8,["modelValue"]),u("div",Ka,[(w(!0),E(X,null,Y(s.value.tags,t=>(w(),P(M,{key:t,closable:"",onClose:N=>Me(t),effect:"light"},{default:o(()=>[r(f(t),1)]),_:2},1032,["onClose"]))),128))])]),_:1}),s.value.type==="package"?(w(),P(m,{key:3,label:"项目链接"},{default:o(()=>[a(g,{modelValue:s.value.url,"onUpdate:modelValue":e[17]||(e[17]=t=>s.value.url=t),placeholder:"请输入项目链接"},null,8,["modelValue"])]),_:1})):O("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(B,{modelValue:F.value,"onUpdate:modelValue":e[28]||(e[28]=t=>F.value=t),title:"编辑资源",width:"600px","close-on-click-modal":!1},{footer:o(()=>[a(v,{onClick:e[27]||(e[27]=t=>F.value=!1)},{default:o(()=>e[58]||(e[58]=[r("取消")])),_:1,__:[58]}),a(v,{type:"primary",onClick:Ie},{default:o(()=>e[59]||(e[59]=[r("保存")])),_:1,__:[59]})]),default:o(()=>[a(W,{model:i.value,"label-width":"100px"},{default:o(()=>[a(m,{label:"名称"},{default:o(()=>[a(g,{modelValue:i.value.name,"onUpdate:modelValue":e[20]||(e[20]=t=>i.value.name=t),placeholder:"请输入资源名称"},null,8,["modelValue"])]),_:1}),a(m,{label:"作者"},{default:o(()=>[a(g,{modelValue:i.value.author,"onUpdate:modelValue":e[21]||(e[21]=t=>i.value.author=t),placeholder:"请输入作者"},null,8,["modelValue"])]),_:1}),a(m,{label:"版本"},{default:o(()=>[a(g,{modelValue:i.value.version,"onUpdate:modelValue":e[22]||(e[22]=t=>i.value.version=t),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1}),a(m,{label:"分类"},{default:o(()=>[a(S,{modelValue:i.value.category_id,"onUpdate:modelValue":e[23]||(e[23]=t=>i.value.category_id=t),placeholder:"选择分类"},{default:o(()=>[(w(!0),E(X,null,Y(T.value,t=>(w(),P(p,{key:t.id,label:t.name,value:t.id,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"状态"},{default:o(()=>[a(S,{modelValue:i.value.status,"onUpdate:modelValue":e[24]||(e[24]=t=>i.value.status=t),placeholder:"选择状态"},{default:o(()=>[a(p,{label:"正常",value:"正常"}),a(p,{label:"已发布",value:"已发布"}),a(p,{label:"待审核",value:"待审核"}),a(p,{label:"已拒绝",value:"已拒绝"}),a(p,{label:"维护中",value:"维护中"})]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"描述"},{default:o(()=>[a(g,{modelValue:i.value.description,"onUpdate:modelValue":e[25]||(e[25]=t=>i.value.description=t),type:"textarea",rows:3,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),a(m,{label:"项目链接"},{default:o(()=>[a(g,{modelValue:i.value.url,"onUpdate:modelValue":e[26]||(e[26]=t=>i.value.url=t),placeholder:"请输入项目链接"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(B,{modelValue:oe.value,"onUpdate:modelValue":e[40]||(e[40]=t=>oe.value=t),title:"分类管理",width:"800px","close-on-click-modal":!1},{default:o(()=>[u("div",Fa,[u("div",Ra,[a(v,{type:"primary",onClick:e[29]||(e[29]=t=>R.value=!0)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(ye))]),_:1}),e[60]||(e[60]=r(" 添加分类 "))]),_:1,__:[60]})]),a(pe,{data:T.value,style:{width:"100%"},stripe:""},{default:o(()=>[a(V,{prop:"name",label:"分类名称",width:"150"}),a(V,{prop:"description",label:"描述","min-width":"200"}),a(V,{prop:"count",label:"资源数量",width:"100"}),a(V,{prop:"enabled",label:"状态",width:"100"},{default:o(({row:t})=>[a(M,{type:t.enabled?"success":"info"},{default:o(()=>[r(f(t.enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(V,{label:"操作",width:"200"},{default:o(({row:t})=>[a(v,{size:"small",onClick:N=>Ee(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(Ve))]),_:1}),e[61]||(e[61]=r(" 编辑 "))]),_:2,__:[61]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:N=>je(t)},{default:o(()=>[a(n,null,{default:o(()=>[a(y(we))]),_:1}),e[62]||(e[62]=r(" 删除 "))]),_:2,__:[62]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),a(B,{modelValue:R.value,"onUpdate:modelValue":e[34]||(e[34]=t=>R.value=t),title:"添加分类",width:"500px","append-to-body":""},{footer:o(()=>[a(v,{onClick:e[33]||(e[33]=t=>R.value=!1)},{default:o(()=>e[63]||(e[63]=[r("取消")])),_:1,__:[63]}),a(v,{type:"primary",onClick:Ne},{default:o(()=>e[64]||(e[64]=[r("添加")])),_:1,__:[64]})]),default:o(()=>[a(W,{model:C.value,"label-width":"100px"},{default:o(()=>[a(m,{label:"分类名称"},{default:o(()=>[a(g,{modelValue:C.value.name,"onUpdate:modelValue":e[30]||(e[30]=t=>C.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),a(m,{label:"描述"},{default:o(()=>[a(g,{modelValue:C.value.description,"onUpdate:modelValue":e[31]||(e[31]=t=>C.value.description=t),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1}),a(m,{label:"状态"},{default:o(()=>[a(fe,{modelValue:C.value.enabled,"onUpdate:modelValue":e[32]||(e[32]=t=>C.value.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(B,{modelValue:H.value,"onUpdate:modelValue":e[39]||(e[39]=t=>H.value=t),title:"编辑分类",width:"500px","append-to-body":""},{footer:o(()=>[a(v,{onClick:e[38]||(e[38]=t=>H.value=!1)},{default:o(()=>e[65]||(e[65]=[r("取消")])),_:1,__:[65]}),a(v,{type:"primary",onClick:Le},{default:o(()=>e[66]||(e[66]=[r("保存")])),_:1,__:[66]})]),default:o(()=>[a(W,{model:k.value,"label-width":"100px"},{default:o(()=>[a(m,{label:"分类名称"},{default:o(()=>[a(g,{modelValue:k.value.name,"onUpdate:modelValue":e[35]||(e[35]=t=>k.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),a(m,{label:"描述"},{default:o(()=>[a(g,{modelValue:k.value.description,"onUpdate:modelValue":e[36]||(e[36]=t=>k.value.description=t),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1}),a(m,{label:"状态"},{default:o(()=>[a(fe,{modelValue:k.value.enabled,"onUpdate:modelValue":e[37]||(e[37]=t=>k.value.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Za=ua(Ha,[["__scopeId","data-v-38f519ce"]]);export{Za as default};
