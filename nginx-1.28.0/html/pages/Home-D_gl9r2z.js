import{x as _t,r as f,c as z,X as ft,j as De,w as mt,Z as gt,y as c,A as t,Q as l,az as fe,P as b,a6 as C,C as ht,I as n,al as y,u as i,a4 as Se,H as q,K as N,M as m,O as d,J as yt,R as wt,V as k,D as Me,ax as kt,n as bt,z as r}from"../chunks/vue-vendor-BleHOoLr.js";import{q as Re,u as O,r as Ct,j as xt,s as zt,t as Vt,l as J,f as ee,v as re,w as Te,x as Ie,y as $t,z as Dt,A as St,B as Mt,C as Ue,m as Rt,D as Tt,F as It,G as Ut,H as V,E as Lt}from"../chunks/element-plus-hGoKm610.js";import{T as At}from"../chunks/ThemeSwitcher--hNdK5mb.js";import{a as w,g as te,_ as Ft}from"../assets/index-D3Kp6etV.js";import{f as me}from"../chunks/format-B9owEeWI.js";import{p as Bt}from"../chunks/packages-B3dEIScr.js";import{c as Ht}from"../chunks/categories-Cxelk8WM.js";import{g as qt}from"../chunks/announcements-FlInnjNE.js";import"../chunks/utils-Dq7h7Pqt.js";const Le={getResources:u=>w.get("/v1/packages",{params:u}),getResource:u=>w.get(`/v1/packages/${u}`),downloadResource:u=>w.get(`/v1/packages/${u}/download`),createResource:u=>w.post("/v1/packages",u),updateResource:(u,g)=>w.put(`/v1/packages/${u}`,g),deleteResource:u=>w.delete(`/v1/packages/${u}`),batchDeleteResources:u=>w.post("/v1/packages/batch-delete",{ids:u}),updateResourceStatus:(u,g)=>w.put(`/v1/packages/${u}/status`,{status:g}),batchUpdateResourceStatus:(u,g)=>w.post("/v1/packages/batch-update-status",{ids:u,status:g}),getResourceStats:()=>w.get("/v1/packages/stats"),category:{getCategories:u=>w.get("/v1/categories",{params:u}),getCategory:u=>w.get(`/v1/categories/${u}`),createCategory:u=>w.post("/v1/categories",u),updateCategory:(u,g)=>w.put(`/v1/categories/${u}`,g),deleteCategory:u=>w.delete(`/v1/categories/${u}`),batchDeleteCategories:u=>w.post("/v1/categories/batch-delete",{ids:u}),updateCategoryStatus:(u,g)=>w.put(`/v1/categories/${u}/status`,{enabled:g})}},Et={class:"home-container"},Pt={class:"dynamic-background"},jt={class:"floating-particles"},Nt={class:"header"},Ot={class:"header-content"},Jt={class:"search"},Kt={class:"actions"},Qt={key:1,class:"user-section"},Gt={class:"user-info"},Zt=["src"],Wt={class:"user-name"},Xt={class:"main"},Yt={class:"content-wrapper"},el={class:"main-content"},tl={class:"new-layout"},ll={class:"left-section"},sl={class:"featured-resources"},al={class:"section-header"},ol={class:"section-title"},nl={class:"featured-grid"},il=["onClick"],rl={class:"featured-cover"},dl={class:"featured-icon"},ul={class:"featured-badge"},cl={class:"featured-content"},vl={class:"featured-title"},pl={class:"featured-desc"},_l={class:"featured-meta"},fl={class:"meta-author"},ml={class:"meta-downloads"},gl={key:1,class:"featured-empty"},hl={class:"right-section"},yl={class:"resources"},wl={class:"section-header"},kl={class:"section-title"},bl={class:"section-actions"},Cl={class:"resource-count"},xl={class:"view-switcher"},zl={class:"advanced-filters"},Vl={class:"filter-row"},$l={class:"filter-group"},Dl={class:"filter-group"},Sl={class:"filter-group"},Ml={class:"filter-group"},Rl={class:"filter-actions"},Tl={class:"advanced-panel"},Il={class:"advanced-row"},Ul={class:"filter-group"},Ll={class:"filter-group"},Al={class:"filter-group"},Fl={key:0,class:"empty-state"},Bl={key:1,class:"resources-grid"},Hl=["onClick"],ql={class:"resource-icon"},El={class:"resource-content"},Pl={class:"resource-header"},jl={class:"resource-title"},Nl={class:"resource-badge"},Ol={class:"resource-desc"},Jl={class:"resource-footer"},Kl={class:"resource-meta"},Ql={class:"meta-item"},Gl={class:"meta-item"},Zl={class:"resource-actions"},Wl={key:2,class:"resources-list"},Xl=["onClick"],Yl={class:"list-icon"},es={class:"list-content"},ts={class:"list-main"},ls={class:"list-title"},ss={class:"list-desc"},as={class:"list-meta"},os={class:"list-category"},ns={class:"list-author"},is={class:"list-date"},rs={class:"list-actions"},ds={class:"download-count"},us={key:3,class:"resources-cards"},cs=["onClick"],vs={class:"card-header"},ps={class:"card-icon"},_s={class:"card-title-area"},fs={class:"card-title"},ms={class:"card-category"},gs={class:"card-desc"},hs={class:"card-footer"},ys={class:"card-meta"},ws={class:"meta-row"},ks={class:"meta-row"},bs={class:"meta-row"},Cs={key:4,class:"pagination-wrapper"},xs={class:"bottom-section"},zs={class:"notice-card"},Vs={key:0,class:"empty-notice"},$s={key:1,class:"notice-list"},Ds={class:"category-card"},Ss={class:"category-title"},Ms={class:"category-list"},Rs={class:"category-item-content"},Ts={class:"category-count"},Is=["onClick"],Us={class:"category-item-content"},Ls={class:"category-count"},As={class:"footer"},Fs={class:"footer-content"},Bs={class:"footer-sections"},Hs={class:"footer-section"},qs={class:"footer-stats"},Es={class:"stat-item"},Ps={class:"stat-number"},js={class:"stat-item"},Ns={class:"stat-number"},Os={class:"stat-item"},Js={class:"stat-number"},Ks={class:"footer-section"},Qs={class:"footer-links"},Gs={class:"footer-section"},Zs={class:"footer-links"},Ws=["onClick"],Xs={class:"footer-section"},Ys={class:"footer-contact"},ea={class:"contact-item"},ta={class:"contact-item"},la={class:"contact-item"},sa={class:"footer-bottom"},aa={class:"footer-copyright"},oa={class:"footer-legal"},na={class:"tags-container"},ia={class:"dialog-footer"},ra=_t({__name:"Home",setup(u){const g=kt(),E=f(""),T=f("all"),ge=f("latest"),he=f("all"),de=f(0),$=f(!1),ue=f(!1),ye=f(!1),we=f(0),ke=f(0),Ae=f(0),K=f(1),Q=f(4),I=f([]),G=z(()=>te()||{username:"用户"}),le=z(()=>!!te()),Fe=async()=>{try{const s=await qt();console.log("公告数据结构:",s),s.code===0&&s.data?Array.isArray(s.data)?I.value=s.data.map(e=>({id:e.id,text:e.title+": "+e.content})):s.data.list&&Array.isArray(s.data.list)?I.value=s.data.list.map(e=>({id:e.id,text:e.title+": "+e.content})):(console.warn("公告数据不是预期的数组格式:",s.data),I.value=[{id:1,text:"欢迎来到资源社区！"}]):(console.error("获取公告失败:",s.message),I.value=[{id:1,text:"欢迎来到资源社区！"},{id:2,text:"请遵守社区规范，文明发言。"},{id:3,text:"资源上传请确保无版权争议。"}])}catch(s){console.error("加载公告出错:",s),I.value=[{id:0,text:"欢迎来到资源社区！请遵守社区规范，文明发言。"}]}},Z=f([]),D=f([]),ce=z(()=>D.value.slice().sort((s,e)=>e.download_count-s.download_count).slice(0,6)),Be=z(()=>{const s=[];for(let e=0;e<ce.value.length;e+=3)s.push(ce.value.slice(e,e+3));return s}),v=ft({title:"",description:"",category:"",tags:[],tagsInput:"",file:void 0,cover:void 0}),He={title:[{required:!0,message:"请输入资源标题",trigger:"blur"},{min:2,max:50,message:"标题长度在2到50个字符",trigger:"blur"}],description:[{required:!0,message:"请输入资源描述",trigger:"blur"},{min:10,max:500,message:"描述长度在10到500个字符",trigger:"blur"}],category:[{required:!0,message:"请选择资源分类",trigger:"change"}],file:[{required:!0,message:"请选择资源文件",trigger:"change"}]},be=z(()=>{let s=D.value;if(T.value!=="all"&&(s=s.filter(e=>e.category_id===parseInt(T.value))),E.value){const e=E.value.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(e)||a.description?.toLowerCase().includes(e)||a.author.toLowerCase().includes(e))}switch(ge.value){case"latest":s.sort((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime());break;case"downloads":s.sort((e,a)=>a.download_count-e.download_count);break;case"likes":s.sort((e,a)=>(a.like_count||0)-(e.like_count||0));break;case"favorites":s.sort((e,a)=>(a.favorite_count||0)-(e.favorite_count||0));break}return s}),W=async()=>{ye.value=!0;try{const s={};T.value!=="all"&&(s.category_id=parseInt(T.value)),E.value&&(s.search=E.value),s.sort=ge.value,he.value!=="all"&&(s.type=he.value),console.log("请求参数:",s);const e=await Bt.getPackages(s);e.code===0&&e.data?(D.value=e.data.list,de.value=e.data.total,we.value=D.value.reduce((a,_)=>a+_.download_count,0),Ae.value=D.value.reduce((a,_)=>a+_.like_count,0),ke.value=Math.floor(Math.random()*1e3)+500):V.error(e.message||"加载资源失败")}catch(s){console.error("加载资源出错:",s),V.error("加载资源时发生错误")}finally{ye.value=!1}},qe=()=>{W()},se=s=>{console.log("分类切换到:",s.props.name),T.value=s.props.name,W()},ae=s=>{g.push(`/resource/${s}`)},ve=async s=>{try{const e=await Le.downloadResource(s);e.code===0?(V.success("下载统计成功"),W()):V.error(e.msg||"下载失败")}catch(e){console.error("下载失败:",e),V.error("下载失败")}},Ce=()=>{g.push("/login")},Ee=()=>{console.log("isLoggedIn:",localStorage.getItem("isLoggedIn")),console.log("userInfo:",localStorage.getItem("userInfo"));const s=te&&te();if(!s){g.push("/login");return}s.role==="admin"||s.role==="moderator"?g.push("/admin"):s.role==="elder"?g.push("/elder"):s.role==="user"?g.push("/user"):g.push("/403")},xe=()=>{const s=te();s?.role==="elder"?g.push("/elder/profile"):s?.role==="user"?g.push("/user/profile"):s?.role==="admin"?g.push("/admin/users"):g.push("/login")},Pe=async()=>{try{await Lt.confirm("确定要退出登录吗？","确认退出",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),localStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("loginTime"),localStorage.removeItem("remember_me"),localStorage.removeItem("username"),document.cookie="auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="user_info=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="remember_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",V.success("已退出登录"),g.push("/login")}catch{}},oe=s=>{if(!s)return"未分类";const e=Z.value.find(a=>a.id===s);return e?e.name:"未分类"},ne=s=>({1:"#409EFF",2:"#67C23A",3:"#E6A23C",4:"#F56C6C",5:"#909399"})[s]||"#409EFF",je=s=>s.toLocaleString(),Ne=()=>{const s=v.tagsInput?.trim();s&&s.length>0&&!v.tags.includes(s)&&(v.tags.push(s),v.tagsInput="")},Oe=s=>{const e=v.tags.indexOf(s);e>-1&&v.tags.splice(e,1)},Je=s=>{v.file=s.raw},Ke=s=>{v.cover=s.raw},Qe=async()=>{if(!v.file){V.error("请选择资源文件");return}try{ue.value=!0;const s=await Le.createResource({title:v.title,description:v.description,category:v.category,tags:v.tags,file_url:v.file_url||"",cover_url:v.cover_url});s.code===0?(V.success("资源上传成功"),$.value=!1,Object.assign(v,{title:"",description:"",category:"",tags:[],tagsInput:"",file:void 0,cover:void 0}),W()):V.error(s.msg||"上传失败")}catch(s){console.error("上传失败:",s),V.error("上传失败")}finally{ue.value=!1}},Ge=()=>{$.value=!1,Object.assign(v,{title:"",description:"",category:"",tags:[],tagsInput:"",file:void 0,cover:void 0})},Ze=async()=>{try{const s=await Ht.getCategories();s.code===0&&s.data?(Z.value=s.data.list||[],console.log("获取到的分类:",Z.value)):console.error("获取分类失败:",s.message)}catch(s){console.error("加载分类出错:",s)}};De(async()=>{await Ze(),await W(),await Fe()});const We=()=>{window.scrollTo({top:0,behavior:"smooth"})},Xe=s=>{const e=Math.random()*8+4,a=Math.random()*100,_=Math.random()*100,h=Math.random()*15,H=Math.random()*10+10;return{width:`${e}px`,height:`${e}px`,left:`${a}%`,top:`${_}%`,animationDelay:`${h}s`,animationDuration:`${H}s`}},Ye=s=>D.value.filter(e=>e.category_id===s).length,S=f("grid"),U=f(""),L=f(""),A=f(""),F=f(""),B=f(""),M=f(""),X=f("newest"),Y=f(!1),et=z(()=>U.value||L.value||A.value||F.value||B.value||M.value),tt=z(()=>Array.from(new Set(D.value.map(s=>s.author)))),ze=z(()=>{let s=be.value;if(U.value&&(s=s.filter(e=>e.author.toLowerCase().includes(U.value.toLowerCase()))),L.value&&(s=s.filter(e=>{const a=e.download_count||0;switch(L.value){case"0-10":return a>=0&&a<=10;case"11-50":return a>=11&&a<=50;case"51-100":return a>=51&&a<=100;case"100+":return a>100;default:return!0}})),A.value){const e=new Date,a=new Date,_=new Date;switch(A.value){case"today":a.setHours(0,0,0,0),_.setHours(23,59,59,999);break;case"week":a.setDate(e.getDate()-e.getDay()),_.setDate(e.getDate()+(6-e.getDay())),a.setHours(0,0,0,0),_.setHours(23,59,59,999);break;case"month":a.setDate(1),_.setMonth(e.getMonth()+1),_.setDate(0),a.setHours(0,0,0,0),_.setHours(23,59,59,999);break;case"quarter":a.setMonth(Math.floor(e.getMonth()/3)*3),_.setMonth(a.getMonth()+2),_.setDate(31),a.setDate(1),a.setHours(0,0,0,0),_.setHours(23,59,59,999);break}s=s.filter(h=>{const H=new Date(h.created_at);return H>=a&&H<=_})}if(F.value){const e=F.value.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(e)||a.description?.toLowerCase().includes(e)||a.author.toLowerCase().includes(e))}switch(B.value&&(s=s.filter(e=>{const a=e.file_size||0;switch(B.value){case"small":return a<1024*1024;case"medium":return a>=1024*1024&&a<10*1024*1024;case"large":return a>=10*1024*1024;default:return!0}})),M.value&&(M.value.split(",").map(e=>e.trim()),s=s.filter(e=>{const a=M.value.toLowerCase();return e.name.toLowerCase().includes(a)||e.description?.toLowerCase().includes(a)})),X.value){case"newest":s.sort((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime());break;case"oldest":s.sort((e,a)=>new Date(e.created_at).getTime()-new Date(a.created_at).getTime());break;case"most_downloaded":s.sort((e,a)=>a.download_count-e.download_count);break;case"least_downloaded":s.sort((e,a)=>e.download_count-a.download_count);break;case"name_asc":s.sort((e,a)=>e.name.localeCompare(a.name));break;case"name_desc":s.sort((e,a)=>a.name.localeCompare(e.name));break}return s}),Ve=z(()=>ze.value),pe=z(()=>{const s=ze.value,e=(K.value-1)*Q.value,a=e+Q.value;return s.slice(e,a)}),lt=()=>{U.value="",L.value="",A.value="",F.value="",B.value="",M.value="",X.value="newest",Y.value=!1,K.value=1};mt([U,L,A,F,B,M,X],()=>{K.value=1});const st=()=>{Y.value=!Y.value},ie=()=>{bt(()=>{const s=document.querySelector(".home-container"),e=document.querySelector(".dynamic-background"),a=document.querySelector(".gradient-layer");if(s&&e&&a){const _=s.scrollHeight,h=Math.max(_,window.innerHeight);e.style.height=`${h}px`,a.style.height=`${h}px`}})};return De(()=>{ie(),window.addEventListener("resize",ie);const s=new MutationObserver(ie),e=document.querySelector(".home-container");e&&s.observe(e,{childList:!0,subtree:!0,attributes:!0})}),gt(()=>{ie()}),(s,e)=>{const a=y("el-icon"),_=y("el-input"),h=y("el-button"),H=y("el-avatar"),_e=y("el-dropdown-item"),at=y("el-dropdown-menu"),ot=y("el-dropdown"),nt=y("el-carousel-item"),it=y("el-carousel"),rt=y("el-button-group"),p=y("el-option"),P=y("el-select"),dt=y("el-collapse-transition"),ut=y("el-pagination"),j=y("el-form-item"),ct=y("el-tag"),$e=y("el-upload"),vt=y("el-form"),pt=y("el-dialog");return r(),c("div",Et,[t("div",Pt,[e[28]||(e[28]=fe('<div class="gradient-layer" data-v-90a59961></div><div class="geometric-shapes" data-v-90a59961><div class="shape triangle-1" data-v-90a59961></div><div class="shape triangle-2" data-v-90a59961></div><div class="shape circle-1" data-v-90a59961></div><div class="shape circle-2" data-v-90a59961></div><div class="shape square-1" data-v-90a59961></div><div class="shape circle-3" data-v-90a59961></div><div class="shape triangle-3" data-v-90a59961></div><div class="shape square-2" data-v-90a59961></div></div>',2)),t("div",jt,[(r(),c(b,null,C(20,o=>t("div",{class:"particle",key:o,style:ht(Xe())},null,4)),64))]),e[29]||(e[29]=fe('<div class="ripple-effects" data-v-90a59961><div class="ripple ripple-1" data-v-90a59961></div><div class="ripple ripple-2" data-v-90a59961></div><div class="ripple ripple-3" data-v-90a59961></div><div class="ripple ripple-4" data-v-90a59961></div><div class="ripple ripple-5" data-v-90a59961></div></div>',1))]),t("header",Nt,[t("div",Ot,[e[34]||(e[34]=t("div",{class:"logo"},[t("div",{class:"logo-icon"},"📚"),t("div",{class:"logo-text"},[t("h1",null,"资源社区"),t("p",null,"分享、发现、学习")])],-1)),t("div",Jt,[l(_,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=o=>E.value=o),placeholder:"搜索资源...",size:"large",clearable:"",onKeyup:Se(qe,["enter"])},{prefix:n(()=>[l(a,null,{default:n(()=>[l(i(Re))]),_:1})]),_:1},8,["modelValue"])]),t("div",Kt,[l(At),le.value?N("",!0):(r(),q(h,{key:0,type:"primary",size:"large",onClick:Ce},{default:n(()=>[l(a,null,{default:n(()=>[l(i(O))]),_:1}),e[30]||(e[30]=m(" 登录 "))]),_:1,__:[30]})),le.value?(r(),c("div",Qt,[l(ot,{trigger:"click",placement:"bottom-end"},{dropdown:n(()=>[l(at,{class:"user-dropdown"},{default:n(()=>[l(_e,{onClick:xe},{default:n(()=>[l(a,null,{default:n(()=>[l(i(O))]),_:1}),e[31]||(e[31]=m(" 个人资料 "))]),_:1,__:[31]}),l(_e,{onClick:Ee},{default:n(()=>[l(a,null,{default:n(()=>[l(i(xt))]),_:1}),e[32]||(e[32]=m(" 管理后台 "))]),_:1,__:[32]}),l(_e,{divided:"",onClick:Pe},{default:n(()=>[l(a,null,{default:n(()=>[l(i(zt))]),_:1}),e[33]||(e[33]=m(" 退出登录 "))]),_:1,__:[33]})]),_:1})]),default:n(()=>[t("div",Gt,[G.value.avatar_url?(r(),q(H,{key:0,size:32,class:"user-avatar",src:G.value.avatar_url},{default:n(()=>[t("img",{src:G.value.avatar_url},null,8,Zt)]),_:1},8,["src"])):(r(),q(H,{key:1,size:32,class:"user-avatar"},{default:n(()=>[l(a,null,{default:n(()=>[l(i(O))]),_:1})]),_:1})),t("span",Wt,d(G.value.nickname||G.value.username),1),l(a,{class:"dropdown-icon"},{default:n(()=>[l(i(Ct))]),_:1})])]),_:1})])):N("",!0)])])]),t("main",Xt,[t("div",Yt,[t("div",el,[t("div",tl,[t("div",ll,[t("div",sl,[t("div",al,[t("h2",ol,[l(a,null,{default:n(()=>[l(i(Vt))]),_:1}),e[35]||(e[35]=m(" 精选资源 "))]),e[36]||(e[36]=t("p",{class:"section-subtitle"},"发现社区最受欢迎的优质资源",-1))]),ce.value.length>0?(r(),q(it,{key:0,interval:5e3,arrow:D.value.length>1?"hover":"never","indicator-position":"outside",class:"resource-carousel",height:"280px"},{default:n(()=>[(r(!0),c(b,null,C(Be.value,(o,x)=>(r(),q(nt,{key:x,class:"carousel-item"},{default:n(()=>[t("div",nl,[(r(!0),c(b,null,C(o,R=>(r(),c("div",{key:R.id,class:"featured-card",onClick:da=>ae(R.id)},[t("div",rl,[t("div",dl,[l(a,{size:"32",color:ne(R.category_id)},{default:n(()=>[l(i(J))]),_:2},1032,["color"])]),t("div",ul,d(oe(R.category_id)),1)]),t("div",cl,[t("h3",vl,d(R.name),1),t("p",pl,d(R.description),1),t("div",_l,[t("span",fl,[l(a,null,{default:n(()=>[l(i(O))]),_:1}),m(" "+d(R.author),1)]),t("span",ml,[l(a,null,{default:n(()=>[l(i(ee))]),_:1}),m(" "+d(R.download_count),1)])])])],8,il))),128))])]),_:2},1024))),128))]),_:1},8,["arrow"])):(r(),c("div",gl,[e[38]||(e[38]=t("div",{class:"empty-icon"},"⭐",-1)),e[39]||(e[39]=t("h3",null,"暂无精选资源",-1)),e[40]||(e[40]=t("p",null,"快来上传优质资源，成为精选内容吧！",-1)),l(h,{type:"primary",onClick:e[1]||(e[1]=o=>$.value=!0)},{default:n(()=>[l(a,null,{default:n(()=>[l(i(re))]),_:1}),e[37]||(e[37]=m(" 上传资源 "))]),_:1,__:[37]})]))])]),t("div",hl,[t("div",yl,[t("div",wl,[t("h2",kl,[l(a,null,{default:n(()=>[l(i(Te))]),_:1}),e[41]||(e[41]=m(" 全部资源 "))]),t("div",bl,[t("span",Cl,"共 "+d(be.value.length)+" 个资源",1),t("div",xl,[l(rt,null,{default:n(()=>[l(h,{type:S.value==="grid"?"primary":"default",size:"small",onClick:e[2]||(e[2]=o=>S.value="grid")},{default:n(()=>[l(a,null,{default:n(()=>[l(i(Ie))]),_:1})]),_:1},8,["type"]),l(h,{type:S.value==="list"?"primary":"default",size:"small",onClick:e[3]||(e[3]=o=>S.value="list")},{default:n(()=>[l(a,null,{default:n(()=>[l(i($t))]),_:1})]),_:1},8,["type"]),l(h,{type:S.value==="card"?"primary":"default",size:"small",onClick:e[4]||(e[4]=o=>S.value="card")},{default:n(()=>[l(a,null,{default:n(()=>[l(i(J))]),_:1})]),_:1},8,["type"])]),_:1})]),l(h,{type:"primary",size:"default",onClick:e[5]||(e[5]=o=>$.value=!0)},{default:n(()=>[l(a,null,{default:n(()=>[l(i(re))]),_:1}),e[42]||(e[42]=m(" 上传资源 "))]),_:1,__:[42]})])]),t("div",zl,[t("div",Vl,[t("div",$l,[e[43]||(e[43]=t("label",{class:"filter-label"},"作者",-1)),l(P,{modelValue:U.value,"onUpdate:modelValue":e[6]||(e[6]=o=>U.value=o),placeholder:"选择作者",clearable:"",size:"small",class:"filter-input"},{default:n(()=>[l(p,{label:"全部作者",value:""}),(r(!0),c(b,null,C(tt.value,o=>(r(),q(p,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",Dl,[e[44]||(e[44]=t("label",{class:"filter-label"},"下载量",-1)),l(P,{modelValue:L.value,"onUpdate:modelValue":e[7]||(e[7]=o=>L.value=o),placeholder:"下载量范围",clearable:"",size:"small",class:"filter-input"},{default:n(()=>[l(p,{label:"全部",value:""}),l(p,{label:"0-10次",value:"0-10"}),l(p,{label:"11-50次",value:"11-50"}),l(p,{label:"51-100次",value:"51-100"}),l(p,{label:"100次以上",value:"100+"})]),_:1},8,["modelValue"])]),t("div",Sl,[e[45]||(e[45]=t("label",{class:"filter-label"},"上传时间",-1)),l(P,{modelValue:A.value,"onUpdate:modelValue":e[8]||(e[8]=o=>A.value=o),placeholder:"时间范围",clearable:"",size:"small",class:"filter-input"},{default:n(()=>[l(p,{label:"全部时间",value:""}),l(p,{label:"今天",value:"today"}),l(p,{label:"本周",value:"week"}),l(p,{label:"本月",value:"month"}),l(p,{label:"三个月内",value:"quarter"})]),_:1},8,["modelValue"])]),t("div",Ml,[e[46]||(e[46]=t("label",{class:"filter-label"},"关键词",-1)),l(_,{modelValue:F.value,"onUpdate:modelValue":e[9]||(e[9]=o=>F.value=o),placeholder:"搜索关键词",clearable:"",size:"small",class:"filter-input"},{prefix:n(()=>[l(a,null,{default:n(()=>[l(i(Re))]),_:1})]),_:1},8,["modelValue"])]),t("div",Rl,[l(h,{size:"small",onClick:lt,disabled:!et.value},{default:n(()=>[l(a,null,{default:n(()=>[l(i(Dt))]),_:1}),e[47]||(e[47]=m(" 重置 "))]),_:1,__:[47]},8,["disabled"]),l(h,{type:"primary",size:"small",onClick:st},{default:n(()=>[l(a,null,{default:n(()=>[l(i(St))]),_:1}),m(" "+d(Y.value?"收起":"高级"),1)]),_:1})])]),l(dt,null,{default:n(()=>[yt(t("div",Tl,[t("div",Il,[t("div",Ul,[e[48]||(e[48]=t("label",{class:"filter-label"},"文件大小",-1)),l(P,{modelValue:B.value,"onUpdate:modelValue":e[10]||(e[10]=o=>B.value=o),placeholder:"文件大小",clearable:"",size:"small",class:"filter-input"},{default:n(()=>[l(p,{label:"全部大小",value:""}),l(p,{label:"小于1MB",value:"small"}),l(p,{label:"1MB-10MB",value:"medium"}),l(p,{label:"大于10MB",value:"large"})]),_:1},8,["modelValue"])]),t("div",Ll,[e[49]||(e[49]=t("label",{class:"filter-label"},"标签",-1)),l(_,{modelValue:M.value,"onUpdate:modelValue":e[11]||(e[11]=o=>M.value=o),placeholder:"搜索标签",clearable:"",size:"small",class:"filter-input"},{prefix:n(()=>[l(a,null,{default:n(()=>[l(i(Mt))]),_:1})]),_:1},8,["modelValue"])]),t("div",Al,[e[50]||(e[50]=t("label",{class:"filter-label"},"排序方式",-1)),l(P,{modelValue:X.value,"onUpdate:modelValue":e[12]||(e[12]=o=>X.value=o),placeholder:"排序方式",size:"small",class:"filter-input"},{default:n(()=>[l(p,{label:"最新上传",value:"newest"}),l(p,{label:"最早上传",value:"oldest"}),l(p,{label:"下载最多",value:"most_downloaded"}),l(p,{label:"下载最少",value:"least_downloaded"}),l(p,{label:"名称A-Z",value:"name_asc"}),l(p,{label:"名称Z-A",value:"name_desc"})]),_:1},8,["modelValue"])])])],512),[[wt,Y.value]])]),_:1})]),D.value.length===0?(r(),c("div",Fl,[e[52]||(e[52]=t("div",{class:"empty-icon"},"📦",-1)),e[53]||(e[53]=t("h3",null,"暂无资源",-1)),e[54]||(e[54]=t("p",null,"还没有资源被上传，快来分享你的第一个资源吧！",-1)),l(h,{type:"primary",onClick:e[13]||(e[13]=o=>$.value=!0)},{default:n(()=>[l(a,null,{default:n(()=>[l(i(re))]),_:1}),e[51]||(e[51]=m(" 上传资源 "))]),_:1,__:[51]})])):S.value==="grid"?(r(),c("div",Bl,[(r(!0),c(b,null,C(pe.value,o=>(r(),c("div",{key:o.id,class:"resource-card",onClick:x=>ae(o.id)},[t("div",ql,[l(a,{size:"28",color:ne(o.category_id)},{default:n(()=>[l(i(J))]),_:2},1032,["color"])]),t("div",El,[t("div",Pl,[t("h3",jl,d(o.name),1),t("span",Nl,d(oe(o.category_id)),1)]),t("p",Ol,d(o.description),1),t("div",Jl,[t("div",Kl,[t("span",Ql,[l(a,null,{default:n(()=>[l(i(O))]),_:1}),m(" "+d(o.author),1)]),t("span",Gl,[l(a,null,{default:n(()=>[l(i(Ue))]),_:1}),m(" "+d(i(me)(o.created_at)),1)])]),t("div",Zl,[l(h,{type:"primary",size:"small",onClick:k(x=>ve(o.id),["stop"])},{default:n(()=>[l(a,null,{default:n(()=>[l(i(ee))]),_:1}),e[55]||(e[55]=m(" 下载 "))]),_:2,__:[55]},1032,["onClick"])])])])],8,Hl))),128))])):S.value==="list"?(r(),c("div",Wl,[(r(!0),c(b,null,C(pe.value,o=>(r(),c("div",{key:o.id,class:"resource-list-item",onClick:x=>ae(o.id)},[t("div",Yl,[l(a,{size:"24",color:ne(o.category_id)},{default:n(()=>[l(i(J))]),_:2},1032,["color"])]),t("div",es,[t("div",ts,[t("h3",ls,d(o.name),1),t("p",ss,d(o.description),1)]),t("div",as,[t("span",os,d(oe(o.category_id)),1),t("span",ns,d(o.author),1),t("span",is,d(i(me)(o.created_at)),1)])]),t("div",rs,[t("span",ds,[l(a,null,{default:n(()=>[l(i(ee))]),_:1}),m(" "+d(o.download_count),1)]),l(h,{type:"primary",size:"small",onClick:k(x=>ve(o.id),["stop"])},{default:n(()=>e[56]||(e[56]=[m(" 下载 ")])),_:2,__:[56]},1032,["onClick"])])],8,Xl))),128))])):S.value==="card"?(r(),c("div",us,[(r(!0),c(b,null,C(pe.value,o=>(r(),c("div",{key:o.id,class:"resource-card-item",onClick:x=>ae(o.id)},[t("div",vs,[t("div",ps,[l(a,{size:"32",color:ne(o.category_id)},{default:n(()=>[l(i(J))]),_:2},1032,["color"])]),t("div",_s,[t("h3",fs,d(o.name),1),t("span",ms,d(oe(o.category_id)),1)])]),t("p",gs,d(o.description),1),t("div",hs,[t("div",ys,[t("div",ws,[l(a,null,{default:n(()=>[l(i(O))]),_:1}),t("span",null,d(o.author),1)]),t("div",ks,[l(a,null,{default:n(()=>[l(i(Ue))]),_:1}),t("span",null,d(i(me)(o.created_at)),1)]),t("div",bs,[l(a,null,{default:n(()=>[l(i(ee))]),_:1}),t("span",null,d(o.download_count)+" 次下载",1)])]),l(h,{type:"primary",onClick:k(x=>ve(o.id),["stop"])},{default:n(()=>[l(a,null,{default:n(()=>[l(i(ee))]),_:1}),e[57]||(e[57]=m(" 下载资源 "))]),_:2,__:[57]},1032,["onClick"])])],8,cs))),128))])):N("",!0),Ve.value.length>Q.value?(r(),c("div",Cs,[l(ut,{"current-page":K.value,"onUpdate:currentPage":e[14]||(e[14]=o=>K.value=o),"page-size":Q.value,"onUpdate:pageSize":e[15]||(e[15]=o=>Q.value=o),"page-sizes":[4,8,12,16],total:Ve.value.length,layout:"total, sizes, prev, pager, next, jumper",class:"resource-pagination",background:""},null,8,["current-page","page-size","total"])])):N("",!0)])]),t("div",xs,[t("div",zs,[e[59]||(e[59]=t("h3",{class:"notice-title"},"社区公告",-1)),I.value.length===0?(r(),c("div",Vs,e[58]||(e[58]=[t("p",null,"暂无公告信息",-1)]))):(r(),c("ul",$s,[(r(!0),c(b,null,C(I.value,o=>(r(),c("li",{key:o.id,class:"notice-item"},d(o.text),1))),128))]))]),t("div",Ds,[t("h3",Ss,[l(a,null,{default:n(()=>[l(i(Te))]),_:1}),e[60]||(e[60]=m(" 资源分类 "))]),t("div",Ms,[t("div",{class:Me(["category-item",{active:T.value==="all"}]),onClick:e[16]||(e[16]=o=>se({props:{name:"all"}}))},[t("div",Rs,[l(a,null,{default:n(()=>[l(i(Ie))]),_:1}),e[61]||(e[61]=t("span",null,"全部",-1))]),t("span",Ts,d(de.value),1)],2),(r(!0),c(b,null,C(Z.value,o=>(r(),c("div",{key:o.id,class:Me(["category-item",{active:T.value===o.id.toString()}]),onClick:x=>se({props:{name:o.id.toString()}})},[t("div",Us,[l(a,null,{default:n(()=>[l(i(J))]),_:1}),t("span",null,d(o.name),1)]),t("span",Ls,d(Ye(o.id)),1)],10,Is))),128))])])])])])])]),t("footer",As,[t("div",Fs,[t("div",Bs,[t("div",Hs,[e[65]||(e[65]=t("div",{class:"footer-logo"},[t("div",{class:"footer-logo-icon"},"📚"),t("div",{class:"footer-logo-text"},[t("h3",null,"资源社区"),t("p",null,"分享、发现、学习")])],-1)),e[66]||(e[66]=t("p",{class:"footer-desc"}," 一个致力于知识分享和资源交流的开放平台，汇聚优质学习资源，助力每个人的成长之路。 ",-1)),t("div",qs,[t("div",Es,[t("span",Ps,d(de.value),1),e[62]||(e[62]=t("span",{class:"stat-label"},"资源",-1))]),t("div",js,[t("span",Ns,d(ke.value),1),e[63]||(e[63]=t("span",{class:"stat-label"},"用户",-1))]),t("div",Os,[t("span",Js,d(je(we.value)),1),e[64]||(e[64]=t("span",{class:"stat-label"},"下载",-1))])])]),t("div",Ks,[e[67]||(e[67]=t("h4",{class:"footer-title"},"快速链接",-1)),t("ul",Qs,[t("li",null,[t("a",{href:"#",onClick:k(We,["prevent"])},"回到顶部")]),t("li",null,[t("a",{href:"#",onClick:e[17]||(e[17]=k(o=>se({props:{name:"all"}}),["prevent"]))},"全部资源")]),t("li",null,[t("a",{href:"#",onClick:e[18]||(e[18]=k(o=>$.value=!0,["prevent"]))},"上传资源")]),t("li",null,[le.value?N("",!0):(r(),c("a",{key:0,href:"#",onClick:k(Ce,["prevent"])},"用户登录"))]),t("li",null,[le.value?(r(),c("a",{key:0,href:"#",onClick:k(xe,["prevent"])},"个人中心")):N("",!0)])])]),t("div",Gs,[e[68]||(e[68]=t("h4",{class:"footer-title"},"资源分类",-1)),t("ul",Zs,[(r(!0),c(b,null,C(Z.value.slice(0,5),o=>(r(),c("li",{key:o.id},[t("a",{href:"#",onClick:k(x=>se({props:{name:o.id.toString()}}),["prevent"])},d(o.name),9,Ws)]))),128))])]),t("div",Xs,[e[72]||(e[72]=t("h4",{class:"footer-title"},"联系我们",-1)),t("div",Ys,[t("div",ea,[l(a,null,{default:n(()=>[l(i(Rt))]),_:1}),e[69]||(e[69]=t("span",null,"support@example.com",-1))]),t("div",ta,[l(a,null,{default:n(()=>[l(i(Tt))]),_:1}),e[70]||(e[70]=t("span",null,"400-123-4567",-1))]),t("div",la,[l(a,null,{default:n(()=>[l(i(It))]),_:1}),e[71]||(e[71]=t("span",null,"北京市朝阳区",-1))])]),e[73]||(e[73]=fe('<div class="social-links" data-v-90a59961><a href="#" class="social-link" title="微信" data-v-90a59961><span data-v-90a59961>💬</span></a><a href="#" class="social-link" title="QQ" data-v-90a59961><span data-v-90a59961>🐧</span></a><a href="#" class="social-link" title="GitHub" data-v-90a59961><span data-v-90a59961>⚡</span></a><a href="#" class="social-link" title="邮箱" data-v-90a59961><span data-v-90a59961>📧</span></a></div>',1))])]),t("div",sa,[t("div",aa,[t("p",null,"© "+d(new Date().getFullYear())+" 资源社区. All rights reserved.",1),e[74]||(e[74]=t("p",null,"Built with ❤️ using Vue 3 + Rust",-1))]),t("div",oa,[t("a",{href:"#",onClick:e[19]||(e[19]=k(()=>{},["prevent"]))},"隐私政策"),e[75]||(e[75]=t("span",{class:"divider"},"|",-1)),t("a",{href:"#",onClick:e[20]||(e[20]=k(()=>{},["prevent"]))},"服务条款"),e[76]||(e[76]=t("span",{class:"divider"},"|",-1)),t("a",{href:"#",onClick:e[21]||(e[21]=k(()=>{},["prevent"]))},"帮助中心")])])])]),l(pt,{modelValue:$.value,"onUpdate:modelValue":e[27]||(e[27]=o=>$.value=o),title:"上传资源",width:"600px","before-close":Ge,"destroy-on-close":""},{footer:n(()=>[t("span",ia,[l(h,{onClick:e[26]||(e[26]=o=>$.value=!1),size:"large"},{default:n(()=>e[81]||(e[81]=[m("取消")])),_:1,__:[81]}),l(h,{type:"primary",onClick:Qe,loading:ue.value,size:"large"},{default:n(()=>e[82]||(e[82]=[m(" 上传资源 ")])),_:1,__:[82]},8,["loading"])])]),default:n(()=>[l(vt,{model:v,rules:He,ref:"uploadFormRef","label-width":"100px",size:"large"},{default:n(()=>[l(j,{label:"资源标题",prop:"title"},{default:n(()=>[l(_,{modelValue:v.title,"onUpdate:modelValue":e[22]||(e[22]=o=>v.title=o),placeholder:"请输入资源标题",clearable:""},null,8,["modelValue"])]),_:1}),l(j,{label:"资源描述",prop:"description"},{default:n(()=>[l(_,{modelValue:v.description,"onUpdate:modelValue":e[23]||(e[23]=o=>v.description=o),type:"textarea",rows:4,placeholder:"请输入资源描述","show-word-limit":"",maxlength:"500"},null,8,["modelValue"])]),_:1}),l(j,{label:"资源分类",prop:"category"},{default:n(()=>[l(P,{modelValue:v.category,"onUpdate:modelValue":e[24]||(e[24]=o=>v.category=o),placeholder:"选择分类",style:{width:"100%"}},{default:n(()=>[l(p,{label:"教程",value:"tutorial"}),l(p,{label:"工具",value:"tool"}),l(p,{label:"模板",value:"template"}),l(p,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),l(j,{label:"资源标签"},{default:n(()=>[l(_,{modelValue:v.tagsInput,"onUpdate:modelValue":e[25]||(e[25]=o=>v.tagsInput=o),placeholder:"输入标签，用逗号分隔",onKeyup:Se(Ne,["enter"]),clearable:""},null,8,["modelValue"]),t("div",na,[(r(!0),c(b,null,C(v.tags,o=>(r(),q(ct,{key:o,closable:"",onClose:x=>Oe(o),effect:"light"},{default:n(()=>[m(d(o),1)]),_:2},1032,["onClose"]))),128))])]),_:1}),l(j,{label:"资源文件",prop:"file"},{default:n(()=>[l($e,{ref:"uploadRef","auto-upload":!1,"on-change":Je,limit:1,accept:".zip,.rar,.7z,.pdf,.doc,.docx",drag:""},{tip:n(()=>e[77]||(e[77]=[t("div",{class:"el-upload__tip"}," 支持 zip, rar, 7z, pdf, doc, docx 格式，文件大小不超过100MB ",-1)])),default:n(()=>[l(a,{class:"el-icon--upload"},{default:n(()=>[l(i(re))]),_:1}),e[78]||(e[78]=t("div",{class:"el-upload__text"},[m(" 将文件拖到此处，或"),t("em",null,"点击上传")],-1))]),_:1,__:[78]},512)]),_:1}),l(j,{label:"封面图片"},{default:n(()=>[l($e,{ref:"coverUploadRef","auto-upload":!1,"on-change":Ke,limit:1,accept:"image/*",drag:""},{tip:n(()=>e[79]||(e[79]=[t("div",{class:"el-upload__tip"}," 支持 jpg, png, gif 格式，建议尺寸 300x200 ",-1)])),default:n(()=>[l(a,{class:"el-icon--upload"},{default:n(()=>[l(i(Ut))]),_:1}),e[80]||(e[80]=t("div",{class:"el-upload__text"},[m(" 将图片拖到此处，或"),t("em",null,"点击上传")],-1))]),_:1,__:[80]},512)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ya=Ft(ra,[["__scopeId","data-v-90a59961"]]);export{ya as default};
