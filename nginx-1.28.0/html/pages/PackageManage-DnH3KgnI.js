import{x as Xe,r as c,c as Ye,j as ea,y as D,A as n,Q as a,I as o,u as V,al as y,M as i,O as f,P as Q,a6 as q,H as x,J as aa,ar as la,K as N,a4 as ye,w as be,z as b}from"../chunks/vue-vendor-BleHOoLr.js";import{b as Ve,z as we,L as ta,c as oa,F as sa,u as ua,H as na,D as da,f as ke,Z as Ce,U as he,aa as ia,K as r,E as xe}from"../chunks/element-plus-Cc1YNc_4.js";import{a as J,u as ie,r as Y,_ as ra}from"../assets/index-B_N-aWSj.js";import{p as j}from"../chunks/packages-DTwnlaPG.js";import{c as ee}from"../chunks/categories-BGQr79qD.js";import{c as va}from"../chunks/posts-B23axQf4.js";import"../chunks/utils-Dq7h7Pqt.js";const ae={get:M=>J.get(`/v1/cache/${M}`),set:(M,U,z)=>J.post("/v1/cache",{key:M,value:U,ttl:z}),delete:M=>J.delete(`/v1/cache/${M}`),clear:()=>J.delete("/v1/cache"),getStats:()=>J.get("/v1/cache/stats")},pa={class:"package-manage-desktop"},ca={class:"page-header"},ma={class:"header-content"},fa={class:"header-left"},ga={class:"header-icon"},_a={class:"header-actions"},ya={class:"stats-section"},ba={class:"stats-grid"},Va={class:"stat-card"},wa={class:"stat-icon"},ka={class:"stat-content"},Ca={class:"stat-number"},ha={class:"stat-card"},xa={class:"stat-icon"},Ua={class:"stat-content"},Pa={class:"stat-number"},Ia={class:"stat-card"},$a={class:"stat-icon"},Da={class:"stat-content"},za={class:"stat-number"},Ta={class:"stat-card"},Aa={class:"stat-icon"},Sa={class:"stat-content"},Ma={class:"stat-number"},Ba={class:"search-section"},Ea={class:"search-left"},La={class:"search-right"},Na={class:"table-section"},ja={class:"pagination-section"},Ka={key:0,class:"package-detail"},Fa={class:"detail-header"},Ra=["href"],Ha={class:"detail-actions"},Oa={class:"tags-container"},Qa={key:0,class:"tags-display"},qa={class:"category-management"},Ja={class:"category-header"},Wa=Xe({__name:"PackageManage",setup(M){const U=c(""),z=c(""),K=c(""),le=c(!1),W=c(1),te=c(20),F=c(!1),B=c(!1),R=c(!1),oe=c(!1),H=c(!1),O=c(!1),_=c(null),h=c([]),Z=c(0),se=c(0),ue=c(0),ne=c(0),T=c([]),s=c({type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""}),C=c({name:"",description:"",enabled:!0}),u=c({id:0,name:"",author:"",version:"",category_id:void 0,status:"",description:"",url:"",tags:[],tagsInput:"",is_pinned:!1,is_featured:!1}),k=c({id:0,name:"",description:"",enabled:!0}),Ue=Ye(()=>{let l=h.value;return U.value&&(l=l.filter(e=>e.name.toLowerCase().includes(U.value.toLowerCase())||e.author.toLowerCase().includes(U.value.toLowerCase()))),K.value&&(l=l.filter(e=>e.type===K.value)),l}),Pe=async l=>{try{const e=await j.getPackage(l);if(e.code===0&&e.data){const d=h.value.findIndex(v=>v.id===l);d!==-1&&(h.value[d].downloads=e.data.download_count,de())}}catch(e){console.error("刷新下载计数失败:",e)}};function Ie(){be([z,K],()=>{I()}),be(()=>h.value,()=>{de()},{deep:!0})}async function I(){try{le.value=!0,ae.delete("getPackages");const l={};z.value&&(l.status=z.value),U.value&&(l.search=U.value);const e=await j.getPackages(l);e.code===0&&e.data?(h.value=e.data.list?.map(d=>{let v="未分类";if(d.category_id){const g=T.value.find(m=>m.id===d.category_id);g&&(v=g.name)}return{id:d.id,name:d.name,author:d.author,version:d.version||"",category_id:d.category_id,type:v,status:d.status||"Active",description:d.description||"",downloads:d.download_count,uploadTime:d.created_at,lastUpdate:d.updated_at,url:d.file_url||""}})||[],console.log("处理后的绳包数据:",h.value),de()):r.error("获取绳包数据失败")}catch(l){console.error("获取绳包数据错误:",l),r.error("获取绳包数据失败")}finally{le.value=!1}}function de(){Z.value=h.value.length,se.value=h.value.filter(e=>e.status==="正常"||e.status==="Active"||e.status==="已发布").length,ue.value=h.value.filter(e=>e.status==="待审核"||e.status==="Inactive").length;const l=new Set(h.value.map(e=>e.author));ne.value=l.size,console.log("统计数据更新:",{总资源数:Z.value,已发布:se.value,待审核:ue.value,活跃用户:ne.value})}async function P(){try{ae.delete("getCategories");const l=await ee.getCategories();l.code===0&&l.data?(T.value=l.data.list||[],console.log("获取到的分类数据:",T.value)):r.error("获取分类数据失败")}catch(l){console.error("获取分类数据错误:",l),r.error("获取分类数据失败")}}function $e(){I()}async function De(){ae.delete("getPackages"),ae.delete("getCategories"),await Promise.all([I(),P()]),r.success("数据已刷新")}function ze(){B.value=!0}const Te=l=>{_.value=l,F.value=!0,ie.logView("Package",l.id,`管理员查看绳包详情: ${l.name}`).catch(e=>console.error("记录查看行为失败:",e))},re=async l=>{try{if(l.status!=="正常"&&l.status!=="Active"){r.warning(`资源 ${l.name} 状态不为正常，无法下载`);return}if(!l.url||l.url.trim()===""){r.warning(`资源 ${l.name} 没有项目链接，无法下载`);return}const e=await j.downloadPackage(l.id);e.code!==0&&console.warn("增加下载计数失败:",e.message),await Y.logDownload(l.id),window.open(l.url,"_blank"),r.success(`开始下载 ${l.name}`),setTimeout(()=>{Pe(l.id)},500)}catch(e){console.error("下载错误:",e),r.error("下载失败")}};function Ae(l){u.value={id:l.id,name:l.name,author:l.author,version:l.version,category_id:l.category_id?Number(l.category_id):void 0,status:l.status||"Active",description:l.description,url:l.url,tags:l.tags||[],tagsInput:(l.tags||[]).join(", "),is_pinned:l.is_pinned||!1,is_featured:l.is_featured||!1},R.value=!0,ie.logAction("EditPackage",`管理员打开编辑绳包: ${l.name}`,"Package",l.id).catch(e=>console.error("记录编辑行为失败:",e))}async function Se(){try{if(!u.value.name.trim()){r.error("请输入绳包名称");return}if(!u.value.author.trim()){r.error("请输入作者");return}if(!u.value.description.trim()){r.error("请输入描述");return}if(!u.value.url.trim()){r.error("请输入项目链接");return}let l="Active";switch(u.value.status){case"正常":case"已发布":l="Active";break;case"待审核":case"维护中":l="Inactive";break;case"已拒绝":l="Deleted";break}const e={name:u.value.name,version:u.value.version,description:u.value.description,category_id:u.value.category_id,status:l,file_url:u.value.url,tags:u.value.tags,is_pinned:u.value.is_pinned,is_featured:u.value.is_featured};console.log("更新绳包数据:",e);const d=await j.updatePackage(u.value.id,e);d.code===0?(r.success("绳包更新成功"),R.value=!1,setTimeout(async()=>{await P(),await I()},500)):r.error(d.message||"更新失败")}catch(l){console.error("更新绳包错误:",l),r.error("更新失败")}}const Me=()=>{if(u.value.tagsInput){const l=u.value.tagsInput.split(",").map(e=>e.trim()).filter(e=>e);u.value.tags=l}else u.value.tags=[]},Be=l=>{u.value.tags&&(u.value.tags=u.value.tags.filter(e=>e!==l),u.value.tagsInput=u.value.tags.join(", "))};async function Ee(l){try{await xe.confirm(`确定要删除绳包 ${l.name} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e={id:l.id,name:l.name,author:l.author},d=await j.deletePackage(l.id);d.code===0?(r.success("绳包已删除"),setTimeout(async()=>{await I(),await P()},500)):r.error(d.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除绳包错误:",e),r.error("删除失败"))}}function Le(){const l=s.value.tagsInput?.trim();l&&l.length>0&&!s.value.tags.includes(l)&&(s.value.tags.push(l),s.value.tagsInput="")}function Ne(){const l=u.value.tagsInput?.trim();l&&l.length>0&&!u.value.tags.includes(l)&&(u.value.tags.push(l),u.value.tagsInput="")}function je(l){const e=s.value.tags.indexOf(l);e>-1&&s.value.tags.splice(e,1)}async function Ke(){try{if(!s.value.name.trim()){r.error("请输入标题");return}if(!s.value.description.trim()){r.error("请输入内容");return}if(s.value.type==="package"){if(!s.value.author.trim()){r.error("请输入作者");return}if(!s.value.url.trim()){r.error("请输入项目链接");return}const l={name:s.value.name,author:s.value.author,version:s.value.version,description:s.value.description,category_id:s.value.category_id,file_url:s.value.url,tags:s.value.tags,is_pinned:!1,is_featured:!1};console.log("创建资源数据:",l);const e=await j.adminCreatePackage(l);e.code===0?(r.success("资源添加成功"),ie.logUpload("Package",e.data?.id||0,`管理员创建资源: ${l.name}`),B.value=!1,s.value={type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""},setTimeout(async()=>{await P(),await I()},500)):r.error(e.msg||"添加失败")}else{const l=await va({title:s.value.name,content:s.value.description,category_id:s.value.category_id,tags:s.value.tags,status:"Published"});l.code===0?(r.success("帖子发布成功"),B.value=!1,s.value={type:"package",name:"",author:"",version:"1.0.0",category_id:void 0,status:"正常",description:"",url:"",tags:[],tagsInput:""},setTimeout(async()=>{await P(),await I()},500)):r.error(l.msg||"发布失败")}}catch(l){console.error("添加内容错误:",l),r.error(s.value.type==="package"?"添加失败":"发布失败")}}async function Fe(){try{if(!C.value.name.trim()){r.error("请输入分类名称");return}const l=await ee.addCategory({name:C.value.name,description:C.value.description,enabled:C.value.enabled});l.code===0?(r.success("分类添加成功"),l.data&&l.data.id&&await Y.logCreate(l.data.id,"Category"),H.value=!1,C.value={name:"",description:"",enabled:!0},await P()):r.error(l.message||"添加分类失败")}catch(l){console.error("添加分类出错:",l),r.error("添加分类失败")}}function Re(l){k.value={id:l.id,name:l.name,description:l.description,enabled:l.enabled},O.value=!0}async function He(){try{if(!k.value.name.trim()){r.error("请输入分类名称");return}const l=await ee.updateCategory(k.value.id,{name:k.value.name,description:k.value.description,enabled:k.value.enabled});l.code===0?(r.success("分类更新成功"),await Y.logUpdate(k.value.id,"Category"),O.value=!1,await P()):r.error(l.message||"更新分类失败")}catch(l){console.error("更新分类出错:",l),r.error("更新分类失败")}}async function Oe(l){try{await xe.confirm(`确定要删除分类 ${l.name} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Y.logDelete(l.id,"Category");const e=await ee.deleteCategory(l.id);e.code===0?(r.success("分类已删除"),await P()):r.error(e.message||"删除分类失败")}catch(e){e!=="cancel"&&(console.error("删除分类出错:",e),r.error("删除分类失败"))}}function ve(l){return{正常:"正常",已发布:"已发布",待审核:"待审核",已拒绝:"已拒绝",维护中:"维护中",Active:"已发布",Pending:"待审核",Rejected:"已拒绝",Inactive:"已下架",Deleted:"已删除"}[l]||l}function pe(l){return{正常:"success",已发布:"success",待审核:"warning",已拒绝:"danger",维护中:"warning",已下架:"info",已删除:"danger",Active:"success",Pending:"warning",Rejected:"danger",Inactive:"info",Deleted:"danger"}[l]||"info"}function Za(l){return l}function ce(l){return{教程:"primary",工具:"success",模板:"warning",其他:"info",未分类:"info"}[l]||"info"}function Qe(l){te.value=l,W.value=1}function qe(l){W.value=l}function G(l){return new Date(l).toLocaleDateString("zh-CN")}return ea(async()=>{await P(),await I(),Ie()}),(l,e)=>{const d=y("el-icon"),v=y("el-button"),g=y("el-input"),m=y("el-option"),E=y("el-select"),w=y("el-table-column"),A=y("el-tag"),me=y("el-table"),Je=y("el-pagination"),$=y("el-descriptions-item"),We=y("el-descriptions"),L=y("el-dialog"),fe=y("el-radio"),Ze=y("el-radio-group"),p=y("el-form-item"),X=y("el-form"),ge=y("el-checkbox"),_e=y("el-switch"),Ge=la("loading");return b(),D("div",pa,[n("div",ca,[n("div",ma,[n("div",fa,[n("div",ga,[a(d,{size:32},{default:o(()=>[a(V(Ve))]),_:1})]),e[44]||(e[44]=n("div",{class:"header-info"},[n("h1",{class:"page-title"},"内容管理"),n("p",{class:"page-subtitle"},"管理绳包资源和社区内容")],-1))]),n("div",_a,[a(v,{type:"primary",onClick:ze},{default:o(()=>[a(d,null,{default:o(()=>[a(V(we))]),_:1}),e[45]||(e[45]=i(" 添加内容 "))]),_:1,__:[45]}),a(v,{onClick:e[0]||(e[0]=t=>oe.value=!0)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(ta))]),_:1}),e[46]||(e[46]=i(" 分类管理 "))]),_:1,__:[46]})])])]),n("div",ya,[n("div",ba,[n("div",Va,[n("div",wa,[a(d,{size:24},{default:o(()=>[a(V(Ve))]),_:1})]),n("div",ka,[n("div",Ca,f(Z.value),1),e[47]||(e[47]=n("div",{class:"stat-label"},"总资源数",-1))])]),n("div",ha,[n("div",xa,[a(d,{size:24},{default:o(()=>[a(V(oa))]),_:1})]),n("div",Ua,[n("div",Pa,f(se.value),1),e[48]||(e[48]=n("div",{class:"stat-label"},"已发布",-1))])]),n("div",Ia,[n("div",$a,[a(d,{size:24},{default:o(()=>[a(V(sa))]),_:1})]),n("div",Da,[n("div",za,f(ue.value),1),e[49]||(e[49]=n("div",{class:"stat-label"},"待审核",-1))])]),n("div",Ta,[n("div",Aa,[a(d,{size:24},{default:o(()=>[a(V(ua))]),_:1})]),n("div",Sa,[n("div",Ma,f(ne.value),1),e[50]||(e[50]=n("div",{class:"stat-label"},"活跃用户",-1))])])])]),n("div",Ba,[n("div",Ea,[a(g,{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=t=>U.value=t),placeholder:"搜索绳包...","prefix-icon":"Search",clearable:"",style:{width:"300px"},onInput:$e},null,8,["modelValue"]),a(E,{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=t=>z.value=t),placeholder:"状态筛选",clearable:"",style:{width:"150px"}},{default:o(()=>[a(m,{label:"全部",value:""}),a(m,{label:"已发布",value:"Active"}),a(m,{label:"待审核",value:"Pending"}),a(m,{label:"已拒绝",value:"Rejected"}),a(m,{label:"已下架",value:"Inactive"}),a(m,{label:"已删除",value:"Deleted"})]),_:1},8,["modelValue"]),a(E,{modelValue:K.value,"onUpdate:modelValue":e[3]||(e[3]=t=>K.value=t),placeholder:"分类筛选",clearable:"",style:{width:"150px"}},{default:o(()=>[a(m,{label:"全部",value:""}),(b(!0),D(Q,null,q(T.value,t=>(b(),x(m,{key:t.id,label:t.name,value:t.name,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),n("div",La,[a(v,{onClick:De},{default:o(()=>[a(d,null,{default:o(()=>[a(V(na))]),_:1}),e[51]||(e[51]=i(" 刷新 "))]),_:1,__:[51]})])]),n("div",Na,[aa((b(),x(me,{data:Ue.value,style:{width:"100%"},"header-cell-style":{background:"var(--bg-secondary)",color:"var(--text-primary)"},"row-style":{background:"var(--bg-card)"},border:"",stripe:""},{default:o(()=>[a(w,{prop:"id",label:"ID",width:"80"}),a(w,{prop:"name",label:"名称",width:"200"}),a(w,{prop:"author",label:"作者",width:"120"}),a(w,{prop:"version",label:"版本",width:"100"}),a(w,{prop:"type",label:"分类",width:"100"},{default:o(({row:t})=>[a(A,{type:ce(t.type)},{default:o(()=>[i(f(t.type),1)]),_:2},1032,["type"])]),_:1}),a(w,{prop:"status",label:"状态",width:"100"},{default:o(({row:t})=>[a(A,{type:pe(t.status)},{default:o(()=>[i(f(ve(t.status)),1)]),_:2},1032,["type"])]),_:1}),a(w,{prop:"downloads",label:"下载次数",width:"120"}),a(w,{prop:"uploadTime",label:"上传时间",width:"150"},{default:o(({row:t})=>[i(f(G(t.uploadTime)),1)]),_:1}),a(w,{prop:"lastUpdate",label:"最后更新",width:"150"},{default:o(({row:t})=>[i(f(G(t.lastUpdate)),1)]),_:1}),a(w,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),a(w,{label:"操作",width:"250",fixed:"right"},{default:o(({row:t})=>[a(v,{size:"small",type:"primary",onClick:S=>Te(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(da))]),_:1}),e[52]||(e[52]=i(" 查看 "))]),_:2,__:[52]},1032,["onClick"]),a(v,{size:"small",type:"success",onClick:S=>re(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(ke))]),_:1}),e[53]||(e[53]=i(" 下载 "))]),_:2,__:[53]},1032,["onClick"]),a(v,{size:"small",type:"warning",onClick:S=>Ae(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(Ce))]),_:1}),e[54]||(e[54]=i(" 编辑 "))]),_:2,__:[54]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:S=>Ee(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(he))]),_:1}),e[55]||(e[55]=i(" 删除 "))]),_:2,__:[55]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ge,le.value]])]),n("div",ja,[a(Je,{"current-page":W.value,"onUpdate:currentPage":e[4]||(e[4]=t=>W.value=t),"page-size":te.value,"onUpdate:pageSize":e[5]||(e[5]=t=>te.value=t),"page-sizes":[10,20,50,100],total:Z.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Qe,onCurrentChange:qe},null,8,["current-page","page-size","total"])]),a(L,{modelValue:F.value,"onUpdate:modelValue":e[8]||(e[8]=t=>F.value=t),title:"绳包详情",width:"800px","close-on-click-modal":!1},{default:o(()=>[_.value?(b(),D("div",Ka,[n("div",Fa,[n("h3",null,f(_.value.name),1),a(A,{type:pe(_.value.status)},{default:o(()=>[i(f(ve(_.value.status)),1)]),_:1},8,["type"])]),a(We,{column:2,border:""},{default:o(()=>[a($,{label:"作者"},{default:o(()=>[i(f(_.value.author),1)]),_:1}),a($,{label:"版本"},{default:o(()=>[i(f(_.value.version),1)]),_:1}),a($,{label:"类型"},{default:o(()=>[a(A,{type:ce(_.value.type)},{default:o(()=>[i(f(_.value.type),1)]),_:1},8,["type"])]),_:1}),a($,{label:"下载次数"},{default:o(()=>[i(f(_.value.downloads),1)]),_:1}),a($,{label:"上传时间"},{default:o(()=>[i(f(G(_.value.uploadTime)),1)]),_:1}),a($,{label:"最后更新"},{default:o(()=>[i(f(G(_.value.lastUpdate)),1)]),_:1}),a($,{label:"描述",span:2},{default:o(()=>[i(f(_.value.description),1)]),_:1}),a($,{label:"项目链接",span:2},{default:o(()=>[n("a",{href:_.value.url,target:"_blank"},f(_.value.url),9,Ra)]),_:1})]),_:1}),n("div",Ha,[a(v,{type:"primary",onClick:e[6]||(e[6]=t=>{re(_.value),F.value=!1}),disabled:_.value.status!=="正常"&&_.value.status!=="Active"},{default:o(()=>[a(d,null,{default:o(()=>[a(V(ke))]),_:1}),e[56]||(e[56]=i(" 下载绳包 "))]),_:1,__:[56]},8,["disabled"]),a(v,{onClick:e[7]||(e[7]=t=>F.value=!1)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(ia))]),_:1}),e[57]||(e[57]=i(" 关闭 "))]),_:1,__:[57]})])])):N("",!0)]),_:1},8,["modelValue"]),a(L,{modelValue:B.value,"onUpdate:modelValue":e[19]||(e[19]=t=>B.value=t),title:"添加内容",width:"600px","close-on-click-modal":!1},{footer:o(()=>[a(v,{onClick:e[18]||(e[18]=t=>B.value=!1)},{default:o(()=>e[60]||(e[60]=[i("取消")])),_:1,__:[60]}),a(v,{type:"primary",onClick:Ke},{default:o(()=>[i(f(s.value.type==="package"?"添加资源":"发布帖子"),1)]),_:1})]),default:o(()=>[a(X,{model:s.value,"label-width":"100px"},{default:o(()=>[a(p,{label:"内容类型"},{default:o(()=>[a(Ze,{modelValue:s.value.type,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.type=t)},{default:o(()=>[a(fe,{value:"package"},{default:o(()=>e[58]||(e[58]=[i("资源")])),_:1,__:[58]}),a(fe,{value:"post"},{default:o(()=>e[59]||(e[59]=[i("帖子")])),_:1,__:[59]})]),_:1},8,["modelValue"])]),_:1}),a(p,{label:s.value.type==="package"?"资源名称":"帖子标题"},{default:o(()=>[a(g,{modelValue:s.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.name=t),placeholder:s.value.type==="package"?"请输入资源名称":"请输入帖子标题"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s.value.type==="package"?(b(),x(p,{key:0,label:"作者"},{default:o(()=>[a(g,{modelValue:s.value.author,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.author=t),placeholder:"请输入作者"},null,8,["modelValue"])]),_:1})):N("",!0),s.value.type==="package"?(b(),x(p,{key:1,label:"版本"},{default:o(()=>[a(g,{modelValue:s.value.version,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.version=t),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1})):N("",!0),a(p,{label:s.value.type==="package"?"资源分类":"帖子分类"},{default:o(()=>[a(E,{modelValue:s.value.category_id,"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.category_id=t),placeholder:s.value.type==="package"?"选择资源分类":"选择帖子分类"},{default:o(()=>[(b(!0),D(Q,null,q(T.value,t=>(b(),x(m,{key:t.id,label:t.name,value:t.id,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s.value.type==="package"?(b(),x(p,{key:2,label:"状态"},{default:o(()=>[a(E,{modelValue:s.value.status,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.status=t),placeholder:"选择状态"},{default:o(()=>[a(m,{label:"正常",value:"正常"}),a(m,{label:"已发布",value:"已发布"}),a(m,{label:"待审核",value:"待审核"}),a(m,{label:"已拒绝",value:"已拒绝"}),a(m,{label:"维护中",value:"维护中"})]),_:1},8,["modelValue"])]),_:1})):N("",!0),a(p,{label:s.value.type==="package"?"资源描述":"帖子内容"},{default:o(()=>[a(g,{modelValue:s.value.description,"onUpdate:modelValue":e[15]||(e[15]=t=>s.value.description=t),type:"textarea",rows:3,placeholder:s.value.type==="package"?"请输入资源描述":"请输入帖子内容"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{label:"标签"},{default:o(()=>[a(g,{modelValue:s.value.tagsInput,"onUpdate:modelValue":e[16]||(e[16]=t=>s.value.tagsInput=t),placeholder:"输入标签，用逗号分隔",onKeyup:ye(Le,["enter"]),clearable:""},null,8,["modelValue"]),n("div",Oa,[(b(!0),D(Q,null,q(s.value.tags,t=>(b(),x(A,{key:t,closable:"",onClose:S=>je(t),effect:"light"},{default:o(()=>[i(f(t),1)]),_:2},1032,["onClose"]))),128))])]),_:1}),s.value.type==="package"?(b(),x(p,{key:3,label:"项目链接"},{default:o(()=>[a(g,{modelValue:s.value.url,"onUpdate:modelValue":e[17]||(e[17]=t=>s.value.url=t),placeholder:"请输入项目链接"},null,8,["modelValue"])]),_:1})):N("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(L,{modelValue:R.value,"onUpdate:modelValue":e[31]||(e[31]=t=>R.value=t),title:"编辑资源",width:"600px","close-on-click-modal":!1},{footer:o(()=>[a(v,{onClick:e[30]||(e[30]=t=>R.value=!1)},{default:o(()=>e[63]||(e[63]=[i("取消")])),_:1,__:[63]}),a(v,{type:"primary",onClick:Se},{default:o(()=>e[64]||(e[64]=[i("保存")])),_:1,__:[64]})]),default:o(()=>[a(X,{model:u.value,"label-width":"100px"},{default:o(()=>[a(p,{label:"名称"},{default:o(()=>[a(g,{modelValue:u.value.name,"onUpdate:modelValue":e[20]||(e[20]=t=>u.value.name=t),placeholder:"请输入资源名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"作者"},{default:o(()=>[a(g,{modelValue:u.value.author,"onUpdate:modelValue":e[21]||(e[21]=t=>u.value.author=t),placeholder:"请输入作者"},null,8,["modelValue"])]),_:1}),a(p,{label:"版本"},{default:o(()=>[a(g,{modelValue:u.value.version,"onUpdate:modelValue":e[22]||(e[22]=t=>u.value.version=t),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1}),a(p,{label:"分类"},{default:o(()=>[a(E,{modelValue:u.value.category_id,"onUpdate:modelValue":e[23]||(e[23]=t=>u.value.category_id=t),placeholder:"选择分类"},{default:o(()=>[(b(!0),D(Q,null,q(T.value,t=>(b(),x(m,{key:t.id,label:t.name,value:t.id,disabled:!t.enabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"状态"},{default:o(()=>[a(E,{modelValue:u.value.status,"onUpdate:modelValue":e[24]||(e[24]=t=>u.value.status=t),placeholder:"选择状态"},{default:o(()=>[a(m,{label:"正常",value:"正常"}),a(m,{label:"已发布",value:"已发布"}),a(m,{label:"待审核",value:"待审核"}),a(m,{label:"已拒绝",value:"已拒绝"}),a(m,{label:"维护中",value:"维护中"})]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"描述"},{default:o(()=>[a(g,{modelValue:u.value.description,"onUpdate:modelValue":e[25]||(e[25]=t=>u.value.description=t),type:"textarea",rows:3,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),a(p,{label:"项目链接"},{default:o(()=>[a(g,{modelValue:u.value.url,"onUpdate:modelValue":e[26]||(e[26]=t=>u.value.url=t),placeholder:"请输入项目链接"},null,8,["modelValue"])]),_:1}),a(p,{label:"标签"},{default:o(()=>[a(g,{modelValue:u.value.tagsInput,"onUpdate:modelValue":e[27]||(e[27]=t=>u.value.tagsInput=t),placeholder:"请输入标签，用逗号分隔",onInput:Me,onKeyup:ye(Ne,["enter"])},null,8,["modelValue"]),u.value.tags&&u.value.tags.length>0?(b(),D("div",Qa,[(b(!0),D(Q,null,q(u.value.tags,t=>(b(),x(A,{key:t,closable:"",onClose:S=>Be(t),style:{margin:"4px 4px 0 0"}},{default:o(()=>[i(f(t),1)]),_:2},1032,["onClose"]))),128))])):N("",!0)]),_:1}),a(p,{label:"状态设置"},{default:o(()=>[a(ge,{modelValue:u.value.is_pinned,"onUpdate:modelValue":e[28]||(e[28]=t=>u.value.is_pinned=t)},{default:o(()=>e[61]||(e[61]=[i("置顶")])),_:1,__:[61]},8,["modelValue"]),a(ge,{modelValue:u.value.is_featured,"onUpdate:modelValue":e[29]||(e[29]=t=>u.value.is_featured=t)},{default:o(()=>e[62]||(e[62]=[i("精华")])),_:1,__:[62]},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(L,{modelValue:oe.value,"onUpdate:modelValue":e[43]||(e[43]=t=>oe.value=t),title:"分类管理",width:"800px","close-on-click-modal":!1},{default:o(()=>[n("div",qa,[n("div",Ja,[a(v,{type:"primary",onClick:e[32]||(e[32]=t=>H.value=!0)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(we))]),_:1}),e[65]||(e[65]=i(" 添加分类 "))]),_:1,__:[65]})]),a(me,{data:T.value,style:{width:"100%"},stripe:""},{default:o(()=>[a(w,{prop:"name",label:"分类名称",width:"150"}),a(w,{prop:"description",label:"描述","min-width":"200"}),a(w,{prop:"count",label:"资源数量",width:"100"}),a(w,{prop:"enabled",label:"状态",width:"100"},{default:o(({row:t})=>[a(A,{type:t.enabled?"success":"info"},{default:o(()=>[i(f(t.enabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(w,{label:"操作",width:"200"},{default:o(({row:t})=>[a(v,{size:"small",onClick:S=>Re(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(Ce))]),_:1}),e[66]||(e[66]=i(" 编辑 "))]),_:2,__:[66]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:S=>Oe(t)},{default:o(()=>[a(d,null,{default:o(()=>[a(V(he))]),_:1}),e[67]||(e[67]=i(" 删除 "))]),_:2,__:[67]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),a(L,{modelValue:H.value,"onUpdate:modelValue":e[37]||(e[37]=t=>H.value=t),title:"添加分类",width:"500px","append-to-body":""},{footer:o(()=>[a(v,{onClick:e[36]||(e[36]=t=>H.value=!1)},{default:o(()=>e[68]||(e[68]=[i("取消")])),_:1,__:[68]}),a(v,{type:"primary",onClick:Fe},{default:o(()=>e[69]||(e[69]=[i("添加")])),_:1,__:[69]})]),default:o(()=>[a(X,{model:C.value,"label-width":"100px"},{default:o(()=>[a(p,{label:"分类名称"},{default:o(()=>[a(g,{modelValue:C.value.name,"onUpdate:modelValue":e[33]||(e[33]=t=>C.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"描述"},{default:o(()=>[a(g,{modelValue:C.value.description,"onUpdate:modelValue":e[34]||(e[34]=t=>C.value.description=t),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1}),a(p,{label:"状态"},{default:o(()=>[a(_e,{modelValue:C.value.enabled,"onUpdate:modelValue":e[35]||(e[35]=t=>C.value.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(L,{modelValue:O.value,"onUpdate:modelValue":e[42]||(e[42]=t=>O.value=t),title:"编辑分类",width:"500px","append-to-body":""},{footer:o(()=>[a(v,{onClick:e[41]||(e[41]=t=>O.value=!1)},{default:o(()=>e[70]||(e[70]=[i("取消")])),_:1,__:[70]}),a(v,{type:"primary",onClick:He},{default:o(()=>e[71]||(e[71]=[i("保存")])),_:1,__:[71]})]),default:o(()=>[a(X,{model:k.value,"label-width":"100px"},{default:o(()=>[a(p,{label:"分类名称"},{default:o(()=>[a(g,{modelValue:k.value.name,"onUpdate:modelValue":e[38]||(e[38]=t=>k.value.name=t),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"描述"},{default:o(()=>[a(g,{modelValue:k.value.description,"onUpdate:modelValue":e[39]||(e[39]=t=>k.value.description=t),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1}),a(p,{label:"状态"},{default:o(()=>[a(_e,{modelValue:k.value.enabled,"onUpdate:modelValue":e[40]||(e[40]=t=>k.value.enabled=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),ol=ra(Wa,[["__scopeId","data-v-b0bfcaa8"]]);export{ol as default};
