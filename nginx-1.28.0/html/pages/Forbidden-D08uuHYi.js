import{x as E,r as g,c as m,ax as F,j as H,y,A as s,Q as t,I as n,u as d,al as r,K,O as c,M as l,H as w,z as p}from"../chunks/vue-vendor-BleHOoLr.js";import{l as P,N as U,p as j,ar as A,u as O,_ as Q,K as k}from"../chunks/element-plus-Cc1YNc_4.js";import{g as $,n as G,_ as J}from"../assets/index-B_N-aWSj.js";import"../chunks/utils-Dq7h7Pqt.js";const W={class:"forbidden-container"},X={class:"forbidden-content"},Y={class:"forbidden-icon"},Z={class:"forbidden-info"},ee={class:"forbidden-message"},te={key:0,class:"user-info"},ne={class:"permission-guide"},oe={class:"forbidden-actions"},se={class:"contact-admin"},ae={class:"security-notice"},le=E({__name:"Forbidden",setup(re){const u=F(),a=g($()),v=g(new Date().toLocaleString()),C=m(()=>{const o=u.currentRoute.value.query;if(o.error==="banned")return o.message||"您的账户已被封禁";if(!a.value)return"您需要登录后才能访问此页面";const e=a.value.ban_status?.toLowerCase();return e&&e!=="normal"?"您的账户状态异常，无法访问此页面":"您没有权限访问此页面，请联系管理员获取相应权限"}),h=m(()=>{if(!a.value)return"需要登录";const o=a.value.ban_status?.toLowerCase();return o&&o!=="normal"?"账户状态异常":"权限不足"}),x=m(()=>{if(!a.value)return"此页面需要用户登录后才能访问，请先登录您的账户。";const o=a.value.ban_status?.toLowerCase();if(o&&o!=="normal")return"您的账户当前状态异常，无法正常访问系统功能。如有疑问请联系管理员。";const e=u.currentRoute.value.query.target;return e?.includes("/admin")?"此页面仅限系统管理员访问。如需管理员权限，请联系超级管理员申请。":e?.includes("/elder")?"此页面仅限元老用户访问。元老权限需要通过社区贡献或管理员指定获得。":"您当前的用户角色无法访问此页面。不同页面需要不同的用户权限，请确认您的访问权限。"});function B(o){return{admin:"系统管理员",elder:"元老用户",moderator:"版主",user:"普通用户",guest:"游客"}[o]||o}function M(o){return{normal:"success",Normal:"success",suspended:"warning",Suspended:"warning",banned:"danger",Banned:"danger"}[o]||"info"}function N(o){return{normal:"正常",Normal:"正常",suspended:"暂停",Suspended:"暂停",banned:"封禁",Banned:"封禁"}[o]||o}function S(){u.back()}function L(){u.push("/")}function R(){u.push("/login")}async function I(){try{await G(),k.success("已退出登录"),u.push("/login")}catch(o){console.error("退出登录失败:",o),k.error("退出登录失败")}}return H(()=>{console.warn("403访问被拒绝:",{user:a.value?.username,path:u.currentRoute.value.fullPath,time:v.value})}),(o,e)=>{const i=r("el-icon"),_=r("el-descriptions-item"),T=r("el-tag"),V=r("el-descriptions"),b=r("el-card"),q=r("el-alert"),f=r("el-button"),z=r("el-button-group"),D=r("el-text");return p(),y("div",W,[s("div",X,[s("div",Y,[t(i,{size:120,color:"#f56565"},{default:n(()=>[t(d(P))]),_:1})]),s("div",Z,[e[6]||(e[6]=s("h1",{class:"forbidden-title"},"403 - 访问被拒绝",-1)),s("p",ee,c(C.value),1),a.value?(p(),y("div",te,[t(b,{shadow:"hover"},{header:n(()=>e[0]||(e[0]=[s("span",null,"当前用户信息",-1)])),default:n(()=>[t(V,{column:2,border:""},{default:n(()=>[t(_,{label:"用户名"},{default:n(()=>[l(c(a.value.username),1)]),_:1}),t(_,{label:"角色"},{default:n(()=>[l(c(B(a.value.role)),1)]),_:1}),t(_,{label:"状态"},{default:n(()=>[t(T,{type:M(a.value.ban_status)},{default:n(()=>[l(c(N(a.value.ban_status)),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"访问时间"},{default:n(()=>[l(c(v.value),1)]),_:1})]),_:1})]),_:1})])):K("",!0),s("div",ne,[t(q,{title:h.value,description:x.value,type:"warning",closable:!1,"show-icon":""},null,8,["title","description"])]),s("div",oe,[t(z,null,{default:n(()=>[t(f,{type:"primary",onClick:S},{default:n(()=>[t(i,null,{default:n(()=>[t(d(U))]),_:1}),e[1]||(e[1]=l(" 返回上一页 "))]),_:1,__:[1]}),t(f,{onClick:L},{default:n(()=>[t(i,null,{default:n(()=>[t(d(j))]),_:1}),e[2]||(e[2]=l(" 返回首页 "))]),_:1,__:[2]}),a.value?(p(),w(f,{key:0,onClick:I},{default:n(()=>[t(i,null,{default:n(()=>[t(d(A))]),_:1}),e[3]||(e[3]=l(" 切换账户 "))]),_:1,__:[3]})):(p(),w(f,{key:1,onClick:R},{default:n(()=>[t(i,null,{default:n(()=>[t(d(O))]),_:1}),e[4]||(e[4]=l(" 登录 "))]),_:1,__:[4]}))]),_:1})]),s("div",se,[t(D,{type:"info",size:"small"},{default:n(()=>e[5]||(e[5]=[l(" 如果您认为这是一个错误，请联系系统管理员 ")])),_:1,__:[5]})])])]),s("div",ae,[t(b,{shadow:"never"},{header:n(()=>[t(i,null,{default:n(()=>[t(d(Q))]),_:1}),e[7]||(e[7]=l(" 安全提示 "))]),default:n(()=>[e[8]||(e[8]=s("ul",{class:"security-tips"},[s("li",null,"🔒 系统已记录您的访问尝试"),s("li",null,"⚠️ 重复越权访问可能导致账户被限制"),s("li",null,"📞 如需申请权限，请联系系统管理员"),s("li",null,"🛡️ 请遵守系统使用规范和安全政策")],-1))]),_:1,__:[8]})])])}}}),_e=J(le,[["__scopeId","data-v-c42f1d97"]]);export{_e as default};
