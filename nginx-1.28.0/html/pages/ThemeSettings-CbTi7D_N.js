import{_ as B,a7 as I,K as b,E as A}from"../chunks/element-plus-Cc1YNc_4.js";import{s}from"../chunks/settings-CQEJtwx0.js";import{x as M,r as N,X as U,j as T,y as k,Q as o,I as a,A as n,al as g,M as c,u as P,z as v}from"../chunks/vue-vendor-BleHOoLr.js";import{_ as Q}from"../assets/index-B_N-aWSj.js";import"../chunks/utils-Dq7h7Pqt.js";const q={class:"system-settings"},F={class:"settings-content"},j={class:"setting-section"},D={class:"setting-section"},K={class:"mode-description"},O={key:0},W={key:1,class:"warning-text"},X={class:"setting-section"},G={class:"setting-section"},H={class:"setting-section"},J={class:"setting-section"},L={class:"setting-section"},Y={class:"setting-section"},Z={class:"setting-section"},$={class:"setting-actions"},ee=M({__name:"ThemeSettings",setup(le){const y=N(!1),l=U({theme:{},system_mode:"Normal",feature_flags:{},backend_config:{proxy_address:"",api_timeout:30,max_upload_size:100},backup_settings:{enable_auto_backup:!1,backup_interval_hours:24,backup_location:"./backups",max_backup_files:10},global_announcement:{enabled:!1,title:"",content:"",type_:"Info",start_time:"",end_time:"",priority:5},homepage_config:{hero_title:"绳包管理器",hero_subtitle:"专业的资源管理与分享平台",show_stats:!0,show_popular_tags:!0,show_recent_resources:!0,show_community_posts:!0,items_per_page:12},footer_config:{copyright_text:"© 2024 绳包管理器. All rights reserved.",icp_number:"",show_links:!0,show_stats:!0},seo_config:{keywords:"绳包管理器,资源管理,文件分享,社区",description:"绳包管理器是一个专业的资源管理与分享平台，提供便捷的文件管理和社区交流功能。",author:"绳包管理器团队"}});async function x(){try{const _=await s.getThemeSettings();if(_.code===0&&_.data){const d=U({});d.primary_color=_.data.primary_color,d.secondary_color=_.data.secondary_color,d.dark_mode=_.data.dark_mode,d.font_size=_.data.font_size,d.language=_.data.language,l.theme=d}const e=await s.getSetting("system_mode");e.code===0&&e.data&&(l.system_mode=e.data.value);const r=[s.getSetting("enable_registration"),s.getSetting("enable_community"),s.getSetting("enable_upload"),s.getSetting("enable_comments")];(await Promise.all(r)).forEach(d=>{if(d.code===0&&d.data){const u=d.data.key,m=d.data.value==="true";u in l.feature_flags&&(l.feature_flags[u]=m)}});const i=[s.getSetting("hero_title"),s.getSetting("hero_subtitle"),s.getSetting("show_stats"),s.getSetting("show_popular_tags"),s.getSetting("show_recent_resources"),s.getSetting("show_community_posts"),s.getSetting("items_per_page")];(await Promise.all(i)).forEach(d=>{if(d.code===0&&d.data){const u=d.data.key,m=d.data.value;u==="hero_title"?l.homepage_config.hero_title=m:u==="hero_subtitle"?l.homepage_config.hero_subtitle=m:u==="show_stats"?l.homepage_config.show_stats=m==="true":u==="show_popular_tags"?l.homepage_config.show_popular_tags=m==="true":u==="show_recent_resources"?l.homepage_config.show_recent_resources=m==="true":u==="show_community_posts"?l.homepage_config.show_community_posts=m==="true":u==="items_per_page"&&(l.homepage_config.items_per_page=parseInt(m)||12)}});const w=[s.getSetting("copyright_text"),s.getSetting("icp_number"),s.getSetting("footer_show_links"),s.getSetting("footer_show_stats")];(await Promise.all(w)).forEach(d=>{if(d.code===0&&d.data){const u=d.data.key,m=d.data.value;u==="copyright_text"?l.footer_config.copyright_text=m:u==="icp_number"?l.footer_config.icp_number=m:u==="footer_show_links"?l.footer_config.show_links=m==="true":u==="footer_show_stats"&&(l.footer_config.show_stats=m==="true")}});const h=[s.getSetting("seo_keywords"),s.getSetting("seo_description"),s.getSetting("seo_author")];(await Promise.all(h)).forEach(d=>{if(d.code===0&&d.data){const u=d.data.key,m=d.data.value;u==="seo_keywords"?l.seo_config.keywords=m:u==="seo_description"?l.seo_config.description=m:u==="seo_author"&&(l.seo_config.author=m)}})}catch(_){console.error("加载设置失败:",_),b.error("加载设置失败")}}async function E(){y.value=!0;try{const _=await s.updateThemeSettings({primary_color:l.theme.primary_color||"#409EFF",secondary_color:l.theme.secondary_color||"#67C23A",dark_mode:l.theme.dark_mode||!1,font_size:l.theme.font_size||"14px",language:l.theme.language||"zh-CN"});if(_.code===0){const e=[s.updateSetting("system_mode",l.system_mode),s.updateSetting("enable_registration",l.feature_flags.enable_registration),s.updateSetting("enable_community",l.feature_flags.enable_community),s.updateSetting("enable_upload",l.feature_flags.enable_upload),s.updateSetting("enable_comments",l.feature_flags.enable_comments),s.updateSetting("hero_title",l.homepage_config.hero_title),s.updateSetting("hero_subtitle",l.homepage_config.hero_subtitle),s.updateSetting("show_stats",l.homepage_config.show_stats),s.updateSetting("show_popular_tags",l.homepage_config.show_popular_tags),s.updateSetting("show_recent_resources",l.homepage_config.show_recent_resources),s.updateSetting("show_community_posts",l.homepage_config.show_community_posts),s.updateSetting("items_per_page",l.homepage_config.items_per_page),s.updateSetting("copyright_text",l.footer_config.copyright_text),s.updateSetting("icp_number",l.footer_config.icp_number),s.updateSetting("footer_show_links",l.footer_config.show_links),s.updateSetting("footer_show_stats",l.footer_config.show_stats),s.updateSetting("seo_keywords",l.seo_config.keywords),s.updateSetting("seo_description",l.seo_config.description),s.updateSetting("seo_author",l.seo_config.author)];await Promise.all(e),b.success("设置保存成功")}else b.error(_.msg||_.message||"保存失败")}catch(_){console.error("保存设置失败:",_),b.error("保存设置失败")}finally{y.value=!1}}function R(){A.confirm("确定要重置所有设置吗？这将恢复默认配置。","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const _=await s.resetSettings();_.code===0?(b.success("设置已重置"),x()):b.error(_.msg||_.message||"重置失败")}catch(_){console.error("重置设置失败:",_),b.error("重置设置失败")}}).catch(()=>{})}function z(){b.info("测试功能开发中...")}return T(()=>{x()}),(_,e)=>{const r=g("el-option"),V=g("el-select"),i=g("el-form-item"),f=g("el-form"),w=g("el-radio"),S=g("el-radio-group"),h=g("el-icon"),p=g("el-switch"),d=g("el-input"),u=g("el-input-number"),m=g("el-button"),C=g("el-card");return v(),k("div",q,[o(C,{class:"settings-card"},{header:a(()=>e[34]||(e[34]=[n("div",{class:"settings-header"},[n("h2",null,"系统设置"),n("p",null,"管理系统配置、主题、功能开关等设置")],-1)])),default:a(()=>[n("div",F,[n("div",j,[e[35]||(e[35]=n("h3",null,"主题设置",-1)),o(f,{model:l.theme,"label-width":"120px"},{default:a(()=>[o(i,{label:"资源社区主题"},{default:a(()=>[o(V,{modelValue:l.theme.community_theme,"onUpdate:modelValue":e[0]||(e[0]=t=>l.theme.community_theme=t),placeholder:"选择社区主题"},{default:a(()=>[o(r,{label:"浅色主题",value:"light"}),o(r,{label:"深色主题",value:"dark"}),o(r,{label:"蓝色主题",value:"blue"}),o(r,{label:"绿色主题",value:"green"}),o(r,{label:"紫色主题",value:"purple"}),o(r,{label:"橙色主题",value:"orange"}),o(r,{label:"红色主题",value:"red"})]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"后台管理主题"},{default:a(()=>[o(V,{modelValue:l.theme.admin_theme,"onUpdate:modelValue":e[1]||(e[1]=t=>l.theme.admin_theme=t),placeholder:"选择管理主题"},{default:a(()=>[o(r,{label:"浅色主题",value:"light"}),o(r,{label:"深色主题",value:"dark"}),o(r,{label:"蓝色主题",value:"blue"}),o(r,{label:"绿色主题",value:"green"}),o(r,{label:"紫色主题",value:"purple"}),o(r,{label:"橙色主题",value:"orange"}),o(r,{label:"红色主题",value:"red"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),n("div",D,[e[40]||(e[40]=n("h3",null,"系统模式",-1)),o(f,{model:l,"label-width":"120px"},{default:a(()=>[o(i,{label:"系统模式"},{default:a(()=>[o(S,{modelValue:l.system_mode,"onUpdate:modelValue":e[2]||(e[2]=t=>l.system_mode=t)},{default:a(()=>[o(w,{label:"Normal"},{default:a(()=>e[36]||(e[36]=[c("正常运行")])),_:1,__:[36]}),o(w,{label:"Maintenance"},{default:a(()=>e[37]||(e[37]=[c("维护中")])),_:1,__:[37]})]),_:1},8,["modelValue"]),n("div",K,[l.system_mode==="Normal"?(v(),k("p",O,[o(h,null,{default:a(()=>[o(P(B))]),_:1}),e[38]||(e[38]=c(" 正常运行模式：所有功能正常开放，用户可以正常使用所有功能 "))])):(v(),k("p",W,[o(h,null,{default:a(()=>[o(P(I))]),_:1}),e[39]||(e[39]=c(" 维护模式：仅管理员可登录，用户注册、上传等功能将被禁用 "))]))])]),_:1})]),_:1},8,["model"])]),n("div",X,[e[46]||(e[46]=n("h3",null,"功能开关",-1)),o(f,{model:l.feature_flags,"label-width":"120px"},{default:a(()=>[o(i,{label:"用户注册"},{default:a(()=>[o(p,{modelValue:l.feature_flags.enable_registration,"onUpdate:modelValue":e[3]||(e[3]=t=>l.feature_flags.enable_registration=t)},null,8,["modelValue"]),e[41]||(e[41]=n("span",{class:"feature-desc"},"允许新用户注册账号",-1))]),_:1,__:[41]}),o(i,{label:"资源社区"},{default:a(()=>[o(p,{modelValue:l.feature_flags.enable_community,"onUpdate:modelValue":e[4]||(e[4]=t=>l.feature_flags.enable_community=t)},null,8,["modelValue"]),e[42]||(e[42]=n("span",{class:"feature-desc"},"开放资源社区功能",-1))]),_:1,__:[42]}),o(i,{label:"用户上传"},{default:a(()=>[o(p,{modelValue:l.feature_flags.enable_upload,"onUpdate:modelValue":e[5]||(e[5]=t=>l.feature_flags.enable_upload=t)},null,8,["modelValue"]),e[43]||(e[43]=n("span",{class:"feature-desc"},"允许用户上传资源",-1))]),_:1,__:[43]}),o(i,{label:"用户评论"},{default:a(()=>[o(p,{modelValue:l.feature_flags.enable_comments,"onUpdate:modelValue":e[6]||(e[6]=t=>l.feature_flags.enable_comments=t)},null,8,["modelValue"]),e[44]||(e[44]=n("span",{class:"feature-desc"},"允许用户发表评论",-1))]),_:1,__:[44]}),o(i,{label:"QQ绑定"},{default:a(()=>[o(p,{modelValue:l.feature_flags.enable_qq_binding,"onUpdate:modelValue":e[7]||(e[7]=t=>l.feature_flags.enable_qq_binding=t)},null,8,["modelValue"]),e[45]||(e[45]=n("span",{class:"feature-desc"},"允许用户绑定QQ账号",-1))]),_:1,__:[45]})]),_:1},8,["model"])]),n("div",G,[e[49]||(e[49]=n("h3",null,"后端配置",-1)),o(f,{model:l.backend_config,"label-width":"120px"},{default:a(()=>[o(i,{label:"代理地址"},{default:a(()=>[o(d,{modelValue:l.backend_config.proxy_address,"onUpdate:modelValue":e[8]||(e[8]=t=>l.backend_config.proxy_address=t),placeholder:"设置后台代理地址"},null,8,["modelValue"])]),_:1}),o(i,{label:"API超时时间"},{default:a(()=>[o(u,{modelValue:l.backend_config.api_timeout,"onUpdate:modelValue":e[9]||(e[9]=t=>l.backend_config.api_timeout=t),min:1,max:300,placeholder:"秒"},null,8,["modelValue"]),e[47]||(e[47]=n("span",{class:"config-desc"},"API请求超时时间（秒）",-1))]),_:1,__:[47]}),o(i,{label:"最大上传大小"},{default:a(()=>[o(u,{modelValue:l.backend_config.max_upload_size,"onUpdate:modelValue":e[10]||(e[10]=t=>l.backend_config.max_upload_size=t),min:1,max:1e3,placeholder:"MB"},null,8,["modelValue"]),e[48]||(e[48]=n("span",{class:"config-desc"},"最大上传文件大小（MB）",-1))]),_:1,__:[48]})]),_:1},8,["model"])]),n("div",H,[e[53]||(e[53]=n("h3",null,"数据库备份",-1)),o(f,{model:l.backup_settings,"label-width":"120px"},{default:a(()=>[o(i,{label:"自动备份"},{default:a(()=>[o(p,{modelValue:l.backup_settings.enable_auto_backup,"onUpdate:modelValue":e[11]||(e[11]=t=>l.backup_settings.enable_auto_backup=t)},null,8,["modelValue"]),e[50]||(e[50]=n("span",{class:"backup-desc"},"启用自动备份功能",-1))]),_:1,__:[50]}),o(i,{label:"备份间隔"},{default:a(()=>[o(u,{modelValue:l.backup_settings.backup_interval_hours,"onUpdate:modelValue":e[12]||(e[12]=t=>l.backup_settings.backup_interval_hours=t),min:1,max:168,placeholder:"小时",disabled:!l.backup_settings.enable_auto_backup},null,8,["modelValue","disabled"]),e[51]||(e[51]=n("span",{class:"backup-desc"},"备份间隔时间（小时）",-1))]),_:1,__:[51]}),o(i,{label:"备份位置"},{default:a(()=>[o(d,{modelValue:l.backup_settings.backup_location,"onUpdate:modelValue":e[13]||(e[13]=t=>l.backup_settings.backup_location=t),placeholder:"备份文件存储路径",disabled:!l.backup_settings.enable_auto_backup},null,8,["modelValue","disabled"])]),_:1}),o(i,{label:"最大备份文件"},{default:a(()=>[o(u,{modelValue:l.backup_settings.max_backup_files,"onUpdate:modelValue":e[14]||(e[14]=t=>l.backup_settings.max_backup_files=t),min:1,max:100,placeholder:"个",disabled:!l.backup_settings.enable_auto_backup},null,8,["modelValue","disabled"]),e[52]||(e[52]=n("span",{class:"backup-desc"},"保留的最大备份文件数量",-1))]),_:1,__:[52]})]),_:1},8,["model"])]),n("div",J,[e[56]||(e[56]=n("h3",null,"全局公告",-1)),o(f,{model:l.global_announcement,"label-width":"120px"},{default:a(()=>[o(i,{label:"启用公告"},{default:a(()=>[o(p,{modelValue:l.global_announcement.enabled,"onUpdate:modelValue":e[15]||(e[15]=t=>l.global_announcement.enabled=t)},null,8,["modelValue"]),e[54]||(e[54]=n("span",{class:"announcement-desc"},"在资源社区显示全局公告",-1))]),_:1,__:[54]}),o(i,{label:"公告标题"},{default:a(()=>[o(d,{modelValue:l.global_announcement.title,"onUpdate:modelValue":e[16]||(e[16]=t=>l.global_announcement.title=t),placeholder:"公告标题",disabled:!l.global_announcement.enabled},null,8,["modelValue","disabled"])]),_:1}),o(i,{label:"公告内容"},{default:a(()=>[o(d,{modelValue:l.global_announcement.content,"onUpdate:modelValue":e[17]||(e[17]=t=>l.global_announcement.content=t),type:"textarea",rows:4,placeholder:"公告内容",disabled:!l.global_announcement.enabled},null,8,["modelValue","disabled"])]),_:1}),o(i,{label:"公告类型"},{default:a(()=>[o(V,{modelValue:l.global_announcement.type_,"onUpdate:modelValue":e[18]||(e[18]=t=>l.global_announcement.type_=t),placeholder:"选择公告类型",disabled:!l.global_announcement.enabled},{default:a(()=>[o(r,{label:"信息",value:"Info"}),o(r,{label:"警告",value:"Warning"}),o(r,{label:"错误",value:"Error"}),o(r,{label:"成功",value:"Success"})]),_:1},8,["modelValue","disabled"])]),_:1}),o(i,{label:"优先级"},{default:a(()=>[o(u,{modelValue:l.global_announcement.priority,"onUpdate:modelValue":e[19]||(e[19]=t=>l.global_announcement.priority=t),min:1,max:10,placeholder:"1-10",disabled:!l.global_announcement.enabled},null,8,["modelValue","disabled"]),e[55]||(e[55]=n("span",{class:"announcement-desc"},"公告显示优先级（1-10）",-1))]),_:1,__:[55]})]),_:1},8,["model"])]),n("div",L,[e[62]||(e[62]=n("h3",null,"首页显示配置",-1)),o(f,{model:l.homepage_config,"label-width":"120px"},{default:a(()=>[o(i,{label:"首页标题"},{default:a(()=>[o(d,{modelValue:l.homepage_config.hero_title,"onUpdate:modelValue":e[20]||(e[20]=t=>l.homepage_config.hero_title=t),placeholder:"请输入首页主标题",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"首页副标题"},{default:a(()=>[o(d,{modelValue:l.homepage_config.hero_subtitle,"onUpdate:modelValue":e[21]||(e[21]=t=>l.homepage_config.hero_subtitle=t),type:"textarea",rows:2,placeholder:"请输入首页副标题",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"显示统计数据"},{default:a(()=>[o(p,{modelValue:l.homepage_config.show_stats,"onUpdate:modelValue":e[22]||(e[22]=t=>l.homepage_config.show_stats=t)},null,8,["modelValue"]),e[57]||(e[57]=n("span",{class:"config-desc"},"在首页显示用户、资源等统计数据",-1))]),_:1,__:[57]}),o(i,{label:"显示热门标签"},{default:a(()=>[o(p,{modelValue:l.homepage_config.show_popular_tags,"onUpdate:modelValue":e[23]||(e[23]=t=>l.homepage_config.show_popular_tags=t)},null,8,["modelValue"]),e[58]||(e[58]=n("span",{class:"config-desc"},"在首页显示热门标签",-1))]),_:1,__:[58]}),o(i,{label:"显示最新资源"},{default:a(()=>[o(p,{modelValue:l.homepage_config.show_recent_resources,"onUpdate:modelValue":e[24]||(e[24]=t=>l.homepage_config.show_recent_resources=t)},null,8,["modelValue"]),e[59]||(e[59]=n("span",{class:"config-desc"},"在首页显示最新上传的资源",-1))]),_:1,__:[59]}),o(i,{label:"显示社区帖子"},{default:a(()=>[o(p,{modelValue:l.homepage_config.show_community_posts,"onUpdate:modelValue":e[25]||(e[25]=t=>l.homepage_config.show_community_posts=t)},null,8,["modelValue"]),e[60]||(e[60]=n("span",{class:"config-desc"},"在首页显示社区讨论帖子",-1))]),_:1,__:[60]}),o(i,{label:"每页显示数量"},{default:a(()=>[o(u,{modelValue:l.homepage_config.items_per_page,"onUpdate:modelValue":e[26]||(e[26]=t=>l.homepage_config.items_per_page=t),min:6,max:50,placeholder:"每页显示的资源数量"},null,8,["modelValue"]),e[61]||(e[61]=n("span",{class:"config-desc"},"首页每页显示的资源数量",-1))]),_:1,__:[61]})]),_:1},8,["model"])]),n("div",Y,[e[65]||(e[65]=n("h3",null,"页脚配置",-1)),o(f,{model:l.footer_config,"label-width":"120px"},{default:a(()=>[o(i,{label:"版权信息"},{default:a(()=>[o(d,{modelValue:l.footer_config.copyright_text,"onUpdate:modelValue":e[27]||(e[27]=t=>l.footer_config.copyright_text=t),placeholder:"© 2024 绳包管理器. All rights reserved.",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"备案号"},{default:a(()=>[o(d,{modelValue:l.footer_config.icp_number,"onUpdate:modelValue":e[28]||(e[28]=t=>l.footer_config.icp_number=t),placeholder:"请输入ICP备案号",maxlength:"50"},null,8,["modelValue"])]),_:1}),o(i,{label:"显示友情链接"},{default:a(()=>[o(p,{modelValue:l.footer_config.show_links,"onUpdate:modelValue":e[29]||(e[29]=t=>l.footer_config.show_links=t)},null,8,["modelValue"]),e[63]||(e[63]=n("span",{class:"config-desc"},"在页脚显示友情链接",-1))]),_:1,__:[63]}),o(i,{label:"显示统计信息"},{default:a(()=>[o(p,{modelValue:l.footer_config.show_stats,"onUpdate:modelValue":e[30]||(e[30]=t=>l.footer_config.show_stats=t)},null,8,["modelValue"]),e[64]||(e[64]=n("span",{class:"config-desc"},"在页脚显示网站统计信息",-1))]),_:1,__:[64]})]),_:1},8,["model"])]),n("div",Z,[e[66]||(e[66]=n("h3",null,"SEO配置",-1)),o(f,{model:l.seo_config,"label-width":"120px"},{default:a(()=>[o(i,{label:"网站关键词"},{default:a(()=>[o(d,{modelValue:l.seo_config.keywords,"onUpdate:modelValue":e[31]||(e[31]=t=>l.seo_config.keywords=t),type:"textarea",rows:2,placeholder:"请输入网站关键词，用逗号分隔",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"网站描述"},{default:a(()=>[o(d,{modelValue:l.seo_config.description,"onUpdate:modelValue":e[32]||(e[32]=t=>l.seo_config.description=t),type:"textarea",rows:3,placeholder:"请输入网站描述",maxlength:"300","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(i,{label:"作者信息"},{default:a(()=>[o(d,{modelValue:l.seo_config.author,"onUpdate:modelValue":e[33]||(e[33]=t=>l.seo_config.author=t),placeholder:"请输入网站作者",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),n("div",$,[o(m,{type:"primary",onClick:E,loading:y.value},{default:a(()=>e[67]||(e[67]=[c(" 保存设置 ")])),_:1,__:[67]},8,["loading"]),o(m,{onClick:R},{default:a(()=>e[68]||(e[68]=[c("重置设置")])),_:1,__:[68]}),o(m,{onClick:z},{default:a(()=>e[69]||(e[69]=[c("测试设置")])),_:1,__:[69]})])])]),_:1})])}}}),de=Q(ee,[["__scopeId","data-v-04534a70"]]);export{de as default};
