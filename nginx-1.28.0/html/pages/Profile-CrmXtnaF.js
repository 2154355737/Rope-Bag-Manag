import{u as c}from"../chunks/users-D39iNwN1.js";import{P as C,H as f}from"../chunks/element-plus-hGoKm610.js";import{x as Q,r as v,X as R,j as A,y as b,A as B,Q as t,I as o,al as r,H as P,M as g,u as E,z as _}from"../chunks/vue-vendor-BleHOoLr.js";import{_ as M}from"../assets/index-C28i2SJl.js";import"../chunks/utils-Dq7h7Pqt.js";const N={class:"elder-profile"},F=["src"],H=Q({__name:"Profile",setup(I){const d=v(null),a=R({nickname:"",qq_number:"",avatar_url:""}),k={nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],qq_number:[{pattern:/^\d{5,12}$/,message:"请输入有效QQ号",trigger:"blur"}]},m=v(!1),i=async()=>{const l=await c.getCurrentUser();l.code===0&&l.data&&(a.nickname=l.data.nickname||"",a.qq_number=l.data.qq_number||"",a.avatar_url=l.data.avatar_url||"")};A(i);function q(l){const e=new FileReader;return e.onload=n=>{a.avatar_url=n.target?.result},e.readAsDataURL(l),!1}const V=async()=>{if(!d.value)return;await d.value.validate(),m.value=!0;const l=await c.updateCurrentUser(a);m.value=!1,l.code===0?(f.success("保存成功"),i()):f.error(l.message||l.msg||"保存失败")},x=()=>{i()};return(l,e)=>{const n=r("el-input"),u=r("el-form-item"),y=r("User"),U=r("el-icon"),w=r("el-upload"),p=r("el-button");return _(),b("div",N,[e[5]||(e[5]=B("h2",null,"个人信息编辑",-1)),t(E(C),{model:a,rules:k,ref_key:"formRef",ref:d,"label-width":"90px",style:{"max-width":"400px"}},{default:o(()=>[t(u,{label:"昵称",prop:"nickname"},{default:o(()=>[t(n,{modelValue:a.nickname,"onUpdate:modelValue":e[0]||(e[0]=s=>a.nickname=s),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),t(u,{label:"QQ号",prop:"qq_number"},{default:o(()=>[t(n,{modelValue:a.qq_number,"onUpdate:modelValue":e[1]||(e[1]=s=>a.qq_number=s),placeholder:"请输入QQ号"},null,8,["modelValue"])]),_:1}),t(u,{label:"头像",prop:"avatar_url"},{default:o(()=>[t(w,{class:"avatar-uploader",action:"","show-file-list":!1,"before-upload":q},{default:o(()=>[a.avatar_url?(_(),b("img",{key:0,src:a.avatar_url,class:"avatar"},null,8,F)):(_(),P(U,{key:1},{default:o(()=>[t(y)]),_:1}))]),_:1}),t(n,{modelValue:a.avatar_url,"onUpdate:modelValue":e[2]||(e[2]=s=>a.avatar_url=s),placeholder:"或粘贴头像图片URL",style:{"margin-top":"8px"}},null,8,["modelValue"])]),_:1}),t(u,null,{default:o(()=>[t(p,{type:"primary",onClick:V,loading:m.value},{default:o(()=>e[3]||(e[3]=[g("保存")])),_:1,__:[3]},8,["loading"]),t(p,{onClick:x},{default:o(()=>e[4]||(e[4]=[g("重置")])),_:1,__:[4]})]),_:1})]),_:1},8,["model"])])}}}),T=M(H,[["__scopeId","data-v-d94e72f5"]]);export{T as default};
