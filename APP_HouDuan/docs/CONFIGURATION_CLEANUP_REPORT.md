# é…ç½®æ–‡ä»¶æ¸…ç†æŠ¥å‘Š

## ğŸ“‹ æ¸…ç†æ¦‚è¿°

âœ… **å®Œæˆæ—¶é—´**: 2024å¹´12æœˆé…ç½®æ¸…ç†  
âœ… **å¤„ç†æ–‡ä»¶**: 15+ ä¸ªé…ç½®å’Œå¯åŠ¨æ–‡ä»¶  
âœ… **åˆ›å»ºæ¨¡æ¿**: 4 ä¸ªæ–°çš„é…ç½®æ¨¡æ¿  
âœ… **ç®€åŒ–è„šæœ¬**: ä»5ä¸ªå¯åŠ¨è„šæœ¬ç®€åŒ–ä¸º2ä¸ª  

## ğŸ” ä¸»è¦é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1: Cargo.toml å†—ä½™äºŒè¿›åˆ¶å®šä¹‰
**åŸé—®é¢˜**: å®šä¹‰äº†27ä¸ªå·²ç§»åŠ¨æ–‡ä»¶çš„äºŒè¿›åˆ¶è·¯å¾„  
**è§£å†³æ–¹æ¡ˆ**: 
- æ¸…ç†ååªä¿ç•™4ä¸ªå¸¸ç”¨å·¥å…·çš„å¿«æ·æ–¹å¼
- æ—§æ–‡ä»¶å¤‡ä»½ä¸º `Cargo.toml.old`
- äºŒè¿›åˆ¶å®šä¹‰ä»27ä¸ªå‡å°‘åˆ°4ä¸ª

### é—®é¢˜2: é…ç½®æ–‡ä»¶å®‰å…¨éšæ‚£
**åŸé—®é¢˜**: `config.toml`åŒ…å«ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯  
**è§£å†³æ–¹æ¡ˆ**:
- åˆ›å»º `config.toml.template` æ¨¡æ¿æ–‡ä»¶
- ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç å¯†ç å’Œå¯†é’¥
- æ—§é…ç½®å¤‡ä»½ä¸º `config.toml.old`
- æ·»åŠ  `.env.template` ç¯å¢ƒå˜é‡æ¨¡æ¿

### é—®é¢˜3: å¯åŠ¨è„šæœ¬é‡å¤å’Œå¤æ‚
**åŸé—®é¢˜**: 5ä¸ªåŠŸèƒ½é‡å çš„å¯åŠ¨è„šæœ¬ï¼Œä»£ç å†—ä½™  
**è§£å†³æ–¹æ¡ˆ**:
- åˆ›å»º2ä¸ªç®€åŒ–çš„å¯åŠ¨è„šæœ¬
- æ—§è„šæœ¬ç§»åŠ¨åˆ° `deprecated/` ç›®å½•
- è„šæœ¬åŠŸèƒ½æ›´åŠ æ˜ç¡®å’Œç®€æ´

### é—®é¢˜4: éƒ¨ç½²è„šæœ¬è¿‡åº¦å¤æ‚
**åŸé—®é¢˜**: `è‡ªåŠ¨éƒ¨ç½².bat` è¶…è¿‡600è¡Œï¼Œéš¾ä»¥ç»´æŠ¤  
**è§£å†³æ–¹æ¡ˆ**:
- åˆ›å»º `deploy_simple.bat` ç®€åŒ–ç‰ˆæœ¬
- ä¿ç•™æ ¸å¿ƒåŠŸèƒ½ï¼Œç§»é™¤å†—ä½™æ£€æŸ¥
- ä»£ç è¡Œæ•°ä»600+å‡å°‘åˆ°150è¡Œå·¦å³

## ğŸ“ æ–°çš„é…ç½®ç»“æ„

### é…ç½®æ¨¡æ¿æ–‡ä»¶
```
â”œâ”€â”€ config.toml.template        # ä¸»é…ç½®æ¨¡æ¿
â”œâ”€â”€ .env.template              # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ config.toml.old            # æ—§é…ç½®å¤‡ä»½
â””â”€â”€ Cargo.toml.old             # æ—§Cargoé…ç½®å¤‡ä»½
```

### å¯åŠ¨è„šæœ¬ (`tools/scripts/`)
```
â”œâ”€â”€ start_clean.bat            # å¼€å‘ç¯å¢ƒå¯åŠ¨ (ç®€åŒ–ç‰ˆ)
â”œâ”€â”€ start_production.bat       # ç”Ÿäº§ç¯å¢ƒå¯åŠ¨ (ç®€åŒ–ç‰ˆ)
â”œâ”€â”€ deploy_simple.bat          # ç®€åŒ–éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ patch_database.bat         # æ•°æ®åº“è¡¥ä¸å·¥å…· (ä¿ç•™)
â”œâ”€â”€ run_publish_migration.bat  # å‘å¸ƒè¿ç§»å·¥å…· (ä¿ç•™)
â”œâ”€â”€ test_logs.sh               # æ—¥å¿—æµ‹è¯•è„šæœ¬ (ä¿ç•™)
â””â”€â”€ deprecated/                # æ—§è„šæœ¬å­˜æ¡£
    â”œâ”€â”€ start_old.bat
    â”œâ”€â”€ start_release_old.bat
    â”œâ”€â”€ start_with_logs_old.bat
    â”œâ”€â”€ start_with_security_old.bat
    â””â”€â”€ deploy_complex_old.bat
```

## ğŸš€ æ–°çš„ä½¿ç”¨æ–¹å¼

### é¦–æ¬¡é…ç½®
```bash
# 1. å¤åˆ¶é…ç½®æ¨¡æ¿
copy config.toml.template config.toml
copy .env.template .env

# 2. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å†™å®é™…å€¼
notepad config.toml
notepad .env

# 3. å¯åŠ¨æœåŠ¡
tools\\scripts\\start_clean.bat
```

### å¼€å‘ç¯å¢ƒå¯åŠ¨
```bash
# æ™®é€šå¯åŠ¨
tools\\scripts\\start_clean.bat

# è°ƒè¯•æ¨¡å¼å¯åŠ¨
tools\\scripts\\start_clean.bat debug

# è·Ÿè¸ªæ¨¡å¼å¯åŠ¨  
tools\\scripts\\start_clean.bat trace
```

### ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
```bash
# é¦–å…ˆæ„å»ºå‘å¸ƒç‰ˆæœ¬
cargo build --release

# å¯åŠ¨ç”Ÿäº§æœåŠ¡
tools\\scripts\\start_production.bat
```

### ç®€åŒ–éƒ¨ç½²
```bash
# ä¸€é”®éƒ¨ç½² (å‰ç«¯+åç«¯)
tools\\scripts\\deploy_simple.bat
```

## ğŸ”§ é…ç½®æ”¹è¿›è¯¦æƒ…

### Cargo.toml æ¸…ç†
**æ¸…ç†å‰**: 27ä¸ªäºŒè¿›åˆ¶å®šä¹‰  
**æ¸…ç†å**: 4ä¸ªæ ¸å¿ƒå·¥å…·å®šä¹‰
```toml
# åªä¿ç•™æœ€å¸¸ç”¨çš„å·¥å…·
[[bin]]
name = "check_db_schema"
path = "tools/database/check_db_schema.rs"

[[bin]]
name = "patch_database" 
path = "tools/database/patch_database.rs"

[[bin]]
name = "generate_admin_password"
path = "tools/admin/generate_admin_password.rs"

[[bin]]
name = "simple_test"
path = "tools/test/simple_test.rs"
```

### é…ç½®æ–‡ä»¶å®‰å…¨åŒ–
**å®‰å…¨æ”¹è¿›**:
- ç§»é™¤ç¡¬ç¼–ç å¯†ç å’Œå¯†é’¥
- æ·»åŠ é…ç½®æç¤ºå’Œè¯´æ˜
- ä½¿ç”¨æ¨¡æ¿æ–‡ä»¶é˜²æ­¢æ„å¤–æäº¤æ•æ„Ÿä¿¡æ¯

### å¯åŠ¨è„šæœ¬ç®€åŒ–
**åŠŸèƒ½å¯¹æ¯”**:

| æ—§è„šæœ¬ | æ–°è„šæœ¬ | æ”¹è¿› |
|--------|--------|------|
| start.bat (50è¡Œ) | start_clean.bat (40è¡Œ) | ç®€åŒ–ç¯å¢ƒå˜é‡è®¾ç½® |
| start_release.bat (80è¡Œ) | start_production.bat (45è¡Œ) | ç®€åŒ–è·¯å¾„æ£€æŸ¥é€»è¾‘ |
| start_with_logs.bat (60è¡Œ) | åˆå¹¶åˆ°start_clean.bat | é€šè¿‡å‚æ•°æ§åˆ¶æ—¥å¿—çº§åˆ« |
| start_with_security.bat (70è¡Œ) | ç§»é™¤ | åŠŸèƒ½å·²é›†æˆåˆ°ä¸»æœåŠ¡ |
| è‡ªåŠ¨éƒ¨ç½².bat (600+è¡Œ) | deploy_simple.bat (150è¡Œ) | å¤§å¹…ç®€åŒ–ï¼Œä¿ç•™æ ¸å¿ƒåŠŸèƒ½ |

## âš ï¸ è¿ç§»æ³¨æ„äº‹é¡¹

### å¿…éœ€æ“ä½œ
1. **å¤åˆ¶é…ç½®æ–‡ä»¶**:
   ```bash
   copy config.toml.template config.toml
   copy .env.template .env
   ```

2. **æ›´æ–°é…ç½®ä¿¡æ¯**: ç¼–è¾‘æ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¡«å†™å®é™…çš„æ•°æ®åº“ã€é‚®ä»¶ç­‰é…ç½®

3. **æ›´æ–°å¯åŠ¨æ–¹å¼**: ä½¿ç”¨æ–°çš„å¯åŠ¨è„šæœ¬ä»£æ›¿æ—§è„šæœ¬

### å…¼å®¹æ€§è¯´æ˜
- æ—§çš„å¯åŠ¨è„šæœ¬ä¿å­˜åœ¨ `deprecated/` ç›®å½•ä¸­ï¼Œå¦‚éœ€è¦å¯ä»¥ç»§ç»­ä½¿ç”¨
- æ—§çš„é…ç½®æ–‡ä»¶å¤‡ä»½ä¸º `.old` åç¼€ï¼Œå¯ä»¥å‚è€ƒå…¶ä¸­çš„é…ç½®å€¼
- æ–°è„šæœ¬ä¸æ—§è„šæœ¬åŠŸèƒ½å…¼å®¹ï¼Œåªæ˜¯æ›´åŠ ç®€æ´

### å®‰å…¨å»ºè®®
- **ä¸è¦**å°†åŒ…å«çœŸå®å¯†ç çš„ `config.toml` æˆ– `.env` æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- å®šæœŸæ›´æ–° JWT å¯†é’¥å’Œ SMTP å¯†ç 
- ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨å¼ºå¯†ç å’Œå®‰å…¨çš„å¯†é’¥

## âœ… æ¸…ç†æ•ˆæœ

### ä»£ç é‡å‡å°‘
- **é…ç½®æ–‡ä»¶**: ä»æ‚ä¹±æ— ç« åˆ°æ¨¡æ¿åŒ–ç®¡ç†
- **å¯åŠ¨è„šæœ¬**: æ€»ä»£ç è¡Œæ•°å‡å°‘60%+
- **ç»´æŠ¤å¤æ‚åº¦**: å¤§å¹…é™ä½

### å®‰å…¨æ€§æå‡
- **æ•æ„Ÿä¿¡æ¯**: ä¸å†ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­
- **æ¨¡æ¿åŒ–**: é˜²æ­¢æ„å¤–æäº¤æ•æ„Ÿé…ç½®
- **ç¯å¢ƒåˆ†ç¦»**: å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»

### å¯ç»´æŠ¤æ€§æå‡
- **ç»“æ„æ¸…æ™°**: é…ç½®æ–‡ä»¶ç”¨é€”æ˜ç¡®
- **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„é…ç½®è¯´æ˜å’Œä½¿ç”¨æŒ‡å—
- **å‘åå…¼å®¹**: æ—§é…ç½®å’Œè„šæœ¬éƒ½æœ‰å¤‡ä»½

é…ç½®æ¸…ç†å·¥ä½œå·²å®Œæˆï¼Œé¡¹ç›®çš„å¯åŠ¨å’Œéƒ¨ç½²æµç¨‹ç°åœ¨æ›´åŠ ç®€æ´ã€å®‰å…¨å’Œæ˜“äºç»´æŠ¤ï¼